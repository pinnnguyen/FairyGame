"use strict";var l=require("vue");require("../button/index.cjs");require("../checkbox/index.cjs");require("../icon/index.cjs");require("../renderer/index.cjs");require("../tooltip/index.cjs");require("../../common/config/src/index.cjs");var H=require("@vexip-ui/utils"),w=require("@vexip-ui/icons"),B=require("./symbol.cjs"),I=require("../../_virtual/plugin-vue_export-helper.cjs"),L=require("../button/button.cjs"),O=require("../checkbox/checkbox.cjs"),U=require("../icon/icon.cjs"),P=require("../renderer/renderer.cjs"),W=require("../tooltip/tooltip.cjs"),G=require("../../common/config/src/namespace.cjs"),J=require("../../common/config/src/locale/index.cjs");const K=["order","selection","expand"],Q=l.defineComponent({name:"TableHeadCell",components:{Button:L,Checkbox:O,Icon:U,Renderer:P,Tooltip:W,CaretUp:w.CaretUp,CaretDown:w.CaretDown,Filter:w.Filter},props:{column:{type:Object,default:()=>({})},index:{type:Number,default:-1}},setup(e){const{state:n,getters:C,mutations:a}=l.inject(B.TABLE_STORE),i=l.inject(B.TABLE_ACTION),b=G.useNameHelper("table"),c=l.ref(!1),d=l.ref(),p=l.computed(()=>{let t=null;return typeof n.headClass=="function"?t=n.headClass(e.column,e.index):t=n.headClass,[b.be("head-cell"),{[b.bem("head-cell","center")]:K.includes(e.column.type)},e.column.className||null,t]}),m=l.computed(()=>{var s;const t=n.widths[e.column.key];let r="";return typeof n.headStyle=="function"?r=n.headStyle(e.column,e.index):r=n.headStyle,[{flex:`${t} 0 auto`,width:`${(s=e.column.width)!=null?s:t}px`,maxWidth:`${e.column.width}px`},e.column.style||"",r]}),y=l.computed(()=>{let t;return typeof n.headAttrs=="function"?t=n.headAttrs(e.column,e.index):t=n.headAttrs,{...e.column.attrs||{},...t||{}}}),h=l.computed(()=>n.sorters[e.column.key]||{}),u=l.computed(()=>n.filters[e.column.key]||{}),g=l.computed(()=>{var r;const t=(r=u.value.options)!=null?r:[];for(let s=0,v=t.length;s<v;++s)if(t[s].active)return!0;return!1}),o=l.computed(()=>{if(!f(e.column))return!1;const t=Object.values(C.disableCheckRows);return C.processedData.length===t.length&&!Object.values(C.disableCheckRows).includes(!1)});l.onMounted(()=>{setTimeout(()=>{d.value&&a.setColumnWidth(e.column.key,d.value.getBoundingClientRect().width)},0)});function f(t){return t.type==="selection"}function k(t){return{column:e.column,index:e.index,event:t}}function N(t){i&&i.emitHeadEnter(k(t))}function V(t){i&&i.emitHeadLeave(k(t))}function A(t){i&&i.emitHeadClick(k(t))}function R(t){i&&i.emitHeadDblclick(k(t))}function S(t){i&&i.emitHeadContextmenu(k(t))}function E(){const t=e.column.key,r=h.value.type==="asc"?null:"asc";a.handleSort(t,r),i.emitRowSort()}function j(){const t=e.column.key,r=h.value.type==="desc"?null:"desc";a.handleSort(t,r),i.emitRowSort()}function D(t,r){a.toggleFilterItemActive({key:e.column.key,value:t,active:r,disableOthers:!0}),a.handleFilter(e.column.key,t),c.value=!1,i.emitRowFilter()}function q(t,r){a.toggleFilterItemActive({key:e.column.key,value:t,active:r})}function z(){var s;const t=(s=u.value.options)!=null?s:[],r=[];for(let v=0,$=t.length;v<$;++v){const F=t[v];F.active&&r.push(F.value)}a.handleFilter(e.column.key,r),c.value=!1,i.emitRowFilter()}function T(){c.value=!1,a.handleFilter(e.column.key,null),a.toggleFilterItemActive({key:e.column.key,value:null,disableOthers:!0}),i.emitRowFilter()}function M(){a.handleCheckAll(),i.emitAllRowCheck(n.checkedAll,n.partial)}return{nh:b,locale:J.useLocale("table"),filterVisible:c,checkedAll:l.toRef(n,"checkedAll"),partial:l.toRef(n,"partial"),className:p,style:m,attrs:y,sorter:h,filter:u,hasFilterActive:g,checkboxDisabled:o,wrapper:d,isFunction:H.isFunction,isSelection:f,handleMouseEnter:N,handleMouseLeave:V,handleClick:A,handleDblclick:R,handleContextmenu:S,handleSortAsc:E,handleSortDesc:j,handleFilterItemSelect:D,handleFilterCheck:q,handleFilterMutiple:z,handleResetFilter:T,handleCheckAllRow:M}}}),X=["aria-sort"];function Y(e,n,C,a,i,b){const c=l.resolveComponent("Checkbox"),d=l.resolveComponent("Renderer"),p=l.resolveComponent("CaretUp"),m=l.resolveComponent("Icon"),y=l.resolveComponent("CaretDown"),h=l.resolveComponent("Filter"),u=l.resolveComponent("Button"),g=l.resolveComponent("Tooltip");return l.openBlock(),l.createElementBlock("div",l.mergeProps({ref:"wrapper",class:e.className,role:"columnheader",style:e.style,"aria-sort":e.sorter.type?e.sorter.type==="asc"?"ascending":"descending":"none"},e.attrs,{onMouseenter:n[5]||(n[5]=(...o)=>e.handleMouseEnter&&e.handleMouseEnter(...o)),onMouseleave:n[6]||(n[6]=(...o)=>e.handleMouseLeave&&e.handleMouseLeave(...o)),onClick:n[7]||(n[7]=(...o)=>e.handleClick&&e.handleClick(...o)),onDblclick:n[8]||(n[8]=(...o)=>e.handleDblclick&&e.handleDblclick(...o)),onContextmenu:n[9]||(n[9]=(...o)=>e.handleContextmenu&&e.handleContextmenu(...o))}),[e.isSelection(e.column)?(l.openBlock(),l.createBlock(c,{key:0,inherit:"",control:"",class:l.normalizeClass(e.nh.be("selection")),checked:e.checkedAll,partial:e.partial,disabled:e.checkboxDisabled,size:e.column.checkboxSize||"default",onClick:l.withModifiers(e.handleCheckAllRow,["prevent"])},null,8,["class","checked","partial","disabled","size","onClick"])):(l.openBlock(),l.createElementBlock(l.Fragment,{key:1},[e.isFunction(e.column.headRenderer)?(l.openBlock(),l.createBlock(d,{key:0,renderer:e.column.headRenderer,data:{column:e.column,index:e.index}},null,8,["renderer","data"])):(l.openBlock(),l.createElementBlock(l.Fragment,{key:1},[l.createTextVNode(l.toDisplayString(e.column.name),1)],64))],64)),e.sorter.able?(l.openBlock(),l.createElementBlock("div",{key:2,class:l.normalizeClass(e.nh.be("sorter"))},[l.createElementVNode("span",{class:l.normalizeClass({[e.nh.bem("sorter","asc")]:!0,[e.nh.bem("sorter","active")]:e.sorter.type==="asc"}),onClick:n[0]||(n[0]=o=>e.handleSortAsc())},[l.createVNode(m,null,{default:l.withCtx(()=>[l.createVNode(p)]),_:1})],2),l.createElementVNode("span",{class:l.normalizeClass({[e.nh.bem("sorter","desc")]:!0,[e.nh.bem("sorter","active")]:e.sorter.type==="desc"}),onClick:n[1]||(n[1]=o=>e.handleSortDesc())},[l.createVNode(m,null,{default:l.withCtx(()=>[l.createVNode(y)]),_:1})],2)],2)):l.createCommentVNode("",!0),e.filter.able?(l.openBlock(),l.createBlock(g,{key:3,visible:e.filterVisible,"onUpdate:visible":n[4]||(n[4]=o=>e.filterVisible=o),transfer:"",placement:"bottom",trigger:"click",class:l.normalizeClass({[e.nh.be("filter")]:!0,[e.nh.bem("filter","visible")]:e.filterVisible,[e.nh.bem("filter","active")]:e.filter.active}),"tip-class":{[e.nh.be("filter-wrapper")]:!0,[e.nh.bs("vars")]:!0,[e.nh.bem("filter-wrapper","multiple")]:e.filter.multiple}},l.createSlots({trigger:l.withCtx(()=>[l.createElementVNode("div",{class:l.normalizeClass(e.nh.be("filter-trigger"))},[l.createVNode(m,null,{default:l.withCtx(()=>[l.createVNode(h)]),_:1})],2)]),_:2},[e.filter.multiple?{name:"default",fn:l.withCtx(()=>[l.createElementVNode("div",{vertical:"",class:l.normalizeClass(e.nh.be("filter-group"))},[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.filter.options,o=>(l.openBlock(),l.createBlock(c,{key:o.value,inherit:"",checked:o.active,label:o.label,value:o.value,onChange:f=>e.handleFilterCheck(o.value,f)},null,8,["checked","label","value","onChange"]))),128))],2),l.createElementVNode("div",{class:l.normalizeClass(e.nh.be("filter-actions"))},[l.createVNode(u,{inherit:"",text:"",size:"small",disabled:!e.hasFilterActive,onClick:n[2]||(n[2]=o=>e.handleFilterMutiple())},{default:l.withCtx(()=>[l.createTextVNode(l.toDisplayString(e.locale.filterConfirm),1)]),_:1},8,["disabled"]),l.createVNode(u,{inherit:"",text:"",size:"small",onClick:e.handleResetFilter},{default:l.withCtx(()=>[l.createTextVNode(l.toDisplayString(e.locale.filterReset),1)]),_:1},8,["onClick"])],2)]),key:"0"}:{name:"default",fn:l.withCtx(()=>[l.createElementVNode("div",{class:l.normalizeClass({[e.nh.be("filter-item")]:!0,[e.nh.bem("filter-item","active")]:!e.filter.active}),onClick:n[3]||(n[3]=(...o)=>e.handleResetFilter&&e.handleResetFilter(...o))},l.toDisplayString(e.locale.filterAll),3),(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.filter.options,o=>(l.openBlock(),l.createElementBlock("div",{key:o.value,class:l.normalizeClass({[e.nh.be("filter-item")]:!0,[e.nh.bem("filter-item","active")]:o.active}),onClick:f=>e.handleFilterItemSelect(o.value,!o.active)},l.toDisplayString(o.label),11,["onClick"]))),128))]),key:"1"}]),1032,["visible","class","tip-class"])):l.createCommentVNode("",!0)],16,X)}var Z=I(Q,[["render",Y]]);module.exports=Z;
