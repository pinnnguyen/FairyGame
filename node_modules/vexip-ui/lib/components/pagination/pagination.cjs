"use strict";var n=require("vue");require("../icon/index.cjs");require("../number-input/index.cjs");require("../select/index.cjs");var P=require("@vexip-ui/icons");require("../../common/config/src/index.cjs");var Y=require("@vexip-ui/hooks"),g=require("@vexip-ui/utils"),Z=require("./props.cjs"),x=require("../../_virtual/plugin-vue_export-helper.cjs"),_=require("../icon/icon.cjs"),ee=require("../number-input/number-input.cjs"),ne=require("../select/select.cjs"),S=require("../../common/config/src/props.cjs"),le=require("../../common/config/src/namespace.cjs"),y=require("../../common/config/src/locale/index.cjs");const ie=n.defineComponent({name:"Pagination",components:{Icon:_,NumberInput:ee,Select:ne,ChevronRight:P.ChevronRight,ChevronLeft:P.ChevronLeft,AnglesRight:P.AnglesRight,AnglesLeft:P.AnglesLeft,Ellipsis:P.Ellipsis},props:Z.paginationProps,emits:["update:active","update:page-size"],setup(e,{emit:t}){const a=S.useProps("pagination",e,{size:S.createSizeProp(),total:{default:0,validator:l=>l>=0,static:!0},noBorder:!1,background:!1,pageSize:{default:10,validator:l=>l>0},sizeOptions:()=>[10,20,50,100],maxCount:{default:7,validator:l=>l===parseInt(l.toString())&&l>6},active:{default:1,validator:l=>l>0,static:!0},disabled:!1,disableItem:{default:()=>!1,isFunc:!0},turnPageCount:5,pageJump:!1,pageCount:!1,pageTotal:!1,itemUnit:null,plugins:null,noTitle:!1}),v=le.useNameHelper("pagination"),z=n.ref([]),u=n.ref(a.active),b=n.ref(a.pageSize),p=n.ref("left"),k=n.ref(!1),c=n.ref(!1),N=n.ref(a.active),m=n.ref([]),h=y.useLocale("pagination"),{target:B}=Y.useModifier({passive:!1,onKeyDown:(l,s)=>{if(s.up||s.down||s.left||s.right){l.preventDefault();const r=s.up||s.left?-1:1;if(g.isClient&&document.activeElement){const o=m.value.findIndex(L=>L===document.activeElement);if(!~o)return;m.value[g.boundRange(o+r,0,m.value.length-1)].focus()}}else if((s.enter||s.space)&&(l.preventDefault(),document&&document.activeElement&&!~m.value.findIndex(o=>o===document.activeElement))){const o=v.bem("item","active"),E=m.value.find(L=>L.classList.contains(o));E==null||E.focus()}}}),w=n.computed(()=>({[v.b()]:!0,[v.bs("vars")]:!0,[v.bm("inherit")]:a.inherit,[v.bm(a.size)]:a.size!=="default",[v.bm("background")]:a.background,[v.bm("no-border")]:a.noBorder,[v.bm("disabled")]:a.disabled})),i=n.computed(()=>Math.ceil(a.total/(b.value||1))||1),T=n.computed(()=>{const l=d(1,1);return l>=i.value||u.value===l}),f=n.computed(()=>{const l=d(i.value,-1);return l<=1||u.value===l}),K=n.computed(()=>`${h.value.prev} ${y.getCountWord(h.value.page,a.turnPageCount)}`),O=n.computed(()=>`${h.value.next} ${y.getCountWord(h.value.page,a.turnPageCount)}`),I=n.computed(()=>i.value>a.maxCount),$=n.computed(()=>{if(!I.value)return 0;let l=d(u.value-a.turnPageCount,-1);return l<1&&(l=d(l+1,1),l>=u.value)?0:l}),A=n.computed(()=>{if(!I.value)return 0;let l=d(u.value+a.turnPageCount,1);return l>i.value&&(l=d(l-1,-1),l<=u.value)?0:l}),q=n.computed(()=>a.sizeOptions.map(l=>({value:l,label:`${l} ${h.value.prePage}`}))),V=n.computed(()=>{if(a.plugins)return a.plugins;const l=[void 0];return a.pageTotal&&l.push("total"),a.pageCount&&l.push("size"),a.pageJump&&l.push("jump"),l.length&&g.warnOnce("[vexip-ui:Pagination] 'page-jump', 'page-count' and 'page-total' props have been deprecated, please using 'plugins' prop to instead them"),l}),M=n.computed(()=>{const l=V.value,s=l.findIndex(g.isNull);return{total:l.findIndex(r=>r==="total")-s,size:l.findIndex(r=>r==="size")-s,jump:l.findIndex(r=>r==="jump")-s}}),R=n.computed(()=>{if(!V.value.includes("jump"))return 0;let l=0;return V.value.includes("size")?l=Math.ceil(a.total/(Math.min(...a.sizeOptions)||10)):l=Math.ceil(a.total/(a.pageSize||10)),l.toString().length*10+30});n.watch(()=>a.active,l=>{C(l,!1)}),n.watch(u,l=>{j(),N.value=l,S.emitEvent(a.onChange,l),t("update:active",l)}),n.watch(()=>a.maxCount,j),n.watch(i,j),n.watch(()=>a.pageSize,l=>{b.value=l}),n.watch(b,(l,s)=>{S.emitEvent(a.onPageSizeChange,l),t("update:page-size",l);const r=Math.ceil((s*(u.value-1)+1)/l);let o=d(r,1);o>i.value&&(o=d(r-1,-1),o<1&&(o=0)),u.value=o}),n.onMounted(()=>{n.nextTick(j)}),n.onBeforeUpdate(()=>{m.value.length=0});function d(l,s){for(s=s/Math.abs(s);a.disableItem(l)&&(l+=s,!(l<1||l>i.value)););return l}function C(l,s=!0){if(l=parseInt(l.toString()),!(a.disabled||l<1||l>i.value||a.disableItem(l))&&(u.value=l,g.isClient&&s)){const r=m.value.find(o=>o===document.activeElement);r==null||r.blur(),n.nextTick(()=>{const o=m.value.find(E=>E.tabIndex>=0);o==null||o.focus()})}}function W(){if(!T.value&&!a.disabled){const l=d(u.value-1,-1);l>=1&&C(l)}}function D(){if(!f.value&&!a.disabled){const l=d(u.value+1,1);l<=i.value&&C(l)}}function j(){let l;if(i.value<=a.maxCount)l=g.range(i.value);else{const s=a.maxCount-2,r=Math.ceil(a.maxCount/2);if(u.value<r)l=g.range(s),l.push(i.value),p.value="left";else if(u.value<=i.value-r){let o=s-2;o%2===0&&(o-=1),l=g.range(o,u.value-(o-1)/2),l.unshift(1),l.push(i.value),p.value="center"}else l=g.range(s,i.value-s+1),l.unshift(1),p.value="right"}l.length===1&&(z.value=[]),z.value=l.slice(1,-1)}function U(){k.value=!0}function F(){k.value=!1}function J(){!a.disabled&&$.value&&C($.value)}function H(){c.value=!0}function G(){c.value=!1}function Q(){!a.disabled&&A.value&&C(A.value)}function X(l){l=Math.max(Math.min(parseInt(l.toString()),i.value),1);const s=l;if(l!==u.value){const r=l>u.value?1:-1;l=d(s,r),(r>0?l>i.value:l<1)&&(l=d(s,-r),(r>0?l<1:l>i.value)&&(l=0)),u.value=l}n.nextTick(()=>{N.value=u.value})}return{props:a,nh:v,locale:h,currentPagers:z,currentActive:u,currentPageSize:b,mode:p,inPrevEllipsis:k,inNextEllipsis:c,jumpValue:N,itemElList:m,className:w,pagerCount:i,disabledPrev:T,disabledNext:f,prevTurnPageTitle:K,nextTurnPageTitle:O,useEllipsis:I,prevEllipsisTarget:$,nextEllipsisTarget:A,sizeObjectOptions:q,usedPlugins:V,pluginOrders:M,jumpInputWidth:R,wrapper:B,isFunction:g.isFunction,getCountWord:y.getCountWord,getCountWordOnly:y.getCountWordOnly,changeActive:C,handlePrev:W,handleNext:D,handleEnterPrevEllipsis:U,handleLeavePrevEllipsis:F,handleClickPrevEllipsis:J,handleEnterNextEllipsis:H,handleLeaveNextEllipsis:G,handleClickNextEllipsis:Q,handleJumpPage:X}}}),te=["aria-disabled"],ae=["title","aria-label","aria-hidden"],se=["title","tabindex","aria-setsize","aria-disabled"],re=["title","aria-label"],oe=["tabindex","aria-posinset","aria-setsize","aria-disabled","onClick","onKeydown"],ue=["title","aria-label"],de=["title","tabindex","aria-posinset","aria-setsize","aria-disabled"],pe=["title","aria-label","aria-hidden"];function me(e,t,a,v,z,u){var w;const b=n.resolveComponent("ChevronLeft"),p=n.resolveComponent("Icon"),k=n.resolveComponent("AnglesLeft"),c=n.resolveComponent("Ellipsis"),N=n.resolveComponent("AnglesRight"),m=n.resolveComponent("ChevronRight"),h=n.resolveComponent("Select"),B=n.resolveComponent("NumberInput");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(e.className)},[n.createElementVNode("ul",{ref:"wrapper",class:n.normalizeClass(e.nh.be("list")),role:"menubar","aria-label":"Pagination","aria-disabled":e.props.disabled?"true":void 0},[n.createElementVNode("li",{ref:i=>i&&!e.disabledPrev&&e.itemElList.push(i),class:n.normalizeClass([e.nh.be("item"),e.nh.bem("item","prev"),e.disabledPrev?e.nh.bem("item","disabled"):""]),title:e.props.noTitle?void 0:e.locale.prevPage,role:"menuitem",tabindex:"-1","aria-label":e.locale.prevPage,"aria-hidden":e.disabledPrev?"true":void 0,onClick:t[0]||(t[0]=(...i)=>e.handlePrev&&e.handlePrev(...i)),onKeydown:[t[1]||(t[1]=n.withKeys((...i)=>e.handlePrev&&e.handlePrev(...i),["enter"])),t[2]||(t[2]=n.withKeys((...i)=>e.handlePrev&&e.handlePrev(...i),["space"]))]},[n.renderSlot(e.$slots,"prev",{},()=>[n.createVNode(p,{scale:.8},{default:n.withCtx(()=>[n.createVNode(b)]),_:1},8,["scale"])])],42,ae),n.createElementVNode("li",{ref:i=>i&&e.itemElList.push(i),class:n.normalizeClass({[e.nh.be("item")]:!0,[e.nh.bem("item","disabled")]:e.props.disableItem(1),[e.nh.bem("item","active")]:e.currentActive===1}),title:e.props.noTitle?void 0:"1",role:"menuitemradio",tabindex:e.currentActive===1?"0":"-1","aria-posinset":"1","aria-setsize":e.pagerCount,"aria-disabled":e.props.disableItem(1)?"true":void 0,onClick:t[3]||(t[3]=i=>e.changeActive(1)),onKeydown:[t[4]||(t[4]=n.withKeys(i=>e.changeActive(1),["enter"])),t[5]||(t[5]=n.withKeys(i=>e.changeActive(1),["space"]))]},[n.renderSlot(e.$slots,"item",{page:1},()=>[n.createTextVNode(n.toDisplayString(1))])],42,se),e.useEllipsis&&e.mode!=="left"?(n.openBlock(),n.createElementBlock("li",{key:0,ref:i=>i&&e.itemElList.push(i),class:n.normalizeClass({[e.nh.be("item")]:!0,[e.nh.bem("item","more")]:!0,[e.nh.bem("item","disabled")]:!e.prevEllipsisTarget}),title:e.props.noTitle?void 0:e.prevTurnPageTitle,role:"menuitem",tabindex:"-1","aria-label":e.prevTurnPageTitle,onClick:t[6]||(t[6]=(...i)=>e.handleClickPrevEllipsis&&e.handleClickPrevEllipsis(...i)),onKeydown:[t[7]||(t[7]=n.withKeys((...i)=>e.handleClickPrevEllipsis&&e.handleClickPrevEllipsis(...i),["enter"])),t[8]||(t[8]=n.withKeys((...i)=>e.handleClickPrevEllipsis&&e.handleClickPrevEllipsis(...i),["space"]))],onMouseenter:t[9]||(t[9]=(...i)=>e.handleEnterPrevEllipsis&&e.handleEnterPrevEllipsis(...i)),onMouseleave:t[10]||(t[10]=(...i)=>e.handleLeavePrevEllipsis&&e.handleLeavePrevEllipsis(...i))},[n.createVNode(n.Transition,{name:e.nh.ns("fade")},{default:n.withCtx(()=>[e.inPrevEllipsis?(n.openBlock(),n.createBlock(p,{key:0,scale:.8},{default:n.withCtx(()=>[n.createVNode(k)]),_:1},8,["scale"])):(n.openBlock(),n.createBlock(p,{key:1,scale:.8,style:{position:"absolute"}},{default:n.withCtx(()=>[n.createVNode(c)]),_:1},8,["scale"]))]),_:1},8,["name"])],42,re)):n.createCommentVNode("",!0),e.currentPagers.length?(n.openBlock(!0),n.createElementBlock(n.Fragment,{key:1},n.renderList(e.currentPagers,(i,T)=>(n.openBlock(),n.createElementBlock("li",{key:T,ref_for:!0,ref:f=>f&&e.itemElList.push(f),class:n.normalizeClass({[e.nh.be("item")]:!0,[e.nh.bem("item","disabled")]:e.props.disableItem(i),[e.nh.bem("item","active")]:e.currentActive===i}),role:"menuitemradio",tabindex:e.currentActive===i?"0":"-1","aria-posinset":i,"aria-setsize":e.pagerCount,"aria-disabled":e.props.disableItem(i)?"true":void 0,onClick:f=>e.changeActive(i),onKeydown:[n.withKeys(f=>e.changeActive(i),["enter"]),n.withKeys(f=>e.changeActive(i),["space"])]},[n.renderSlot(e.$slots,"item",{page:i},()=>[n.createTextVNode(n.toDisplayString(i),1)])],42,oe))),128)):n.createCommentVNode("",!0),e.useEllipsis&&e.mode!=="right"?(n.openBlock(),n.createElementBlock("li",{key:2,ref:i=>i&&e.itemElList.push(i),class:n.normalizeClass({[e.nh.be("item")]:!0,[e.nh.bem("item","more")]:!0,[e.nh.bem("item","disabled")]:!e.nextEllipsisTarget}),title:e.props.noTitle?void 0:e.nextTurnPageTitle,role:"menuitem",tabindex:"-1","aria-label":e.nextTurnPageTitle,onClick:t[11]||(t[11]=(...i)=>e.handleClickNextEllipsis&&e.handleClickNextEllipsis(...i)),onKeydown:[t[12]||(t[12]=n.withKeys((...i)=>e.handleClickNextEllipsis&&e.handleClickNextEllipsis(...i),["enter"])),t[13]||(t[13]=n.withKeys((...i)=>e.handleClickNextEllipsis&&e.handleClickNextEllipsis(...i),["space"]))],onMouseenter:t[14]||(t[14]=(...i)=>e.handleEnterNextEllipsis&&e.handleEnterNextEllipsis(...i)),onMouseleave:t[15]||(t[15]=(...i)=>e.handleLeaveNextEllipsis&&e.handleLeaveNextEllipsis(...i))},[n.createVNode(n.Transition,{name:e.nh.ns("fade")},{default:n.withCtx(()=>[e.inNextEllipsis?(n.openBlock(),n.createBlock(p,{key:0,scale:.8},{default:n.withCtx(()=>[n.createVNode(N)]),_:1},8,["scale"])):(n.openBlock(),n.createBlock(p,{key:1,scale:.8,style:{position:"absolute"}},{default:n.withCtx(()=>[n.createVNode(c)]),_:1},8,["scale"]))]),_:1},8,["name"])],42,ue)):n.createCommentVNode("",!0),e.pagerCount>1?(n.openBlock(),n.createElementBlock("li",{key:3,ref:i=>i&&e.itemElList.push(i),class:n.normalizeClass({[e.nh.be("item")]:!0,[e.nh.bem("item","disabled")]:e.props.disableItem(e.pagerCount),[e.nh.bem("item","active")]:e.currentActive===e.pagerCount}),title:e.props.noTitle?void 0:`${e.pagerCount}`,role:"menuitemradio",tabindex:e.currentActive===e.pagerCount?"0":"-1","aria-posinset":e.pagerCount,"aria-setsize":e.pagerCount,"aria-disabled":e.props.disableItem(e.pagerCount)?"true":void 0,onClick:t[16]||(t[16]=i=>e.changeActive(e.pagerCount)),onKeydown:[t[17]||(t[17]=n.withKeys(i=>e.changeActive(e.pagerCount),["enter"])),t[18]||(t[18]=n.withKeys(i=>e.changeActive(e.pagerCount),["space"]))]},[n.renderSlot(e.$slots,"item",{page:e.pagerCount},()=>[n.createTextVNode(n.toDisplayString(e.pagerCount),1)])],42,de)):n.createCommentVNode("",!0),n.createElementVNode("li",{ref:i=>i&&!e.disabledNext&&e.itemElList.push(i),class:n.normalizeClass([e.nh.be("item"),e.nh.bem("item","next"),e.disabledNext?e.nh.bem("item","disabled"):""]),title:e.props.noTitle?void 0:e.locale.nextPage,role:"menuitem",tabindex:"-1","aria-label":e.locale.nextPage,"aria-hidden":e.disabledNext?"true":void 0,onClick:t[19]||(t[19]=(...i)=>e.handleNext&&e.handleNext(...i)),onKeydown:[t[20]||(t[20]=n.withKeys((...i)=>e.handleNext&&e.handleNext(...i),["enter"])),t[21]||(t[21]=n.withKeys((...i)=>e.handleNext&&e.handleNext(...i),["space"]))]},[n.renderSlot(e.$slots,"next",{},()=>[n.createVNode(p,{scale:.8},{default:n.withCtx(()=>[n.createVNode(m)]),_:1},8,["scale"])])],42,pe)],10,te),e.usedPlugins.includes("total")?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([e.nh.be("total"),e.pluginOrders.total<0&&e.nh.bem("total","prefix")]),style:n.normalizeStyle({order:e.pluginOrders.total})},n.toDisplayString(`${e.locale.total} ${e.getCountWord((w=e.props.itemUnit)!=null?w:e.locale.itemUnit,e.props.total)}`),7)):n.createCommentVNode("",!0),e.usedPlugins.includes("size")?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([e.nh.be("size"),e.pluginOrders.size<0&&e.nh.bem("size","prefix")]),style:n.normalizeStyle({order:e.pluginOrders.size})},[n.createVNode(h,{value:e.currentPageSize,"onUpdate:value":t[22]||(t[22]=i=>e.currentPageSize=i),inherit:"",class:n.normalizeClass(e.nh.be("size-select")),options:e.sizeObjectOptions,filter:!1,multiple:!1,clearable:!1},null,8,["value","class","options"])],6)):n.createCommentVNode("",!0),e.usedPlugins.includes("jump")?(n.openBlock(),n.createElementBlock("div",{key:2,class:n.normalizeClass([e.nh.be("jump"),e.pluginOrders.jump<0&&e.nh.bem("jump","prefix")]),style:n.normalizeStyle({order:e.pluginOrders.jump})},[n.createTextVNode(n.toDisplayString(e.locale.jumpTo)+" ",1),n.createVNode(B,{value:e.jumpValue,"onUpdate:value":t[23]||(t[23]=i=>e.jumpValue=i),inherit:"",class:n.normalizeClass(e.nh.be("jump-input")),clearable:!1,sync:!1,style:n.normalizeStyle({width:`${e.jumpInputWidth}px`}),onChange:e.handleJumpPage},null,8,["value","class","style","onChange"]),n.createTextVNode(" "+n.toDisplayString(e.getCountWordOnly(e.locale.page,1)),1)],6)):n.createCommentVNode("",!0)],2)}var ve=x(ie,[["render",me]]);module.exports=ve;
