"use strict";var o=require("vue");require("../button/index.cjs");require("../../common/config/src/index.cjs");var f=require("@vexip-ui/utils"),g=require("./props.cjs"),m=require("./symbol.cjs"),v=require("../../_virtual/plugin-vue_export-helper.cjs"),h=require("../button/button.cjs"),u=require("../../common/config/src/props.cjs"),y=require("../../common/config/src/namespace.cjs"),S=require("../../common/config/src/locale/index.cjs");const k=o.defineComponent({name:"FormSubmit",components:{Button:h},props:g.formSubmitProps,emits:[],setup(e){const n=u.useProps("form-submit",e,{size:null,type:"primary",label:null,dashed:null,text:null,simple:null,ghost:null,disabled:null,circle:null,loadingIcon:null,loadingSpin:null,icon:null,color:null,buttonType:null,block:null,onBeforeSubmit:{default:null,isFunc:!0}}),t=o.inject(m.FORM_PROPS,{}),r=o.inject(m.FORM_ACTIONS,null),s=o.ref(!1),p=o.ref(),l=o.computed(()=>t.method&&t.action),d=o.computed(()=>!!r||n.inherit);async function b(){var c;if(n.disabled||!r)return;s.value=!0;const a=await r.validate();if(a.length)u.emitEvent(n.onError,a);else{let i=!0;typeof n.onBeforeSubmit=="function"&&(i=n.onBeforeSubmit(),f.isPromise(i)&&(i=await i)),i!==!1&&(u.emitEvent(n.onSubmit),l.value&&((c=p.value)==null||c.click()))}s.value=!1}return{props:n,nh:y.useNameHelper("form"),locale:S.useLocale("form"),loading:s,submit:p,isNative:l,isInherit:d,handleSubmit:b}}});function j(e,n,t,r,s,p){const l=o.resolveComponent("Button");return o.openBlock(),o.createBlock(l,{inherit:e.isInherit,class:o.normalizeClass(e.nh.be("submit")),size:e.props.size,type:e.props.type,simple:e.props.simple,ghost:e.props.ghost,dashed:e.props.dashed,text:e.props.text,disabled:e.props.disabled,loading:e.loading,circle:e.props.circle,"loading-icon":e.props.loadingIcon,"loading-spin":e.props.loadingSpin,icon:e.props.icon,color:e.props.color,"button-type":e.props.buttonType,block:e.props.block,tag:e.props.tag,onClick:e.handleSubmit},{default:o.withCtx(()=>[o.renderSlot(e.$slots,"default",{},()=>[o.createTextVNode(o.toDisplayString(e.props.label||e.locale.submit),1)]),e.isNative?(o.openBlock(),o.createElementBlock("button",{key:0,ref:"submit",type:"submit",style:{display:"none"},onClick:n[0]||(n[0]=o.withModifiers(()=>{},["stop"]))},null,512)):o.createCommentVNode("",!0)]),_:3},8,["inherit","class","size","type","simple","ghost","dashed","text","disabled","loading","circle","loading-icon","loading-spin","icon","color","button-type","block","tag","onClick"])}var q=v(k,[["render",j]]);module.exports=q;
