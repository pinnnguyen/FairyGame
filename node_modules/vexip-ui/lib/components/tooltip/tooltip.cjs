"use strict";var t=require("vue");require("../portal/index.cjs");require("../../common/config/src/index.cjs");var o=require("@vexip-ui/hooks"),F=require("@vexip-ui/utils"),_=require("./props.cjs"),E=require("../portal/portal.cjs"),X=require("../../common/config/src/namespace.cjs"),d=require("../../common/config/src/props.cjs");function z(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!t.isVNode(f)}const G=t.createTextVNode("").type;var I=t.defineComponent({name:"Tooltip",components:{Portal:E},inheritAttrs:!0,props:_.tooltipProps,emits:["update:visible"],setup(f,{attrs:h,slots:l,emit:L,expose:S}){const i=X.useNameHelper("tooltip"),e=d.useProps("tooltip",f,{trigger:{default:"hover",validator:r=>["hover","click","focus","custom"].includes(r)},wrapper:!1,noArrow:!1,transitionName:()=>i.ns("fade"),visible:!1,placement:{default:"top",validator:r=>o.placementWhileList.includes(r)},outsideClose:!0,noHover:!1,tipClass:null,tipStyle:null,transfer:!1,disabled:!1,raw:!1,delay:250,tipAlive:!1,reverse:!1,width:"auto",virtual:null}),j=t.toRef(e,"placement"),p=t.ref(e.visible),v=t.ref(e.visible),q=t.toRef(e,"transfer"),y=t.ref(100),c=t.ref(),b=t.computed(()=>{var u,n;const r=(n=(u=e.virtual)==null?void 0:u.$el)!=null?n:e.virtual;if(r){if("getBoundingClientRect"in r)return r;if("x"in r&&"y"in r)return{getBoundingClientRect:()=>({x:r.x,y:r.y,left:r.x,top:r.y,width:0,height:0})}}return c.value}),s=t.computed(()=>F.isElement(b.value)?b.value:null);o.useClickOutside($,c);const{popper:T,transferTo:N,updatePopper:w}=o.usePopper({placement:j,transfer:q,reference:b,wrapper:c}),P=t.computed(()=>e.width==="auto"?e.tipStyle:e.width==="trigger"?[{width:`${y.value}px`},e.tipStyle]:[{width:`${e.width}px`},e.tipStyle]);o.useListener(s,"mouseenter",V),o.useListener(s,"mouseleave",x),o.useListener(s,"click",O),o.useListener(s,"focus",R),o.useListener(s,"blur",W),o.useListener(T,"mouseenter",V),o.useListener(T,"mouseleave",x),t.watch(()=>e.visible,r=>{p.value=r,r&&(v.value=!0,w())}),t.watch(()=>e.disabled,r=>{r&&a(!1)}),S({toggleVisible:a,updatePopper:w});function a(r=!p.value){p.value=r,r&&(A(),v.value=!0,w()),d.emitEvent(e.onToggle,r),L("update:visible",r)}function A(){!s.value||(y.value=s.value.offsetWidth)}const{timer:g}=o.useSetTimeout();function V(){e.disabled||(e.trigger==="hover"&&(clearTimeout(g.hover),g.hover=setTimeout(()=>{a(!0)},250)),d.emitEvent(e.onTipEnter))}function x(){e.disabled||(e.trigger==="hover"&&(clearTimeout(g.hover),g.hover=setTimeout(()=>{a(!1)},250)),d.emitEvent(e.onTipLeave))}function O(){e.disabled||e.trigger==="click"&&a()}function R(){e.disabled||e.trigger==="focus"&&a(!0)}function W(){e.disabled||e.trigger==="focus"&&a(!1)}function $(){e.disabled||(d.emitEvent(e.onClickOutside),e.outsideClose&&e.trigger!=="custom"&&p.value&&(a(!1),d.emitEvent(e.onOutsideClose)))}function B(r){r?c.value=r.nextElementSibling:c.value=void 0}function C(){v.value=p.value}return()=>{var k;const r=e.wrapper?e.wrapper===!0?"span":e.wrapper:null,u=(k=l.trigger)==null?void 0:k.call(l),n=u?u[0]:null,H=m=>{m.stopPropagation()},D=()=>n?n.type===G?r?t.createVNode("span",null,[n]):t.createVNode("span",h,[n]):(r||(n.props=t.mergeProps(n.props||{},h)),n):null;return[n&&(r?t.createVNode(r,t.mergeProps(h,{ref:c,class:[i.b(),i.bs("vars"),e.inherit&&i.bm("inherit")]}),z(u)?u:{default:()=>[u]}):t.createVNode(t.Fragment,{ref:B},[D()])),!e.disabled&&t.createVNode(E,{to:N.value},{default:()=>[(e.tipAlive||v.value)&&t.createVNode(t.Transition,{appear:!0,name:e.transitionName},{default:()=>{var m;return[t.withDirectives(t.createVNode("div",{ref:T,class:{[i.be("popper")]:!0,[i.bs("vars")]:!0,[i.bem("popper","inherit")]:N.value!=="body",[i.bem("popper",e.reverse?"dark":"light")]:!0,[i.bem("popper","no-hover")]:e.noHover,[i.bem("popper","no-arrow")]:e.noArrow},role:"tooltip",tabindex:-1,onClick:H,onAnimationend:C,onTransitionend:C},[t.createVNode("div",{class:[!e.raw&&i.be("tip"),e.tipClass],role:"tooltip",style:P.value},[!e.raw&&!e.noArrow&&t.createVNode("div",{class:i.be("arrow")},null),(m=l.default)==null?void 0:m.call(l)])]),[[t.vShow,p.value]])]}})]})]}}});module.exports=I;
