"use strict";var o=require("vue");require("../collapse-transition/index.cjs");require("../icon/index.cjs");require("../portal/index.cjs");require("../tooltip/index.cjs");require("../renderer/index.cjs");var I=require("@vexip-ui/icons");require("../../common/config/src/index.cjs");var x=require("@vexip-ui/hooks"),R=require("@vexip-ui/utils"),S=require("./props.cjs"),p=require("./symbol.cjs"),ee=require("../collapse/collapse-transition.cjs"),re=require("../icon/icon.cjs"),oe=require("../tooltip/tooltip.cjs"),ne=require("../portal/portal.cjs"),le=require("../renderer/renderer.cjs"),A=require("../../common/config/src/props.cjs"),ie=require("../../common/config/src/namespace.cjs");function se(b){return Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}))}const ue=o.defineAsyncComponent(()=>Promise.resolve().then(function(){return se(require("./menu-group.cjs"))})),G=o.defineComponent({name:"MenuItem",components:{CollapseTransition:ee,Icon:re,Tooltip:oe,Portal:ne,Renderer:le,ChevronDown:I.ChevronDown},props:S.menuItemProps,emits:[],setup(b,{slots:$}){const l=A.useProps("menuItem",b,{label:{default:null,static:!0},icon:{isFunc:!0,default:null},iconProps:null,disabled:!1,transfer:null,trigger:null,transitionName:null,meta:null,children:{default:()=>[],static:!0},route:null}),e=o.inject(p.MENU_STATE,null),r=o.inject(p.MENU_ITEM_STATE,null),g=o.inject(p.MENU_GROUP_STATE,null),v=ie.useNameHelper("menu"),t=v.be("item"),q=o.ref("right-start"),s=o.ref(!1),h=o.ref(!1),M=o.ref(!1),y=o.ref(!1),P=o.computed(()=>{var n;return((n=r==null?void 0:r.indent)!=null?n:0)+1}),_=o.computed(()=>{var n,c;return(c=(n=l.transfer)!=null?n:e==null?void 0:e.transfer)!=null?c:!1}),N=o.computed(()=>r?r.transfer:!1),z=o.computed(()=>!N.value&&_.value),O=o.computed(()=>(e==null?void 0:e.markerType)||"right"),T=x.useClickOutside(Y),{reference:D,popper:L,transferTo:F,updatePopper:H}=x.usePopper({placement:q,transfer:z,wrapper:T}),V=o.computed(()=>({[t]:!0,[`${t}--disabled`]:l.disabled,[`${t}--group-visible`]:u.value&&s.value,[`${t}--selected`]:h.value,[`${t}--no-icon`]:!l.icon,[`${t}--son-selected`]:M.value})),W=o.computed(()=>{var n;return(e==null?void 0:e.horizontal)||(r==null?void 0:r.isUsePopper)?{}:{paddingLeft:r&&r.isUsePopper?void 0:`${P.value*p.baseIndentWidth+(e!=null&&e.isReduced?0:(n=g==null?void 0:g.indent)!=null?n:0)*.25*p.baseIndentWidth}px`}}),u=o.computed(()=>{var n;return!!($.group||((n=l.children)==null?void 0:n.length))}),m=o.computed(()=>u.value&&s.value),a=o.computed(()=>e&&(e.horizontal||e.groupType==="dropdown")||u.value&&(e==null?void 0:e.isReduced)&&!r||!!(r!=null&&r.isUsePopper)),B=o.computed(()=>u.value||!!((r==null?void 0:r.isUsePopper)||e&&!e.isReduced)),J=o.computed(()=>!!(e!=null&&e.tooltipReverse)),E=o.computed(()=>(e==null?void 0:e.horizontal)&&!r),K=o.computed(()=>{var n;return((n=l.transitionName)!=null?n:E.value)?v.ns("drop"):v.ns("zoom")}),f=o.computed(()=>l.trigger||(e==null?void 0:e.trigger)||"hover"),j=o.reactive({el:T,label:o.toRef(l,"label"),indent:P,groupExpanded:s,showGroup:m,isUsePopper:a,parentState:r,transfer:o.computed(()=>N.value||_.value),cachedExpanded:s.value,updateSonSelected:Q,toggleGroupExpanded:U,handleMouseEnter:k,handleMouseLeave:w});o.provide(p.MENU_ITEM_STATE,j),o.watch(m,n=>{n&&a.value&&(y.value=!0,H())}),o.watch(h,n=>{n?(A.emitEvent(l.onSelect),o.nextTick(()=>{r==null||r.updateSonSelected(n)})):r==null||r.updateSonSelected(n)}),o.watch(s,n=>{typeof(e==null?void 0:e.handleExpand)=="function"&&e.handleExpand(l.label,n,l.meta||{})}),o.watch(E,n=>{q.value=n?"bottom":"right-start"},{immediate:!0}),e&&o.watch(()=>[l.label,e.currentActive],()=>{h.value=l.label===e.currentActive},{immediate:!0}),o.onMounted(()=>{typeof(e==null?void 0:e.increaseItem)=="function"&&e.increaseItem(j)}),o.onBeforeUnmount(()=>{typeof(e==null?void 0:e.decreaseItem)=="function"&&e.decreaseItem(j)});function Q(n){M.value=n,r==null||r.updateSonSelected(n)}const{timer:d}=x.useSetTimeout();function X(){if(clearTimeout(d.hover),!l.disabled)if(u.value){if(a.value&&f.value!=="click")return;e==null||e.beforeExpand(),s.value=!s.value}else a.value&&U(!1,!0),e&&e.handleSelect(l.label,l.meta||{},l.route),h.value=!0}function U(n,c=!1){clearTimeout(d.hover),e==null||e.beforeExpand(),s.value=n,c&&typeof(r==null?void 0:r.toggleGroupExpanded)=="function"&&r.toggleGroupExpanded(n,c)}function k(){clearTimeout(d.hover),!(l.disabled||!a.value||f.value!=="hover")&&(typeof(r==null?void 0:r.handleMouseEnter)=="function"&&r.handleMouseEnter(),u.value&&(d.hover=setTimeout(()=>{s.value=!0},250)))}function w(){clearTimeout(d.hover),!(l.disabled||!a.value||f.value!=="hover")&&(typeof(r==null?void 0:r.handleMouseLeave)=="function"&&r.handleMouseLeave(),u.value&&(d.hover=setTimeout(()=>{s.value=!1},250)))}function Y(){f.value==="click"&&o.nextTick(()=>{s.value=!1})}function Z(){var c;if(!((c=l.children)!=null&&c.length))return null;const n=i=>o.createVNode(G,{label:i.label,icon:i.icon,"icon-props":i.iconProps,disabled:i.disabled,children:i.children,route:i.route},{default:()=>[i.name?R.callIfFunc(i.name):i.label]});return l.children.map(i=>i.group?o.createVNode(ue,{label:i.name?R.callIfFunc(i.name):i.label},{default:()=>{var C;return[(C=i.children)==null?void 0:C.map(n)]}}):n(i))}return{props:l,nh:v,groupExpanded:s,transferTo:F,popperShow:y,className:V,labelStyle:W,isGroup:u,showGroup:m,isUsePopper:a,tooltipDisabled:B,markerType:O,tooltipReverse:J,isHorizontal:E,transition:K,dropTrigger:f,wrapper:T,reference:D,popper:L,handleSelect:X,handleMouseEnter:k,handleMouseLeave:w,renderChildren:Z}}});module.exports=G;
