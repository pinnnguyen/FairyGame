"use strict";var e=require("vue");require("../icon/index.cjs");require("../menu-item/index.cjs");require("../portal/index.cjs");var S=require("@vexip-ui/icons");require("../../common/config/src/index.cjs");var i=require("@vexip-ui/hooks"),w=require("@vexip-ui/utils"),h=require("./symbol.cjs"),C=require("../../common/config/src/namespace.cjs"),P=require("./menu-item.cjs"),y=require("../icon/icon.cjs"),A=require("../portal/portal.cjs"),I=e.defineComponent({name:"MenuRest",props:{menus:{type:Array,default:()=>[]}},setup(p){const t=e.inject(h.MENU_STATE,null),n=C.useNameHelper("menu"),o=e.ref(!1),d=e.ref(!1),s=e.ref(!1),v=e.computed(()=>{var r;return(r=t==null?void 0:t.transfer)!=null?r:!1}),u=e.computed(()=>(t==null?void 0:t.trigger)||"hover"),c=i.useClickOutside(M),{reference:b,popper:T,transferTo:q,updatePopper:x}=i.usePopper({placement:e.ref("bottom"),transfer:v,wrapper:c}),N=e.reactive({el:c,label:"",indent:1,groupExpanded:o,showGroup:o,isUsePopper:!0,parentState:null,transfer:v,cachedExpanded:!1,updateSonSelected:g,toggleGroupExpanded:j,handleMouseEnter:f,handleMouseLeave:m});e.provide(h.MENU_ITEM_STATE,N),e.watch(o,r=>{r&&(s.value=!0,x())});function g(r){d.value=r}function j(r){o.value=r}const{timer:l}=i.useSetTimeout();function f(){clearTimeout(l.hover),u.value==="hover"&&(l.hover=setTimeout(()=>{o.value=!0},250))}function m(){clearTimeout(l.hover),u.value==="hover"&&(l.hover=setTimeout(()=>{o.value=!1},250))}function E(){u.value==="click"&&(o.value=!0)}function M(){u.value==="click"&&e.nextTick(()=>{o.value=!1})}function k(){s.value=!1}function V(){var r;return(r=p.menus)!=null&&r.length?p.menus.map(a=>e.createVNode(P,{label:a.label,icon:a.icon,"icon-props":a.iconProps,disabled:a.disabled,children:a.children,route:a.route},{default:()=>[a.name?w.callIfFunc(a.name):a.label]})):null}return()=>e.createVNode("div",{ref:c,class:n.be("rest"),onMouseenter:f,onMouseleave:m},[e.createVNode("div",{ref:b,class:[n.be("rest-handler"),d.value&&n.bem("rest-handler","selected")],onClick:E},[e.createVNode(y,null,{default:()=>[e.createVNode(S.Ellipsis,null,null)]})]),e.createVNode(A,{to:q.value},{default:()=>[e.createVNode(e.Transition,{name:n.ns("drop"),appear:!0,onAfterLeave:k},{default:()=>[s.value&&e.withDirectives(e.createVNode("div",{ref:T,class:[n.be("popper"),n.bs("vars"),n.bem("popper","drop")]},[e.createVNode("ul",{class:[n.be("list"),n.bem("list","theme")]},[V()])]),[[e.vShow,o.value]])]})]})])}});module.exports=I;
