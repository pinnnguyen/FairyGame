"use strict";var e=require("vue");require("../portal/index.cjs");require("../../common/config/src/index.cjs");var m=require("@vexip-ui/hooks"),L=require("@vexip-ui/utils"),w=require("./props.cjs"),q=require("../../_virtual/plugin-vue_export-helper.cjs"),M=require("../portal/portal.cjs"),h=require("../../common/config/src/namespace.cjs"),H=require("../../common/config/src/props.cjs");const S=e.defineComponent({name:"Ellipsis",components:{Portal:M},props:w.ellipsisProps,setup(r){const t=h.useNameHelper("ellipsis"),o=H.useProps("ellipsis",r,{placement:{default:"top",validator:n=>m.placementWhileList.includes(n)},transfer:"body",noHover:!1,transitionName:()=>t.ns("fade"),tooltipTheme:{default:"dark",validator:n=>["light","dark"].includes(n)},tipClass:null,maxLines:null,tipMaxWidth:500}),v=h.useNameHelper("tooltip"),s=e.ref(!1),a=e.ref(!1),u=e.toRef(o,"placement"),i=e.toRef(o,"transfer"),d=e.ref(""),l=e.ref(),{popper:f,transferTo:g,updatePopper:c}=m.usePopper({placement:u,transfer:i,wrapper:l,reference:l}),T=e.computed(()=>({[t.b()]:!0,[t.bm("inherit")]:o.inherit,[t.bm("multiple")]:o.maxLines})),N=e.computed(()=>o.maxLines>0?{"-webkit-line-clamp":o.maxLines}:""),b=e.computed(()=>({maxWidth:typeof o.tipMaxWidth=="string"?parseFloat(o.tipMaxWidth)||o.tipMaxWidth:`${o.tipMaxWidth}px`}));e.watch(s,n=>{n&&c()});const{timer:p}=m.useSetTimeout();function C(){clearTimeout(p.hover),p.hover=setTimeout(()=>{var n;if(!l.value||!l.value.childNodes.length){s.value=!1;return}if(o.maxLines>0){const y=l.value.scrollHeight,E=l.value.clientHeight;s.value=y>E}else s.value=L.getRangeWidth(l.value)>l.value.getBoundingClientRect().width;d.value=s.value&&(n=l.value.textContent)!=null?n:"",e.nextTick(()=>{a.value=!0})},250)}function k(){clearTimeout(p.hover),p.hover=setTimeout(()=>{a.value=!1})}return{props:o,nh:t,tooltipNh:v,visible:s,active:a,content:d,transferTo:g,className:T,ellipsisStyle:N,tipStyle:b,wrapper:l,popper:f,handleTriggerEnter:C,handleTriggerLeave:k}}});function $(r,t,o,v,s,a){const u=e.resolveComponent("Portal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",e.mergeProps({ref:"wrapper",class:r.className,style:r.ellipsisStyle},r.$attrs,{onMouseenter:t[0]||(t[0]=(...i)=>r.handleTriggerEnter&&r.handleTriggerEnter(...i)),onMouseleave:t[1]||(t[1]=(...i)=>r.handleTriggerLeave&&r.handleTriggerLeave(...i))}),[e.renderSlot(r.$slots,"default")],16),r.visible?(e.openBlock(),e.createBlock(u,{key:0,to:r.transferTo},{default:e.withCtx(()=>[e.createVNode(e.Transition,{name:r.props.transitionName,appear:"",onAfterLeave:t[5]||(t[5]=i=>r.visible=!1)},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref:"popper",class:e.normalizeClass({[r.tooltipNh.be("popper")]:!0,[r.tooltipNh.bs("vars")]:!0,[r.tooltipNh.bem("popper","inherit")]:r.transferTo!=="body",[r.tooltipNh.bem("popper",r.props.tooltipTheme)]:!0,[r.tooltipNh.bem("popper","no-hover")]:r.props.noHover}),onClick:t[2]||(t[2]=e.withModifiers(()=>{},["stop"])),onMouseenter:t[3]||(t[3]=(...i)=>r.handleTriggerEnter&&r.handleTriggerEnter(...i)),onMouseleave:t[4]||(t[4]=(...i)=>r.handleTriggerLeave&&r.handleTriggerLeave(...i))},[e.createElementVNode("div",{class:e.normalizeClass([r.nh.be("tip"),r.tooltipNh.be("tip"),r.props.tipClass]),style:e.normalizeStyle(r.tipStyle)},[e.createElementVNode("div",{class:e.normalizeClass(r.tooltipNh.be("arrow"))},null,2),e.createTextVNode(" "+e.toDisplayString(r.content),1)],6)],34),[[e.vShow,r.active]])]),_:1},8,["name"])]),_:1},8,["to"])):e.createCommentVNode("",!0)],64)}var P=q(S,[["render",$]]);module.exports=P;
