"use strict";var e=require("vue");require("../icon/index.cjs");require("../resize-observer/index.cjs");require("../tab-nav-item/index.cjs");require("../../common/config/src/index.cjs");var A=require("@vexip-ui/icons"),V=require("@vexip-ui/hooks"),h=require("@vexip-ui/utils"),$=require("./props.cjs"),B=require("./symbol.cjs"),S=require("../../_virtual/plugin-vue_export-helper.cjs"),w=require("../icon/icon.cjs"),T=require("../resize-observer/resize-observer.cjs"),j=require("./tab-nav-item.cjs"),m=require("../../common/config/src/props.cjs"),P=require("../../common/config/src/namespace.cjs");const I={top:["left","width"],right:["top","height"],bottom:["left","width"],left:["top","height"]},M=e.defineComponent({name:"TabNav",components:{Icon:w,ResizeObserver:T,TabNavItem:j,Plus:A.Plus},props:$.tabNavProps,emits:["update:active"],setup(r,{emit:p}){const t=m.useProps("tabNav",r,{active:{default:null,static:!0},card:!1,options:{default:()=>[],static:!0},align:"left",placement:"top",closable:!1,showAdd:!1}),s=P.useNameHelper("tab-nav"),l=e.ref(t.active),d=e.ref(0),c=e.ref(0),n=new Set,v=V.useDisplay(u),f=e.computed(()=>({[s.b()]:!0,[s.bs("vars")]:!0,[s.bm("inherit")]:t.inherit,[s.bm(`align-${t.align}`)]:!0,[s.bm(t.placement)]:!0,[s.bm("card")]:t.card})),a=e.computed(()=>{const[o,i]=I[t.placement];return{[o]:`${d.value}px`,[i]:`${c.value}px`}}),N=e.computed(()=>t.options.map(o=>typeof o=="string"||typeof o=="number"?{label:o}:o)),b=h.debounceMinor(()=>{const o=n.size;Array.from(n).forEach((i,k)=>{i.index=k+1,i.total=o,h.isNull(i.label)&&(i.label=k+1)}),n.size>=1&&C()&&(l.value=Array.from(n)[0].label)});e.provide(B.TAB_NAV_STATE,e.reactive({currentActive:l,closable:e.toRef(t,"closable"),increaseItem:z,decreaseItem:g,handleActive:y,handleClose:E,refreshLabels:b})),e.watch(()=>t.active,o=>{l.value=o}),e.watch(()=>t.placement,()=>{requestAnimationFrame(u)}),e.onMounted(u);function C(){return h.isNull(l.value)||l.value===""}function z(o){n.add(o),b()}function g(o){n.delete(o),b()}function y(o){l.value=o,u(),m.emitEvent(t.onChange,o),p("update:active",o)}function q(){m.emitEvent(t.onAdd)}function E(o){m.emitEvent(t.onClose,o),requestAnimationFrame(u)}function u(){const o=Array.from(n).find(i=>i.label===l.value);o!=null&&o.el?t.placement==="top"||t.placement==="bottom"?(d.value=o.el.offsetLeft,c.value=o.el.offsetWidth):(d.value=o.el.offsetTop,c.value=o.el.offsetHeight):(d.value=0,c.value=0)}return{props:t,nh:s,className:f,markerStyle:a,items:N,wrapper:v,updateMarkerPosition:u,handleAdd:q}}});function O(r,p,t,s,l,d){const c=e.resolveComponent("ResizeObserver"),n=e.resolveComponent("TabNavItem"),v=e.resolveComponent("Plus"),f=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{ref:"wrapper",class:e.normalizeClass(r.className),tabindex:"-1"},[e.createElementVNode("ul",{class:e.normalizeClass(r.nh.be("list")),role:"tablist"},[e.createVNode(c,{"on-resize":r.updateMarkerPosition},{default:e.withCtx(()=>[e.createElementVNode("li",{class:e.normalizeClass([r.nh.be("extra"),r.nh.bem("extra","prefix")])},[r.$slots.prefix?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(r.nh.be("prefix"))},[e.renderSlot(r.$slots,"prefix")],2)):e.createCommentVNode("",!0)],2)]),_:3},8,["on-resize"]),e.renderSlot(r.$slots,"default",{},()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.items,a=>(e.openBlock(),e.createBlock(n,{key:a.label,label:a.label,icon:a.icon,disabled:a.disabled,closable:a.closable,onToggle:a.onToggle},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.content||a.label),1)]),_:2},1032,["label","icon","disabled","closable","onToggle"]))),128))]),r.props.showAdd||r.$slots.add?(e.openBlock(),e.createElementBlock("li",{key:0,class:e.normalizeClass(r.nh.be("item")),role:"none"},[e.createElementVNode("div",{class:e.normalizeClass(r.nh.be("pad"))},null,2),e.createElementVNode("button",{class:e.normalizeClass(r.nh.be("add")),onClick:p[0]||(p[0]=(...a)=>r.handleAdd&&r.handleAdd(...a))},[e.renderSlot(r.$slots,"add",{},()=>[e.createVNode(f,{scale:1.2},{default:e.withCtx(()=>[e.createVNode(v)]),_:1},8,["scale"])])],2)],2)):e.createCommentVNode("",!0),e.createVNode(c,{"on-resize":r.updateMarkerPosition},{default:e.withCtx(()=>[e.createElementVNode("li",{class:e.normalizeClass([r.nh.be("extra"),r.nh.bem("extra","suffix")])},[r.$slots.suffix?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(r.nh.be("suffix"))},[e.renderSlot(r.$slots,"suffix")],2)):e.createCommentVNode("",!0)],2)]),_:3},8,["on-resize"])],2),r.props.card?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(r.nh.be("track")),style:e.normalizeStyle(r.markerStyle)},[e.renderSlot(r.$slots,"marker",{},()=>[e.createElementVNode("div",{class:e.normalizeClass(r.nh.be("marker"))},null,2)])],6))],2)}var R=S(M,[["render",O]]);module.exports=R;
