"use strict";var e=require("vue");require("../icon/index.cjs");require("../menu/index.cjs");require("../native-scroll/index.cjs");var f=require("@vexip-ui/icons");require("../../common/config/src/index.cjs");var M=require("./props.cjs"),g=require("./helper.cjs"),c=require("../../common/config/src/props.cjs"),R=require("../../common/config/src/namespace.cjs"),w=require("../native-scroll/native-scroll.cjs"),A=require("../menu/menu.cjs"),C=require("../icon/icon.cjs"),$=e.defineComponent({name:"LayoutAside",props:M.layoutAsideProps,emits:["update:reduced","update:expanded"],setup(V,{slots:o,emit:h,expose:q}){const a=c.useProps("layout",V,{tag:"aside",reduced:!1,menus:{default:()=>[],static:!0},menuProps:null,logo:"",signName:"",fixed:"lg",onReducedChange:null,onExpandedChange:null,onSignClick:null,onMenuSelect:null}),t=R.useNameHelper("layout"),i=g.useLayoutState(),r=e.ref(a.reduced),d=e.ref(a.expanded),s=e.ref("100%"),x=g.useMediaQuery(e.toRef(a,"fixed")),y=g.useUpdateCounter(),p=e.ref(),m=e.ref(),v=e.ref(null),S=e.computed(()=>[t.be("aside"),{[t.bs("vars")]:!i.isLayout,[t.bem("aside","inherit")]:i.isLayout||a.inherit,[t.bem("aside","fixed")]:x.value,[t.bem("aside","expanded")]:d.value,[t.bem("aside","reduced")]:r.value}]),j=e.computed(()=>!!(a.logo||a.signName||o.top)),E=e.computed(()=>{var n,u;return!!(((n=a.menus)==null?void 0:n.length)||((u=a.menuProps)==null?void 0:u.router))});q({menu:v,expandMenuByLabel:k}),e.watch(()=>a.reduced,n=>{r.value=n}),e.watch(()=>a.expanded,n=>{d.value=n}),e.watch(x,n=>{i.expanded=!n},{immediate:!0}),e.watch(y,()=>L);function L(){let n=0,u=0;p.value&&(n=p.value.offsetHeight),m.value&&(u=m.value.offsetHeight),n||u?s.value=`calc(100% - ${n+u}px)`:s.value="100%"}function b(n=!r.value){r.value=n,c.emitEvent(a.onReducedChange,n),h("update:reduced",n)}function N(n=!d.value){d.value=n,c.emitEvent(a.onExpandedChange,n),h("update:expanded",n)}function H(n){c.emitEvent(a.onSignClick,n)}function P(n,u){c.emitEvent(a.onMenuSelect,n,u)}function k(n){var u;(u=v.value)==null||u.expandItemByLabel(n)}function l(){return{reduced:r.value,toggleReduce:b,toggleExpand:N}}return()=>{const n=a.tag||"aside";return e.createVNode(n,{class:S.value},{default:()=>[j.value&&e.createVNode("div",{ref:p,class:t.be("aside-top")},[o.top?o.top(l()):e.createVNode("div",{class:t.be("sign"),onClick:H},[a.logo&&e.createVNode("div",{class:t.be("logo")},[e.createVNode("img",{src:a.logo,alt:"Logo"},null)]),a.signName&&e.createVNode("span",{class:t.be("sign-name")},[a.signName])])]),e.createVNode(w,{class:t.be("aside-main"),height:s.value},{default:()=>[o.default?o.default(l()):E.value?e.createVNode(A,e.mergeProps({ref:v},a.menuProps||{},{transfer:!0,options:a.menus,reduced:r.value,onSelect:P}),null):null]}),e.createVNode("div",{ref:m,class:t.be("aside-bottom")},[o.bottom?o.bottom(l()):e.createVNode("div",{class:t.be("reduce-handler"),onClick:()=>b()},[e.createVNode(C,{icon:r.value?f.Indent:f.Outdent},null)])]),e.createVNode("div",{class:t.be("expand-handler"),onClick:()=>N()},[o.expand?o.expand(l()):e.createVNode(C,null,{default:()=>[e.createVNode(f.CaretRight,null,null)]})])]})}}});module.exports=$;
