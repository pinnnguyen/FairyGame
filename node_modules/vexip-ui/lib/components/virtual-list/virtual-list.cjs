"use strict";var e=require("vue");require("../native-scroll/index.cjs");require("../resize-observer/index.cjs");require("../../common/config/src/index.cjs");var Y=require("@vexip-ui/hooks"),Z=require("./props.cjs"),h=require("../native-scroll/native-scroll.cjs"),u=require("../resize-observer/resize-observer.cjs"),m=require("../../common/config/src/props.cjs"),_=require("../../common/config/src/namespace.cjs"),ee=e.defineComponent({name:"VirtualList",components:{NativeScroll:h,ResizeObserver:u},inheritAttrs:!1,props:Z.virtualListProps,emits:[],setup(g,{slots:r,attrs:x,expose:S}){const t=m.useProps("virtualList",g,{items:{default:()=>[],static:!0},itemSize:36,itemFixed:!1,idKey:"id",defaultKeyAt:null,bufferSize:5,listTag:"div",itemsTag:"ul",itemsAttrs:null}),o=_.useNameHelper("virtual-list"),{items:b,itemSize:R,itemFixed:q,idKey:I,bufferSize:T}=e.toRefs(t),i=e.ref(),d=e.ref(),v=e.computed(()=>{var s,l;return(l=(s=i.value)==null?void 0:s.content)!=null?l:null}),{indexMap:V,scrollOffset:f,visibleItems:j,listStyle:k,itemsStyle:K,handleScroll:A,handleResize:N,handleItemResize:F,scrollTo:L,scrollBy:w,scrollToKey:O,scrollToIndex:P,ensureIndexInView:C,ensureKeyInView:E}=Y.useVirtual({items:b,itemSize:R,itemFixed:q,idKey:I,bufferSize:T,wrapper:v,defaultKeyAt:t.defaultKeyAt,autoResize:!1});S({scroll:i,wrapper:v,list:d,scrollOffset:f,scrollTo:L,scrollBy:w,scrollToKey:O,scrollToIndex:P,ensureIndexInView:C,ensureKeyInView:E,refresh:c}),e.watch(()=>t.items.length,()=>{e.nextTick(c)});function M(s){A(),m.emitEvent(t.onScroll,s)}function B(s){N(s),m.emitEvent(t.onResize,s)}function c(){var s;(s=i.value)==null||s.refresh()}return()=>{const s=t.idKey,l=t.itemFixed,H=V.value,p=r.default,{class:$,style:D,...G}=t.itemsAttrs||{},J=t.listTag||"div",Q=t.itemsTag||"ul";let U=j.value;return e.createVNode(h,e.mergeProps({ref:i,inherit:t.inherit,class:o.b(),"use-y-bar":!0,"scroll-y":f.value},x,{onScroll:M,onResize:B}),{default:()=>[e.createVNode(u,{throttle:!0,onResize:c},{default:()=>[e.createVNode(J,{ref:d,class:o.be("list"),style:k.value},{default:()=>[e.createVNode(Q,e.mergeProps(G,{class:[o.be("items"),$],style:[K.value,D]}),{default:()=>{var y;return[p&&t.items.length?U.map(z=>{const n=z[s],W=H.get(n),a=p({item:z,index:W})[0];if(l)return a.key=n,a;const X=F.bind(null,n);return e.createVNode(u,{key:n,throttle:!0,onResize:X},{default:()=>a})}):(y=r.empty)==null?void 0:y.call(r)]}})]})]})]})}}});module.exports=ee;
