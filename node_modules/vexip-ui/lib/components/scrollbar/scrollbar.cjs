"use strict";var t=require("vue");require("../../common/config/src/index.cjs");var m=require("@vexip-ui/utils"),N=require("./props.cjs"),U=require("./hooks.cjs"),b=require("./symbol.cjs"),H=require("../../_virtual/plugin-vue_export-helper.cjs"),p=require("../../common/config/src/props.cjs"),O=require("../../common/config/src/namespace.cjs");const X=Object.freeze(["top","right","bottom","left"]),Y=t.defineComponent({name:"Scrollbar",props:N.scrollbarProps,emits:[],setup(l){const r=p.useProps("scrollbar",l,{placement:{default:"right",validator:e=>X.includes(e)},scroll:{default:0,validator:e=>e>=0&&e<=100,static:!0},barLength:{default:35,validator:e=>e>0&&e<100},width:null,appear:!1,fade:1500,barColor:null,trackColor:null,disabled:!1,wrapper:null,duration:null,useTrack:!1,trackSpeed:{default:2,validator:e=>e>0&&e<10}}),a=O.useNameHelper("scrollbar"),d=t.ref(!1),n=t.ref(r.scroll),f=t.ref(!1),i=t.ref(),h=t.ref(),g=t.ref();let u;const E=t.computed(()=>r.placement==="right"||r.placement==="left"?b.ScrollbarType.VERTICAL:b.ScrollbarType.HORIZONTAL),{tracking:w,handleMouseDown:$}=U.useTrack({currentScroll:n,track:g,bar:h,type:E,trackSpeed:t.toRef(r,"trackSpeed"),barLength:t.toRef(r,"barLength"),disabled:t.toRef(r,"disabled"),handleDown:e=>{clearTimeout(u),p.emitEvent(r.onScrollStart,e)},handleMove:()=>clearTimeout(u),handleUp:e=>{v(),p.emitEvent(r.onScrollEnd,e)},handleScroll:e=>{p.emitEvent(r.onScroll,e)}}),q=t.computed(()=>[a.b(),a.bs("vars"),a.bm(r.placement),{[a.bm("inherit")]:r.inherit,[a.bm("fade")]:r.fade,[a.bm("scrolling")]:f.value,[a.bm("tracking")]:w.value,[a.bm("active")]:d.value,[a.bm("disabled")]:r.disabled}]),j=t.computed(()=>({[a.cv("bar-bg-color")]:r.barColor,[a.cv("track-bg-color")]:r.trackColor,[a.cv("width")]:r.width?`${r.width}px`:null})),I=t.computed(()=>{const e={},o=`${(100-r.barLength)*n.value/r.barLength}%`,c=`${r.barLength}%`;return E.value===b.ScrollbarType.VERTICAL?(e.height=c,e.transform=`translate3d(0, ${o}, 0)`):(e.width=c,e.transform=`translate3d(${o}, 0, 0)`),m.isDefined(r.duration)&&r.duration>=0&&(e.transitionDuration=`${r.duration}ms`),e});t.watch(()=>r.scroll,e=>{n.value=e}),r.appear&&t.watch(n,()=>{clearInterval(u),d.value=!0,!f.value&&!w.value&&v()});const y=m.throttle(()=>{clearTimeout(u),r.disabled?d.value=!1:(d.value=!0,!f.value&&!w.value&&v())});let s;t.onMounted(()=>{let e=t.getCurrentInstance();t.nextTick(()=>{var o,c,C,D,R;typeof r.wrapper=="string"?s=document.querySelector(r.wrapper):s=r.wrapper,s||(e!=null&&e.parent?(s=(o=e.parent.proxy)==null?void 0:o.$el,s||(s=(C=(c=i.value)==null?void 0:c.parentElement)!=null?C:null)):s=(R=(D=i.value)==null?void 0:D.parentElement)!=null?R:null),s&&r.fade>=300&&s.addEventListener("mousemove",y),e=null,r.appear||t.watch(n,()=>{clearInterval(u),d.value=!0,v()})})}),t.onBeforeUnmount(()=>{s&&s.removeEventListener("mousemove",y),s=null,clearTimeout(u)});let k,S,T;function P(e){if(e.button!==0||r.disabled||(e.stopPropagation(),e.preventDefault(),!g.value||!h.value))return!1;document.addEventListener("pointermove",L),document.addEventListener("pointerup",M);const o=g.value.getBoundingClientRect(),c=h.value.getBoundingClientRect();E.value===b.ScrollbarType.VERTICAL?(k=o.height,S=c.top-o.top,T=e.clientY):(k=o.width,S=c.left-o.left,T=e.clientX),clearTimeout(u),f.value=!0,p.emitEvent(r.onScrollStart,n.value)}const A=m.throttle(e=>{let o;E.value===b.ScrollbarType.VERTICAL?o=S+e.clientY-T:o=S+e.clientX-T,n.value=o/k/(100-r.barLength)*1e4,V(),p.emitEvent(r.onScroll,n.value)});function L(e){e.stopPropagation(),m.USE_TOUCH||e.preventDefault(),clearTimeout(u),A(e)}function M(e){e.preventDefault(),document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",M),v(),f.value=!1,p.emitEvent(r.onScrollEnd,n.value)}function V(){n.value=Math.max(0,Math.min(n.value,100))}function v(){r.fade>=300&&(u=setTimeout(()=>{d.value=!1},r.fade))}function z(e){n.value=m.boundRange(e,0,100)}function B(e){e.cancelable&&(e.stopPropagation(),e.preventDefault())}return{props:r,nh:a,currentScroll:n,className:q,style:j,barStyle:I,contaniner:i,bar:h,track:g,handleMouseDown:P,handleTrackMouseDown:$,handleScroll:z,disableEvent:B}}});function F(l,r,a,d,n,f){return t.openBlock(),t.createElementBlock("div",{ref:"contaniner",class:t.normalizeClass(l.className),role:"scrollbar",style:t.normalizeStyle(l.style)},[t.createElementVNode("div",{ref:"track",class:t.normalizeClass([l.nh.be("track"),l.props.useTrack?null:l.nh.bem("track","disabled")]),onTouchstart:r[0]||(r[0]=(...i)=>l.disableEvent&&l.disableEvent(...i)),onPointerdown:r[1]||(r[1]=(...i)=>l.handleTrackMouseDown&&l.handleTrackMouseDown(...i))},null,34),t.createElementVNode("div",{ref:"bar",class:t.normalizeClass(l.nh.be("bar")),style:t.normalizeStyle(l.barStyle),onTouchstart:r[2]||(r[2]=(...i)=>l.disableEvent&&l.disableEvent(...i)),onPointerdown:r[3]||(r[3]=(...i)=>l.handleMouseDown&&l.handleMouseDown(...i))},null,38)],6)}var W=H(Y,[["render",F]]);module.exports=W;
