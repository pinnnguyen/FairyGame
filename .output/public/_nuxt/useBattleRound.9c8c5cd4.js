import{o as U,a as z,s as W}from"./index.ef37a08c.js";import{e as k,i,o as f,c as K,z as q,B as t,t as n,l as y,p as R,K as D,C as B,u as L,J as M,D as J,E as H,F as Q,L as X,G as Z,M as ee}from"./entry.5e8a55ee.js";import{s as p}from"./usePlayer.4510c797.js";const te={class:"text-white bg-[#3f51b5] p-4"},ae={class:"pb-[2px] font-medium"},ge=k({__name:"info",props:{name:null,hp:null,damage:null,def:null},emits:["close"],setup(e,{emit:u}){const c=i(null);return U(c,()=>u("close")),(s,m)=>{const l=z;return f(),K(l,null,{default:q(()=>[t("div",{ref_key:"target",ref:c,class:"flex justify-start flex-col mt-2 text-10"},[t("div",te,[t("span",ae,n(e.name),1),t("p",null," Sinh l\u1EF1c: "+n(e.hp),1),t("p",null," C\xF4ng k\xEDch "+n(e.damage),1),t("p",null," Ph\xF2ng ng\u1EF1 "+n(e.def),1)])],512)]),_:1})}}}),se={class:"mt-2"},ne={class:"flex items-center justify-start"},le={class:"h-[5px] w-15 rounded-full bg-[#212121] flex items-center p-[2px]"},re={class:"flex items-center justify-start mt-[1px]"},ce={class:"h-[5px] w-15 rounded-full bg-[#212121] flex items-center p-[2px]"},V=k({__name:"status-bar",props:{receiverHp:null,hp:null,mp:null,receiverMp:null},setup(e){return(u,c)=>(f(),y("div",se,[t("div",ne,[t("div",le,[t("div",{class:"h-[2px] w-full rounded-full bg-red-600",style:R({width:`${e.receiverHp/e.hp*100}%`})},null,4)])]),t("div",re,[t("div",ce,[t("div",{class:"h-[2px] w-full rounded-full bg-blue-600",style:R({width:`${e.receiverMp/e.mp*100}%`})},null,4)])])]))}}),ve={MONSTER:"monster",BOSS_DAILY:"boss-daily",BOSS_FRAME_TIME:"boss-frame-time"},Ee={youwin:"youwin",youlose:"youlose"},A={PLAYER:"player",ENEMY:"enemy"},_e={PVE:"pve",PVP:"pvp",BOSS_FRAME_TIME:"boss_frame_time",BOSS_DAILY:"boss_daily",DUNGEON:"dungeon"},oe={key:0,class:"whitespace-nowrap font-bold"},ie={key:1},be=k({__name:"player-realtime",props:{playerEffect:null,realTime:null,state:null,receiver:null},setup(e){return(u,c)=>{var l,x,r,d,o,E,_,b,T,v,w,a;const s=M,m=V;return f(),y("div",{class:"relative duration-800 transition-transform flex flex-col items-center justify-center",style:R({transform:e.playerEffect===L(A).PLAYER?"translate(30%)":""})},[t("span",{class:D(["text-[#22ae28] font-semibold battle-damage whitespace-nowrap",{show:((l=e.realTime.enemy)==null?void 0:l.bloodsucking)>0&&e.realTime.enemy.trueDamage}])}," H\xFAt (+"+n((x=e.realTime.enemy)==null?void 0:x.bloodsucking)+") ",3),t("span",{class:D(["duration-800 text-xl font-semibold text-red-500 battle-damage",{show:e.realTime.player.trueDamage}])},[(d=(r=e.realTime)==null?void 0:r.player)!=null&&d.critical?(f(),y("span",oe," Ch\xED m\u1EA1ng -"+n(e.realTime.player.dmg),1)):(f(),y("span",ie,"-"+n(e.realTime.player.dmg),1))],2),B(s,{format:"webp",class:"h-[100px]",src:"/pve/nv1.png"}),B(m,{"receiver-hp":(E=(o=e.receiver)==null?void 0:o.player)==null?void 0:E.hp,hp:(b=(_=e.state)==null?void 0:_.player)==null?void 0:b.hp,"receiver-mp":(v=(T=e.receiver)==null?void 0:T.player)==null?void 0:v.mp,mp:(a=(w=e.state)==null?void 0:w.player)==null?void 0:a.mp},null,8,["receiver-hp","hp","receiver-mp","mp"])],4)}}}),ue={key:0,class:"whitespace-nowrap font-bold"},me={key:1},Te=k({__name:"enemy-realtime",props:{playerEffect:null,realTime:null,state:null,receiver:null},setup(e){return(u,c)=>{var l,x,r,d,o,E,_,b,T,v,w,a;const s=M,m=V;return f(),y("div",{class:"relative duration-800 transition-transform flex flex-col items-center justify-center",style:R({transform:e.playerEffect===L(A).ENEMY?"translate(-30%)":""})},[t("span",{class:D(["text-[#22ae28] font-semibold battle-damage whitespace-nowrap",{show:((l=e.realTime.player)==null?void 0:l.bloodsucking)>0&&e.realTime.enemy.trueDamage}])}," H\xFAt (+"+n((x=e.realTime.player)==null?void 0:x.bloodsucking)+") ",3),t("span",{class:D(["text-xl duration-800 font-semibold text-red-500 battle-damage",{show:e.realTime.enemy.trueDamage}])},[(d=(r=e.realTime)==null?void 0:r.enemy)!=null&&d.critical?(f(),y("span",ue," Ch\xED m\u1EA1ng -"+n(e.realTime.enemy.dmg),1)):(f(),y("span",me,"-"+n(e.realTime.enemy.dmg),1))],2),B(s,{format:"webp",class:"h-[100px]",src:"/pve/nv2.png"}),B(m,{"receiver-hp":(E=(o=e.receiver)==null?void 0:o.enemy)==null?void 0:E.hp,hp:(b=(_=e.state)==null?void 0:_.enemy)==null?void 0:b.hp,"receiver-mp":(v=(T=e.receiver)==null?void 0:T.enemy)==null?void 0:v.mp,mp:(a=(w=e.state)==null?void 0:w.enemy)==null?void 0:a.mp},null,8,["receiver-hp","hp","receiver-mp","mp"])],4)}}}),de={class:"text-10"},pe={class:"text-red-600"},Ae=k({__name:"history",props:{battleRounds:null},setup(e){return(u,c)=>(f(!0),y(Q,null,J(e.battleRounds,(s,m)=>(f(),y("div",{key:m,class:"mb-2 border-b border-gray-300 duration-500"},[t("h3",de," [L\u01B0\u1EE3t "+n(s.roundNum)+"] ",1),t("strong",null,n(s.turn===L(A).PLAYER?"B\u1EA1n":"Muc Ti\xEAu"),1),H(" g\xE2y "),t("strong",pe,n(s.damage),1),H(" s\xE1t th\u01B0\u01A1ng l\xEAn "),t("strong",null,n(s.turn===L(A).PLAYER?"M\u1EE5c ti\xEAu":"B\u1EA1n"),1)]))),128))}}),fe=["onClick"],we={__name:"ButtonCancel",props:{className:String},emits:["close"],setup(e,{emit:u}){const c=()=>{u("close")};return(s,m)=>{const l=M;return f(),y("button",{class:D([e.className,"text-xxs relative p-4 h-[30px] flex items-center justify-center text-[#8d734b]"]),onClick:Z(c,["stop"])},[B(l,{class:D([e.className,"absolute object-cover rounded"]),format:"webp",src:"/button/btn_xfy_qf_0.png"},null,8,["class"]),X(s.$slots,"default")],10,fe)}}},De=ee("battleRound",()=>{const e=i(!0),u=i(""),c=i([]),s=i([]),m=i(!1),l=i(0),x=i(),r=i({}),d=i({}),o=i({player:{critical:!1,bloodsucking:0,trueDamage:!1,dmg:0},enemy:{critical:!1,trueDamage:!1,bloodsucking:0,dmg:0}}),E=2e3,_=700,b=700,T=1e3,v=i({show:!1,win:""});return{state:r,reward:x,loading:e,receiver:d,realTime:o,inRefresh:m,startBattle:async a=>{var $,Y,C,I,P,F;if(console.log("war",a),p(m,!1),p(l,0),p(e,!1),p(c,[]),p(x,null),p(s,a.rankDMG),!a)return;if(p(x,a.reward),r.value.player=a.player,r.value.enemy=a.enemy,d.value={player:{hp:($=r.value.player)==null?void 0:$.hp,mp:(Y=r.value.player)==null?void 0:Y.mp},enemy:{hp:(C=r.value.enemy)==null?void 0:C.hp,mp:(I=r.value.enemy)==null?void 0:I.mp}},a.inRefresh){p(m,a.inRefresh),p(l,a.refreshTime);return}let S=0;for(const O of a.emulators)for(const j in O){S++;const N=j.replace(/1_|2_/g,""),g=N===A.PLAYER?A.ENEMY:A.PLAYER,h=O[j],G=(P=h==null?void 0:h.state)==null?void 0:P.damage;if(h.action&&(await W(E),p(u,N),d.value[g].hp=h.now.hp[g],d.value[g].mp=h.now.mp[N],o.value[g].dmg=G,o.value[g].trueDamage=!0,o.value[g].critical=(F=h==null?void 0:h.state)==null?void 0:F.critical,o.value[g].bloodsucking=h.state.bloodsucking,c.value.unshift({turn:N,damage:G,roundNum:S}),setTimeout(()=>{p(u,"")},_),setTimeout(()=>{o.value[g].trueDamage=!1},b),d.value[g].hp<=0)){setTimeout(()=>{v.value={show:!0,win:a.winner}},T);return}}},refreshTime:l,playerEffect:u,battleRounds:c,battleResult:v,rankDMG:s}});export{_e as B,ve as T,Ee as W,ge as _,be as a,Te as b,Ae as c,we as d,De as u};
