import{o as V,a as U,s as z}from"./index.cdedaa16.js";import{e as B,i,o as f,c as W,z as K,B as t,t as n,l as g,p as R,G as k,C as N,u as L,F as j,H as J,I as H,J as q,K as Q}from"./entry.e04b7afd.js";import{s as p}from"./usePlayer.703c932a.js";const X={class:"text-white bg-[#3f51b5] p-4"},Z={class:"pb-[2px] font-medium"},fe=B({__name:"info",props:{name:null,hp:null,damage:null,def:null},emits:["close"],setup(e,{emit:h}){const u=i(null);return V(u,()=>h("close")),(s,m)=>{const c=U;return f(),W(c,null,{default:K(()=>[t("div",{ref_key:"target",ref:u,class:"flex justify-start flex-col mt-2 text-10"},[t("div",X,[t("span",Z,n(e.name),1),t("p",null," Sinh l\u1EF1c: "+n(e.hp),1),t("p",null," C\xF4ng k\xEDch "+n(e.damage),1),t("p",null," Ph\xF2ng ng\u1EF1 "+n(e.def),1)])],512)]),_:1})}}}),ee={class:"mt-2"},te={class:"flex items-center justify-start"},ae={class:"h-[5px] w-15 rounded-full bg-[#212121] flex items-center p-[2px]"},ne={class:"flex items-center justify-start mt-[1px]"},se={class:"h-[5px] w-15 rounded-full bg-[#212121] flex items-center p-[2px]"},G=B({__name:"status-bar",props:{receiverHp:null,hp:null,mp:null,receiverMp:null},setup(e){return(h,u)=>(f(),g("div",ee,[t("div",te,[t("div",ae,[t("div",{class:"h-[2px] w-full rounded-full bg-red-600",style:R({width:`${e.receiverHp/e.hp*100}%`})},null,4)])]),t("div",ne,[t("div",se,[t("div",{class:"h-[2px] w-full rounded-full bg-blue-600",style:R({width:`${e.receiverMp/e.mp*100}%`})},null,4)])])]))}}),he={MONSTER:"monster",BOSS_DAILY:"boss-daily"},ye={youwin:"youwin",youlose:"youlose"},A={PLAYER:"player",ENEMY:"enemy"},ge={PVE:"pve",PVP:"pvp",BOSS:"boss",BOSS_DAILY:"boss_daily",DUNGEON:"dungeon"},le={key:0,class:"whitespace-nowrap font-bold"},re={key:1},ve=B({__name:"player-realtime",props:{playerEffect:null,realTime:null,state:null,receiver:null},setup(e){return(h,u)=>{var c,l,o,r,E,b,_,T,v,w,a,x;const s=j,m=G;return f(),g("div",{class:"relative duration-800 transition-transform flex flex-col items-center justify-center",style:R({transform:e.playerEffect===L(A).PLAYER?"translate(30%)":""})},[t("span",{class:k(["text-[#22ae28] font-semibold battle-damage whitespace-nowrap",{show:((c=e.realTime.enemy)==null?void 0:c.bloodsucking)>0&&e.realTime.enemy.trueDamage}])}," H\xFAt (+"+n((l=e.realTime.enemy)==null?void 0:l.bloodsucking)+") ",3),t("span",{class:k(["duration-800 text-xl font-semibold text-red-500 battle-damage",{show:e.realTime.player.trueDamage}])},[(r=(o=e.realTime)==null?void 0:o.player)!=null&&r.critical?(f(),g("span",le," Ch\xED m\u1EA1ng -"+n(e.realTime.player.dmg),1)):(f(),g("span",re,"-"+n(e.realTime.player.dmg),1))],2),N(s,{format:"webp",class:"h-[100px]",src:"/pve/nv1.png"}),N(m,{"receiver-hp":(b=(E=e.receiver)==null?void 0:E.player)==null?void 0:b.hp,hp:(T=(_=e.state)==null?void 0:_.player)==null?void 0:T.hp,"receiver-mp":(w=(v=e.receiver)==null?void 0:v.player)==null?void 0:w.mp,mp:(x=(a=e.state)==null?void 0:a.player)==null?void 0:x.mp},null,8,["receiver-hp","hp","receiver-mp","mp"])],4)}}}),ce={key:0,class:"whitespace-nowrap font-bold"},oe={key:1},xe=B({__name:"enemy-realtime",props:{playerEffect:null,realTime:null,state:null,receiver:null},setup(e){return(h,u)=>{var c,l,o,r,E,b,_,T,v,w,a,x;const s=j,m=G;return f(),g("div",{class:"relative duration-800 transition-transform flex flex-col items-center justify-center",style:R({transform:e.playerEffect===L(A).ENEMY?"translate(-30%)":""})},[t("span",{class:k(["text-[#22ae28] font-semibold battle-damage whitespace-nowrap",{show:((c=e.realTime.player)==null?void 0:c.bloodsucking)>0&&e.realTime.enemy.trueDamage}])}," H\xFAt (+"+n((l=e.realTime.player)==null?void 0:l.bloodsucking)+") ",3),t("span",{class:k(["text-xl duration-800 font-semibold text-red-500 battle-damage",{show:e.realTime.enemy.trueDamage}])},[(r=(o=e.realTime)==null?void 0:o.enemy)!=null&&r.critical?(f(),g("span",ce," Ch\xED m\u1EA1ng -"+n(e.realTime.enemy.dmg),1)):(f(),g("span",oe,"-"+n(e.realTime.enemy.dmg),1))],2),N(s,{format:"webp",class:"h-[100px]",src:"/pve/nv2.png"}),N(m,{"receiver-hp":(b=(E=e.receiver)==null?void 0:E.enemy)==null?void 0:b.hp,hp:(T=(_=e.state)==null?void 0:_.enemy)==null?void 0:T.hp,"receiver-mp":(w=(v=e.receiver)==null?void 0:v.enemy)==null?void 0:w.mp,mp:(x=(a=e.state)==null?void 0:a.enemy)==null?void 0:x.mp},null,8,["receiver-hp","hp","receiver-mp","mp"])],4)}}}),ie={class:"text-10"},ue={class:"text-red-600"},Ee=B({__name:"history",props:{battleRounds:null},setup(e){return(h,u)=>(f(!0),g(q,null,J(e.battleRounds,(s,m)=>(f(),g("div",{key:m,class:"mb-2 border-b border-gray-300 duration-500"},[t("h3",ie," [L\u01B0\u1EE3t "+n(s.roundNum)+"] ",1),t("strong",null,n(s.turn===L(A).PLAYER?"B\u1EA1n":"Muc Ti\xEAu"),1),H(" g\xE2y "),t("strong",ue,n(s.damage),1),H(" s\xE1t th\u01B0\u01A1ng l\xEAn "),t("strong",null,n(s.turn===L(A).PLAYER?"M\u1EE5c ti\xEAu":"B\u1EA1n"),1)]))),128))}}),be=Q("battleRound",()=>{const e=i(!0),h=i(""),u=i([]),s=i(!1),m=i(0),c=i(),l=i({}),o=i({}),r=i({player:{critical:!1,bloodsucking:0,trueDamage:!1,dmg:0},enemy:{critical:!1,trueDamage:!1,bloodsucking:0,dmg:0}}),E=2e3,b=700,_=700,T=1e3,v=i({show:!1,win:""});return{state:l,reward:c,loading:e,receiver:o,realTime:r,inRefresh:s,startBattle:async a=>{var Y,S,$,M,P,I;if(console.log("war",a),p(s,!1),p(m,0),p(e,!1),p(u,[]),p(c,null),!a)return;if(p(c,a.reward),l.value.player=a.player,l.value.enemy=a.enemy,o.value={player:{hp:(Y=l.value.player)==null?void 0:Y.hp,mp:(S=l.value.player)==null?void 0:S.mp},enemy:{hp:($=l.value.enemy)==null?void 0:$.hp,mp:(M=l.value.enemy)==null?void 0:M.mp}},a.inRefresh){p(s,a.inRefresh),p(m,a.refreshTime);return}let x=0;for(const C of a.emulators)for(const F in C){x++;const D=F.replace(/1_|2_/g,""),y=D===A.PLAYER?A.ENEMY:A.PLAYER,d=C[F],O=(P=d==null?void 0:d.state)==null?void 0:P.damage;if(d.action&&(await z(E),p(h,D),o.value[y].hp=d.now.hp[y],o.value[y].mp=d.now.mp[D],r.value[y].dmg=O,r.value[y].trueDamage=!0,r.value[y].critical=(I=d==null?void 0:d.state)==null?void 0:I.critical,r.value[y].bloodsucking=d.state.bloodsucking,u.value.unshift({turn:D,damage:O,roundNum:x}),setTimeout(()=>{p(h,"")},b),setTimeout(()=>{r.value[y].trueDamage=!1},_),o.value[y].hp<=0)){setTimeout(()=>{v.value={show:!0,win:a.winner}},T);return}}},refreshTime:m,playerEffect:h,battleRounds:u,battleResult:v}});export{ge as B,he as T,ye as W,fe as _,ve as a,xe as b,Ee as c,be as u};
