import{a as re,i as q,a3 as _t,a4 as Nt,z as Te,w as be,u as t,a5 as Dt,j as A,r as ie,a0 as ge,e as U,a6 as Lt,U as ae,a7 as Mt,B as v,a8 as Vt,a9 as Ht,C as at,D as it,aa as mt,T as yt,ab as bt,$ as Ft,ac as Gt,I as ht,o as i,c as I,E as x,s as n,W as G,X as we,v as T,t as _,p as K,A as S,ad as Kt,ae as Wt,af as Yt,K as Qt,l as m,F as C,q as R,d as He,_ as Fe,x as se,N as Z,G as z,R as ft,M as Jt,f as ne,ag as Ze,ah as Xt,H as Zt}from"./entry.303ba4a8.js";import{_ as _e,a as xe}from"./Line.938dcc9e.js";import{u as en,a as tn,s as N,S as nn}from"./useMessage.4ef409fc.js";import{u as Y,s as P}from"./usePlayer.4eda164d.js";import{q as J,p as Ge,f as me,r as Se,a as st,t as gt,b as wt}from"./index.040b5bdf.js";import Le from"./Icon.6e08e514.js";import{B as on,_ as Oe,a as ke}from"./ButtonSfc.676ad373.js";import{_ as et}from"./InputSfc.145169a3.js";import{_ as Qe}from"./_plugin-vue_export-helper.c27b6911.js";import{u as Ue,a as sn,T as Ne,t as le,_ as ln}from"./useBattleRound.ae7aabef.js";const an=()=>null;function rn(...e){var p;const a=typeof e[e.length-1]=="string"?e.pop():void 0;typeof e[0]!="string"&&e.unshift(a);let[s,o,l={}]=e;if(typeof s!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");l.server=l.server??!0,l.default=l.default??an,l.lazy=l.lazy??!1,l.immediate=l.immediate??!0;const r=re(),d=()=>r.isHydrating?r.payload.data[s]:r.static.data[s],u=()=>d()!==void 0;r._asyncData[s]||(r._asyncData[s]={data:q(d()??((p=l.default)==null?void 0:p.call(l))??null),pending:q(!u()),error:q(r.payload._errors[s]?_t(r.payload._errors[s]):null)});const c={...r._asyncData[s]};c.refresh=c.execute=(g={})=>{if(r._asyncDataPromises[s]){if(g.dedupe===!1)return r._asyncDataPromises[s];r._asyncDataPromises[s].cancelled=!0}if(g._initial&&u())return d();c.pending.value=!0;const h=new Promise((w,k)=>{try{w(o(r))}catch(B){k(B)}}).then(w=>{if(h.cancelled)return r._asyncDataPromises[s];l.transform&&(w=l.transform(w)),l.pick&&(w=cn(w,l.pick)),c.data.value=w,c.error.value=null}).catch(w=>{var k;if(h.cancelled)return r._asyncDataPromises[s];c.error.value=w,c.data.value=t(((k=l.default)==null?void 0:k.call(l))??null)}).finally(()=>{h.cancelled||(c.pending.value=!1,r.payload.data[s]=c.data.value,c.error.value&&(r.payload._errors[s]=_t(c.error.value)),delete r._asyncDataPromises[s])});return r._asyncDataPromises[s]=h,r._asyncDataPromises[s]};const f=()=>c.refresh({_initial:!0}),y=l.server!==!1&&r.payload.serverRendered;{const g=Dt();if(g&&!g._nuxtOnBeforeMountCbs){g._nuxtOnBeforeMountCbs=[];const w=g._nuxtOnBeforeMountCbs;g&&(Nt(()=>{w.forEach(k=>{k()}),w.splice(0,w.length)}),Te(()=>w.splice(0,w.length)))}y&&r.isHydrating&&u()?c.pending.value=!1:g&&(r.payload.serverRendered&&r.isHydrating||l.lazy)&&l.immediate?g._nuxtOnBeforeMountCbs.push(f):l.immediate&&f(),l.watch&&be(l.watch,()=>c.refresh());const h=r.hook("app:data:refresh",w=>{if(!w||w.includes(s))return c.refresh()});g&&Te(h)}const b=Promise.resolve(r._asyncDataPromises[s]).then(()=>c);return Object.assign(b,c),b}function cn(e,a){const s={};for(const o of a)s[o]=e[o];return s}const un={ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1};function dn(e,a={}){a={...un,...a};const s=xt(a);return s.dispatch(e),s.toString()}function xt(e){const a=[];let s=[];const o=l=>{a.push(l)};return{toString(){return a.join("")},getContext(){return s},dispatch(l){return e.replacer&&(l=e.replacer(l)),this["_"+(l===null?"null":typeof l)](l)},_object(l){const r=/\[object (.*)]/i,d=Object.prototype.toString.call(l),u=r.exec(d),c=u?u[1].toLowerCase():"unknown:["+d.toLowerCase()+"]";let f=null;if((f=s.indexOf(l))>=0)return this.dispatch("[CIRCULAR:"+f+"]");if(s.push(l),typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(l))return o("buffer:"),o(l.toString("utf8"));if(c!=="object"&&c!=="function"&&c!=="asyncfunction")if(this["_"+c])this["_"+c](l);else{if(e.ignoreUnknown)return o("["+c+"]");throw new Error('Unknown object type "'+c+'"')}else{let y=Object.keys(l);e.unorderedObjects&&(y=y.sort()),e.respectType!==!1&&!vt(l)&&y.splice(0,0,"prototype","__proto__","letructor"),e.excludeKeys&&(y=y.filter(function(b){return!e.excludeKeys(b)})),o("object:"+y.length+":");for(const b of y)this.dispatch(b),o(":"),e.excludeValues||this.dispatch(l[b]),o(",")}},_array(l,r){if(r=typeof r<"u"?r:e.unorderedArrays!==!1,o("array:"+l.length+":"),!r||l.length<=1){for(const c of l)this.dispatch(c);return}const d=[],u=l.map(c=>{const f=xt(e);return f.dispatch(c),d.push(f.getContext()),f.toString()});return s=[...s,...d],u.sort(),this._array(u,!1)},_date(l){return o("date:"+l.toJSON())},_symbol(l){return o("symbol:"+l.toString())},_error(l){return o("error:"+l.toString())},_boolean(l){return o("bool:"+l.toString())},_string(l){o("string:"+l.length+":"),o(l.toString())},_function(l){o("fn:"),vt(l)?this.dispatch("[native]"):this.dispatch(l.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(l.name)),e.respectFunctionProperties&&this._object(l)},_number(l){return o("number:"+l.toString())},_xml(l){return o("xml:"+l.toString())},_null(){return o("Null")},_undefined(){return o("Undefined")},_regexp(l){return o("regex:"+l.toString())},_uint8array(l){return o("uint8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint8clampedarray(l){return o("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(l))},_int8array(l){return o("int8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint16array(l){return o("uint16array:"),this.dispatch(Array.prototype.slice.call(l))},_int16array(l){return o("int16array:"),this.dispatch(Array.prototype.slice.call(l))},_uint32array(l){return o("uint32array:"),this.dispatch(Array.prototype.slice.call(l))},_int32array(l){return o("int32array:"),this.dispatch(Array.prototype.slice.call(l))},_float32array(l){return o("float32array:"),this.dispatch(Array.prototype.slice.call(l))},_float64array(l){return o("float64array:"),this.dispatch(Array.prototype.slice.call(l))},_arraybuffer(l){return o("arraybuffer:"),this.dispatch(new Uint8Array(l))},_url(l){return o("url:"+l.toString())},_map(l){o("map:");const r=[...l];return this._array(r,e.unorderedSets!==!1)},_set(l){o("set:");const r=[...l];return this._array(r,e.unorderedSets!==!1)},_file(l){return o("file:"),this.dispatch([l.name,l.size,l.type,l.lastModfied])},_blob(){if(e.ignoreUnknown)return o("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow(){return o("domwindow")},_bigint(l){return o("bigint:"+l.toString())},_process(){return o("process")},_timer(){return o("timer")},_pipe(){return o("pipe")},_tcp(){return o("tcp")},_udp(){return o("udp")},_tty(){return o("tty")},_statwatcher(){return o("statwatcher")},_securecontext(){return o("securecontext")},_connection(){return o("connection")},_zlib(){return o("zlib")},_context(){return o("context")},_nodescript(){return o("nodescript")},_httpparser(){return o("httpparser")},_dataview(){return o("dataview")},_signal(){return o("signal")},_fsevent(){return o("fsevent")},_tlswrap(){return o("tlswrap")}}}function vt(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code]\s+}$/i.exec(Function.prototype.toString.call(e))!=null}class Ve{constructor(a,s){a=this.words=a||[],this.sigBytes=s!==void 0?s:a.length*4}toString(a){return(a||pn).stringify(this)}concat(a){if(this.clamp(),this.sigBytes%4)for(let s=0;s<a.sigBytes;s++){const o=a.words[s>>>2]>>>24-s%4*8&255;this.words[this.sigBytes+s>>>2]|=o<<24-(this.sigBytes+s)%4*8}else for(let s=0;s<a.sigBytes;s+=4)this.words[this.sigBytes+s>>>2]=a.words[s>>>2];return this.sigBytes+=a.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new Ve([...this.words])}}const pn={stringify(e){const a=[];for(let s=0;s<e.sigBytes;s++){const o=e.words[s>>>2]>>>24-s%4*8&255;a.push((o>>>4).toString(16),(o&15).toString(16))}return a.join("")}},_n={stringify(e){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=[];for(let o=0;o<e.sigBytes;o+=3){const l=e.words[o>>>2]>>>24-o%4*8&255,r=e.words[o+1>>>2]>>>24-(o+1)%4*8&255,d=e.words[o+2>>>2]>>>24-(o+2)%4*8&255,u=l<<16|r<<8|d;for(let c=0;c<4&&o*8+c*6<e.sigBytes*8;c++)s.push(a.charAt(u>>>6*(3-c)&63))}return s.join("")}},mn={parse(e){const a=e.length,s=[];for(let o=0;o<a;o++)s[o>>>2]|=(e.charCodeAt(o)&255)<<24-o%4*8;return new Ve(s,a)}},hn={parse(e){return mn.parse(unescape(encodeURIComponent(e)))}};class fn{constructor(){this._minBufferSize=0,this.blockSize=512/32,this.reset()}reset(){this._data=new Ve,this._nDataBytes=0}_append(a){typeof a=="string"&&(a=hn.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes}_doProcessBlock(a,s){}_process(a){let s,o=this._data.sigBytes/(this.blockSize*4);a?o=Math.ceil(o):o=Math.max((o|0)-this._minBufferSize,0);const l=o*this.blockSize,r=Math.min(l*4,this._data.sigBytes);if(l){for(let d=0;d<l;d+=this.blockSize)this._doProcessBlock(this._data.words,d);s=this._data.words.splice(0,l),this._data.sigBytes-=r}return new Ve(s,r)}}class gn extends fn{update(a){return this._append(a),this._process(),this}finalize(a){a&&this._append(a)}}const vn=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],yn=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Re=[];class bn extends gn{constructor(){super(),this.reset()}reset(){super.reset(),this._hash=new Ve([...vn])}_doProcessBlock(a,s){const o=this._hash.words;let l=o[0],r=o[1],d=o[2],u=o[3],c=o[4],f=o[5],y=o[6],b=o[7];for(let p=0;p<64;p++){if(p<16)Re[p]=a[s+p]|0;else{const E=Re[p-15],j=(E<<25|E>>>7)^(E<<14|E>>>18)^E>>>3,M=Re[p-2],V=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;Re[p]=j+Re[p-7]+V+Re[p-16]}const g=c&f^~c&y,h=l&r^l&d^r&d,w=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),k=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),B=b+k+g+yn[p]+Re[p],$=w+h;b=y,y=f,f=c,c=u+B|0,u=d,d=r,r=l,l=B+$|0}o[0]=o[0]+l|0,o[1]=o[1]+r|0,o[2]=o[2]+d|0,o[3]=o[3]+u|0,o[4]=o[4]+c|0,o[5]=o[5]+f|0,o[6]=o[6]+y|0,o[7]=o[7]+b|0}finalize(a){super.finalize(a);const s=this._nDataBytes*8,o=this._data.sigBytes*8;return this._data.words[o>>>5]|=128<<24-o%32,this._data.words[(o+64>>>9<<4)+14]=Math.floor(s/4294967296),this._data.words[(o+64>>>9<<4)+15]=s,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}}function wn(e){return new bn().finalize(e).toString(_n)}function xn(e,a={}){const s=typeof e=="string"?e:dn(e,a);return wn(s).slice(0,10)}function ze(e,a,s){const[o={},l]=typeof a=="string"?[{},a]:[a,s],r=o.key||xn([l,t(o.baseURL),typeof e=="string"?e:"",t(o.params||o.query)]);if(!r||typeof r!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+r);if(!e)throw new Error("[nuxt] [useFetch] request is missing.");const d=r===l?"$f"+r:r,u=A(()=>{let j=e;return typeof j=="function"&&(j=j()),t(j)}),{server:c,lazy:f,default:y,transform:b,pick:p,watch:g,immediate:h,...w}=o,k=ie({...w,cache:typeof o.cache=="boolean"?void 0:o.cache}),B={server:c,lazy:f,default:y,transform:b,pick:p,immediate:h,watch:[k,u,...g||[]]};let $;return rn(d,()=>{var M;return(M=$==null?void 0:$.abort)==null||M.call($),$=typeof AbortController<"u"?new AbortController:{},typeof u.value=="string"&&u.value.startsWith("/"),(o.$fetch||globalThis.$fetch)(u.value,{signal:$.signal,...k})},B)}var kn=(e,a)=>e??a;function $n(e){return["top","bottom","right","left","center"].includes(e)}var kt={show:{type:Boolean,default:!1},position:{type:String,default:"center",validator:$n},transition:{type:String},overlay:{type:Boolean,default:!0},overlayClass:{type:String},overlayStyle:{type:Object},lockScroll:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},defaultStyle:{type:Boolean,default:!0},teleport:{type:String},onOpen:ge(),onOpened:ge(),onClose:ge(),onClosed:ge(),onClickOverlay:ge(),"onUpdate:show":ge(),onRouteChange:ge()};function rt(){return rt=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},rt.apply(this,arguments)}function Cn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ht(e)}var{n:Ce,classes:lt}=yt("popup");const We=U({name:"VarPopup",inheritAttrs:!1,props:kt,setup(e,a){var{slots:s,attrs:o}=a,{zIndex:l}=en(()=>e.show,3),{disabled:r}=Lt(),d=()=>{var{closeOnClickOverlay:y,onClickOverlay:b}=e;ae(b),y&&ae(e["onUpdate:show"],!1)};tn(()=>e.show,()=>e.lockScroll),be(()=>e.show,y=>{y?ae(e.onOpen):ae(e.onClose)}),Mt(()=>ae(e.onRouteChange));var u=()=>{var{overlayClass:y="",overlayStyle:b}=e;return v("div",{class:lt(Ce("overlay"),y),style:rt({zIndex:l.value-1},b),onClick:d},null)},c=()=>v("div",bt({class:lt(Ce("content"),Ce("--"+e.position),[e.defaultStyle,Ce("--content-background-color")],[e.defaultStyle,Ce("$-elevation--3")]),style:{zIndex:l.value}},o),[ae(s.default)]),f=()=>{var{onOpened:y,onClosed:b,show:p,overlay:g,transition:h,position:w}=e;return v(mt,{name:Ce("$-fade"),onAfterEnter:y,onAfterLeave:b},{default:()=>[at(v("div",{class:lt(Ce("$--box"),Ce()),style:{zIndex:l.value-2}},[g&&u(),v(mt,{name:h||Ce("$-pop-"+w)},{default:()=>[p&&c()]})]),[[it,p]])]})};return()=>{var{teleport:y}=e;if(y){var b;return v(Vt,{to:y,disabled:r.value},Cn(b=f())?b:{default:()=>[b]})}return f()}}});We.install=function(e){e.component(We.name,We)};var oe=We;const Tn={dialogTitle:"提示",dialogConfirmButtonText:"确认",dialogCancelButtonText:"取消",actionSheetTitle:"请选择",listLoadingText:"加载中",listFinishedText:"没有更多了",listErrorText:"加载失败",pickerTitle:"请选择",pickerConfirmButtonText:"确认",pickerCancelButtonText:"取消",datePickerMonthDict:{"01":{name:"一月",abbr:"一月"},"02":{name:"二月",abbr:"二月"},"03":{name:"三月",abbr:"三月"},"04":{name:"四月",abbr:"四月"},"05":{name:"五月",abbr:"五月"},"06":{name:"六月",abbr:"六月"},"07":{name:"七月",abbr:"七月"},"08":{name:"八月",abbr:"八月"},"09":{name:"九月",abbr:"九月"},10:{name:"十月",abbr:"十月"},11:{name:"十一月",abbr:"十一月"},12:{name:"十二月",abbr:"十二月"}},datePickerWeekDict:{0:{name:"星期日",abbr:"日"},1:{name:"星期一",abbr:"一"},2:{name:"星期二",abbr:"二"},3:{name:"星期三",abbr:"三"},4:{name:"星期四",abbr:"四"},5:{name:"星期五",abbr:"五"},6:{name:"星期六",abbr:"六"}},datePickerSelected:"个被选择",paginationItem:"条",paginationPage:"页",paginationJump:"前往"};function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},ct.apply(this,arguments)}function qn(){var e={},a=q({}),s=(r,d)=>{d.lang=r,e[r]=d},o=r=>{if(!e[r])return console.warn("The "+r+" does not exist. You can mount a language package using the add method"),{};a.value=e[r]},l=(r,d)=>{if(!e[r]){console.warn("The "+r+" does not exist. You can mount a language package using the add method");return}e[r]=ct({},e[r],d),o(r)};return{packs:e,pack:a,add:s,use:o,merge:l}}var{packs:cd,pack:Bn,add:Sn,use:On,merge:ud}=qn();Sn("zh-CN",Tn);On("zh-CN");function ut(){return ut=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},ut.apply(this,arguments)}function Pn(e){return["left","center","right"].includes(e)}var In=ut({show:{type:Boolean,default:!1},width:{type:[Number,String]},title:{type:String},message:{type:String},messageAlign:{type:String,default:"left",validator:Pn},confirmButton:{type:Boolean,default:!0},cancelButton:{type:Boolean,default:!0},confirmButtonText:{type:String},cancelButtonText:{type:String},confirmButtonTextColor:{type:String},cancelButtonTextColor:{type:String},confirmButtonColor:{type:String},cancelButtonColor:{type:String},dialogClass:{type:String},dialogStyle:{type:Object},onBeforeClose:ge(),onConfirm:ge(),onCancel:ge(),"onUpdate:show":ge()},Ft(kt,["overlay","overlayClass","overlayStyle","lockScroll","closeOnClickOverlay","teleport","onOpen","onClose","onOpened","onClosed","onClickOverlay","onRouteChange"]));function dt(){return dt=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},dt.apply(this,arguments)}var{n:En,classes:An}=yt("dialog");function Un(e,a){var s=ht("var-button"),o=ht("var-popup");return i(),I(o,{class:G(e.n("popup")),"var-dialog-cover":"",show:e.popupShow,overlay:e.overlay,"overlay-class":e.overlayClass,"overlay-style":e.overlayStyle,"lock-scroll":e.lockScroll,"close-on-click-overlay":e.popupCloseOnClickOverlay,teleport:e.teleport,onOpen:e.onOpen,onClose:e.onClose,onClosed:e.onClosed,onOpened:e.onOpened,onRouteChange:e.onRouteChange,onClickOverlay:e.handleClickOverlay},{default:x(()=>[n("div",bt({class:e.classes(e.n("$--box"),e.n(),e.dialogClass),style:dt({width:e.toSizeUnit(e.width)},e.dialogStyle)},e.$attrs),[n("div",{class:G(e.n("title"))},[we(e.$slots,"title",{},()=>[T(_(e.dt(e.title,e.pack.dialogTitle)),1)])],2),n("div",{class:G(e.n("message")),style:K({textAlign:e.messageAlign})},[we(e.$slots,"default",{},()=>[T(_(e.message),1)])],6),n("div",{class:G(e.n("actions"))},[e.cancelButton?(i(),I(s,{key:0,class:G(e.classes(e.n("button"),e.n("cancel-button"))),"var-dialog-cover":"",text:"","text-color":e.cancelButtonTextColor,color:e.cancelButtonColor,onClick:e.cancel},{default:x(()=>[T(_(e.dt(e.cancelButtonText,e.pack.dialogCancelButtonText)),1)]),_:1},8,["class","text-color","color","onClick"])):S("v-if",!0),e.confirmButton?(i(),I(s,{key:1,class:G(e.classes(e.n("button"),e.n("confirm-button"))),"var-dialog-cover":"",text:"","text-color":e.confirmButtonTextColor,color:e.confirmButtonColor,onClick:e.confirm},{default:x(()=>[T(_(e.dt(e.confirmButtonText,e.pack.dialogConfirmButtonText)),1)]),_:1},8,["class","text-color","color","onClick"])):S("v-if",!0)],2)],16)]),_:3},8,["class","show","overlay","overlay-class","overlay-style","lock-scroll","close-on-click-overlay","teleport","onOpen","onClose","onClosed","onOpened","onRouteChange","onClickOverlay"])}var $t=U({name:"VarDialog",components:{VarPopup:We,VarButton:on},inheritAttrs:!1,props:In,setup(e){var a=q(!1),s=q(!1),o=()=>ae(e["onUpdate:show"],!1),l=()=>{var{closeOnClickOverlay:u,onClickOverlay:c,onBeforeClose:f}=e;if(ae(c),!!u){if(f!=null){f("close",o);return}ae(e["onUpdate:show"],!1)}},r=()=>{var{onBeforeClose:u,onConfirm:c}=e;if(ae(c),u!=null){u("confirm",o);return}ae(e["onUpdate:show"],!1)},d=()=>{var{onBeforeClose:u,onCancel:c}=e;if(ae(c),u!=null){u("cancel",o);return}ae(e["onUpdate:show"],!1)};return be(()=>e.show,u=>{a.value=u},{immediate:!0}),be(()=>e.closeOnClickOverlay,u=>{if(e.onBeforeClose!=null){s.value=!1;return}s.value=u},{immediate:!0}),{n:En,classes:An,pack:Bn,dt:kn,popupShow:a,popupCloseOnClickOverlay:s,handleClickOverlay:l,confirm:r,cancel:d,toSizeUnit:Gt}}});$t.render=Un;const De=$t;function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Je.apply(this,arguments)}var Ee,Xe={};function zn(e){return e===void 0&&(e={}),Yt(e)?Je({},Xe,{message:e}):Je({},Xe,e)}function qe(e){return Kt()?new Promise(a=>{qe.close();var s=zn(e),o=ie(s);o.teleport="body",Ee=o;var{unmountInstance:l}=Wt(De,o,{onConfirm:()=>{ae(o.onConfirm),a("confirm")},onCancel:()=>{ae(o.onCancel),a("cancel")},onClose:()=>{ae(o.onClose),a("close")},onClosed:()=>{ae(o.onClosed),l(),Ee===o&&(Ee=null)},onRouteChange:()=>{l(),Ee===o&&(Ee=null)},"onUpdate:show":r=>{o.show=r}});o.show=!0}):Promise.resolve()}function jn(e){Xe=e}function Rn(){Xe={}}function Nn(){if(Ee!=null){var e=Ee;Ee=null,Qt().then(()=>{e.show=!1})}}Object.assign(qe,{setDefaultOptions:jn,resetDefaultOptions:Rn,close:Nn});De.install=function(e){e.component(De.name,De)};qe.install=function(e){e.component(De.name,De)};qe.Component=De;const Dn={1:"Tiên Tộc",2:"Yêu Tộc",3:"Ma Tộc",4:"Nhân Tộc"},Ct={exp:"Tu Vi",gold:"Tiền Tiên",knb:"Tiên Duyên",bag:"Quỹ Boss",kill:"Tiêu Diệt",top:"ST Cao Nhất",scoreTienDau:"Xu Tiên Đấu"},Tt={exp:1,gold:2,knb:3,bag:5,kill:3,top:5,scoreTienDau:3};var Ln=(e=>(e.knb="Tiên Duyên",e.gold="Tiền Tiên",e.coin="Tiên Ngọc",e.scoreTienDau="Điểm Tiên Đấu",e))(Ln||{});const Be={1:"Vũ Khí",2:"Trang Phục",3:"Khôi",4:"Nhẫn",5:"Ngọc Bội",6:"Hộ Uyển",7:"Thủ Ngoạ",8:"Đai"},Ae={1:"Nhất Phẩm",2:"Nhị Phẩm",3:"Tam Phẩm",4:"Tứ Phẩm",5:"Ngũ Phẩm",6:"Thất Phẩm",7:"Lục Phẩm",8:"Bát Phẩm",9:"Cửu Phẩm"},Mn={speed:"Tốc độ",damage:"Công kích",hp:"Sinh lực",mp:"Năng lượng",def:"Phòng thủ",critical:"Bạo kích",bloodsucking:"Hút sinh lực",criticalDamage:"Sát thương bạo kích",avoid:"Phản đòn",reductionAvoid:"",reductionCriticalDamage:"",reductionBloodsucking:"",counterAttack:"",recoveryPerformance:"",reductionRecoveryPerformance:"",reductionCounterAttack:""},Vn=He(()=>Fe(()=>import("./index.f6f0845b.js"),["./index.f6f0845b.js","./entry.303ba4a8.js","./entry.aa262684.css","./index.040b5bdf.js","./useBattleRound.ae7aabef.js","./usePlayer.4eda164d.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./Line.938dcc9e.js","./_plugin-vue_export-helper.c27b6911.js","./useMessage.4ef409fc.js","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css"],import.meta.url).then(e=>e.default||e)),Hn=He(()=>Fe(()=>import("./index.13f6d1d1.js"),["./index.13f6d1d1.js","./entry.303ba4a8.js","./entry.aa262684.css","./index.040b5bdf.js","./useBattleRound.ae7aabef.js","./usePlayer.4eda164d.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./Line.938dcc9e.js","./_plugin-vue_export-helper.c27b6911.js","./useMessage.4ef409fc.js","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css"],import.meta.url).then(e=>e.default||e)),Fn=He(()=>Fe(()=>import("./index.4494a7d2.js"),["./index.4494a7d2.js","./entry.303ba4a8.js","./entry.aa262684.css","./index.040b5bdf.js","./useBattleRound.ae7aabef.js","./usePlayer.4eda164d.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./Line.938dcc9e.js","./_plugin-vue_export-helper.c27b6911.js","./useMessage.4ef409fc.js","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css"],import.meta.url).then(e=>e.default||e)),Gn={class:"p-2"},Kn=["onClick"],Wn={class:"h-[calc(100%_-_47px)] overflow-scroll"},qt={__name:"index",emits:["close"],setup(e,{emit:a}){const s=q("daily"),o=[{key:"daily",name:"Hằng ngày"},{key:"elite",name:"Dã ngoại"},{key:"frameTime",name:"Thế giới"}];return(l,r)=>{const d=Vn,u=Hn,c=Fn;return i(),m(C,null,[n("div",Gn,[(i(),m(C,null,R(o,f=>n("button",{key:f.key,class:G({"!opacity-100":t(s)===f.key}),transition:"~ opacity duration-800",m:"x-2",w:"16",h:"8",font:"italic bold leading-3",opacity:"40",border:"rounded 1 white/40",text:"primary",onClick:y=>s.value=f.key},_(f.name),11,Kn)),64))]),n("div",Wn,[t(s)==="elite"?(i(),I(d,{key:0})):S("",!0),t(s)==="daily"?(i(),I(u,{key:1})):S("",!0),t(s)==="frameTime"?(i(),I(c,{key:2})):S("",!0)])],64)}}},Yn=n("div",{class:"w-80 p-4 border-box"},[T(" Lên 1 level sẽ được thêm 2 điểm thuộc tính "),n("p",{class:"flex flex-col"},[n("span",null," 1 Sức mạnh "),n("span",{class:"pl-3"}," 30 Sinh lực "),n("span",{class:"pl-3"}," 0.2% Tấn công cơ bản ")]),n("p",{class:"border-t my-2"}),n("p",{class:"flex flex-col"},[n("span",null," 1 Nhanh nhẹn "),n("span",{class:"pl-3"}," 1 Tốc độ "),n("span",{class:"pl-3"}," 0.2% Bạo kích cơ bản ")]),n("p",{class:"border-t my-2"}),n("p",{class:"flex flex-col"},[n("span",null," 1 Sức khoẻ "),n("span",{class:"pl-3"}," 20 Sinh lực "),n("span",{class:"pl-3"}," 0.2% Sinh lực cơ bản "),n("span",{class:"pl-3"}," 0.2% Phòng thủ cơ bản ")]),n("p",{class:"border-t my-2"}),n("p",{class:"flex flex-col"},[n("span",null," 1 Khéo léo "),n("span",{class:"pl-3"}," 0.5 Tốc độ "),n("span",{class:"pl-3"}," 10 Phòng ngự "),n("span",{class:"pl-3"}," 0.2% Bạo kích cơ bản ")])],-1),Qn={class:"text-10"},Jn={class:"flex items-start justify-between gap-4 p-4"},Xn={class:"flex justify-between items-start gap-3"},Zn={class:"w-4"},eo={class:"text-yellow-500"},to=n("svg",{class:"w-[20px]","aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","data-fa-i2svg":""},[n("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"})],-1),no=[to],oo={class:"flex justify-between items-start gap-3"},so={class:"w-4"},lo={class:"text-green-500"},ao=n("svg",{class:"w-[20px]","aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","data-fa-i2svg":""},[n("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"})],-1),io=[ao],ro={class:"flex justify-between items-start gap-3"},co={class:"w-4"},uo={class:"text-red-500"},po=n("svg",{class:"w-[20px]","aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","data-fa-i2svg":""},[n("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"})],-1),_o=[po],mo={class:"flex justify-between items-start gap-3"},ho={class:"w-4"},fo={class:"text-[#a855f7]"},go=n("svg",{class:"w-[20px]","aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","data-fa-i2svg":""},[n("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"})],-1),vo=[go],yo=n("div",{class:"text-10"}," Thuộc tính cơ bản ",-1),bo={class:"pl-4"},wo={class:"flex justify-between items-start gap-4"},xo={class:"whitespace-normal"},ko={class:"whitespace-normal"},$o={class:"whitespace-normal"},Co={class:"whitespace-normal"},To={class:"whitespace-normal"},qo={class:"whitespace-normal"},Bo={class:"whitespace-normal"},So=n("div",{class:"text-10"}," Thuộc tính cấp 2 ",-1),Oo={class:"flex flex-col gap-4"},Po={class:"flex"},Io={class:"whitespace-normal"},Eo={class:"whitespace-normal"},Ao={class:"whitespace-normal"},Uo={class:"whitespace-normal"},zo={class:"flex"},jo={class:"whitespace-normal"},Ro={class:"whitespace-normal"},No={class:"whitespace-normal"},Do={class:"whitespace-normal"},Lo=n("div",{class:"text-10"}," Thuộc tính cấp 3 ",-1),Mo=n("div",{class:"text-center"}," Chưa được mở khoá ",-1),Vo=n("button",{class:"mx-2 h-6 w-6 shadow rounded-full text-8 italic font-semibold border-full-box bg-button-menu"}," Tips ",-1),Ho=[Vo],Fo=U({__name:"AttributeTab",setup(e){const{playerInfo:a,attribute:s}=se(Y()),{loadPlayer:o}=Y(),l=q(!1),r=async d=>{try{const u=await $fetch("/api/attribute/add",{method:"POST",body:{target:d}});N(u.statusMessage),u.player&&o(u.player)}catch(u){N(u.statusMessage)}};return(d,u)=>{var y,b,p,g,h,w,k,B,$,E,j,M,V,O,X,Q,L,H,W,D,ee,ue,de;const c=oe,f=_e;return i(),m(C,null,[v(c,{show:t(l),"onUpdate:show":u[0]||(u[0]=te=>Z(l)?l.value=te:null),position:"center"},{default:x(()=>[Yn]),_:1},8,["show"]),v(f,{class:"py-2"},{default:x(()=>{var te;return[n("div",Qn," Điểm thuộc tính "+_(((te=t(a))==null?void 0:te.ofAttribute)??0),1)]}),_:1}),n("div",Jn,[n("div",Xn,[n("div",Zn,[T(" Sức mạnh "),n("strong",eo,_(((b=(y=t(a))==null?void 0:y.coreAttribute)==null?void 0:b.ofPower)??0),1)]),n("button",{class:"ml-2",onClick:u[1]||(u[1]=te=>r("ofPower"))},no)]),n("div",oo,[n("div",so,[T(" Nhanh nhẹn "),n("strong",lo,_(((g=(p=t(a))==null?void 0:p.coreAttribute)==null?void 0:g.ofAgility)??0),1)]),n("button",{class:"ml-2",onClick:u[2]||(u[2]=te=>r("ofAgility"))},io)]),n("div",ro,[n("div",co,[T(" Sức khoẻ "),n("strong",uo,_(((w=(h=t(a))==null?void 0:h.coreAttribute)==null?void 0:w.ofVitality)??0),1)]),n("button",{class:"ml-2",onClick:u[3]||(u[3]=te=>r("ofVitality"))},_o)]),n("div",mo,[n("div",ho,[T(" Khéo léo "),n("strong",fo,_(((B=(k=t(a))==null?void 0:k.coreAttribute)==null?void 0:B.ofSkillful)??0),1)]),n("button",{class:"ml-2",onClick:u[4]||(u[4]=te=>r("ofSkillful"))},vo)])]),v(f,{class:"py-2 pt-4"},{default:x(()=>[yo]),_:1}),n("div",bo,[n("div",wo,[n("div",xo," Tốc độ "+_((($=t(s))==null?void 0:$.speed)??0),1),n("div",ko," Sinh lực "+_(((E=t(s))==null?void 0:E.hp)??0),1),n("div",$o," Công Kích "+_(((j=t(s))==null?void 0:j.damage)??0),1),n("div",Co," Phòng Ngự "+_(((M=t(s))==null?void 0:M.def)??0),1),n("div",To," Bạo kích "+_(((V=t(s))==null?void 0:V.critical)??0)+"% ",1),n("div",qo," Sát thương bạo kích "+_(((O=t(s))==null?void 0:O.criticalDamage)??0)+"% ",1),n("div",Bo," Miễn sát thương bạo kích "+_(((X=t(s))==null?void 0:X.reductionCriticalDamage)??0)+"% ",1)]),v(f,{class:"py-2 pt-4"},{default:x(()=>[So]),_:1}),n("div",Oo,[n("div",Po,[n("div",Io," Hút sinh lực "+_(((Q=t(s))==null?void 0:Q.bloodsucking)??0)+"% ",1),n("div",Eo," Kháng hút sinh lực "+_(((L=t(s))==null?void 0:L.reductionBloodsucking)??0)+"% ",1),n("div",Ao," Né tránh "+_(((H=t(s))==null?void 0:H.avoid)??0)+"% ",1),n("div",Uo," Bỏ qua né tránh "+_(((W=t(s))==null?void 0:W.reductionAvoid)??0)+"% ",1)]),n("div",zo,[n("div",jo," Phản sát thương "+_(((D=t(s))==null?void 0:D.counterAttack)??0)+"% ",1),n("div",Ro," Bỏ qua phản sát thương "+_(((ee=t(s))==null?void 0:ee.reductionCounterAttack)??0)+"% ",1),n("div",No," Hiệu xuất hồi phục "+_(((ue=t(s))==null?void 0:ue.recoveryPerformance)??0)+"% ",1),n("div",Do," Bỏ qua hồi phục "+_(((de=t(s))==null?void 0:de.reductionRecoveryPerformance)??0)+"% ",1)])]),v(f,{class:"py-2 pt-4"},{default:x(()=>[Lo]),_:1}),Mo,n("p",{class:"absolute bottom-2 right-0",onClick:u[5]||(u[5]=te=>l.value=!0)},Ho)])],64)}}}),Go={text:"12"},Ko=U({__name:"Name",props:{quality:null,enhance:null,name:null},setup(e){const a=e,s=A(()=>Ae[a.quality]);return(o,l)=>(i(),m("div",{style:K({color:t(J)(e.quality)})},[T(_(t(s))+" - "+_(e.name)+" ",1),n("span",Go,_(e.enhance),1)],4))}}),Wo={m:"x-2",font:"semibold",text:"left"},Yo={flex:"~ "},Qo={text:"10"},Jo={text:"10"},Xo=U({__name:"BaseInfo",props:{name:null,quality:null,enhance:null,star:null,slotNum:null,rank:null},setup(e){return(a,s)=>{const o=Ko,l=Le;return i(),m("div",Wo,[v(o,{quality:e.quality,ehance:e.enhance,name:e.name},null,8,["quality","ehance","name"]),n("div",Yo,[(i(!0),m(C,null,R(e.star,r=>(i(),I(l,{key:r,name:"material-symbols:star",size:"18"}))),128))]),n("p",Qo,_(t(Be)[e.slotNum]),1),n("p",Jo," Bậc "+_(e.rank),1)])}}}),Zo=n("div",{text:"space-nowrap"}," Thuộc tính cơ bản ",-1),es={m:"x-2",w:"full",text:"10"},ts={key:0,flex:"~ ",justify:"between"},ns={key:0,text:"green-300",p:"x-2"},os={key:0,text:"yellow-300"},ss=U({__name:"AttributeInfo",props:{stats:null},setup(e){return(a,s)=>{const o=_e;return i(),m(C,null,[v(o,{m:"y-1"},{default:x(()=>[Zo]),_:1}),n("div",es,[(i(!0),m(C,null,R(e.stats,(l,r)=>(i(),m("div",{key:r},[(i(!0),m(C,null,R(l,(d,u)=>(i(),m("div",{key:u},[d.main>0&&d?(i(),m("div",ts,[n("span",null,_(t(Mn)[u])+": "+_(Math.round(d.main+(d.enhance??0)+(d.star??0))),1),d.enhance?(i(),m("span",ns,[T(" (Cường hoá + "+_(Math.round(d.enhance))+") ",1),d.star>0?(i(),m("span",os," ("+_(Math.round(d.star))+") ",1)):S("",!0)])):S("",!0)])):S("",!0)]))),128))]))),128))])],64)}}}),Bt=U({__name:"Values",props:{gem:null},setup(e){const a=e,s=o=>a.gem.quality>1?o.type==="percent"?`${o.name} ${Math.round(o.value*(a.gem.quality*a.gem.rateOnLevel))}%`:`${o.name} ${Math.round(o.value*(a.gem.quality*a.gem.rateOnLevel))}`:o.type==="percent"?`${o.name} ${o.value}%`:`${o.name} ${o.value}`;return(o,l)=>(i(!0),m(C,null,R(e.gem.values,(r,d)=>(i(),m("div",{key:d,style:K({color:t(J)(e.gem.quality)})},[n("span",null,_(s(r)),1)],4))),128))}}),ls={class:"flex items-center relative w-full"},as={class:"absolute bg-[#00000040] text-8 font-bold text-white bottom-0 right-0 px-1 rounded-2xl text-yellow-300"},is={class:"w-[65%]"},rs={class:"flex flex-col text-8 leading-4 ml-1"},St=U({__name:"Item",props:{gem:null,bgClass:null},setup(e){return(a,s)=>{const o=xe,l=Bt;return i(),m("div",ls,[n("div",{class:G([e.bgClass,"w-12 h-12 relative"])},[v(o,{class:"absolute top-0",format:"webp",src:`/quality_bg/iconbg_${e.gem.quality}.png`},null,8,["src"]),v(o,{class:"absolute transform-center w-[80%] h-[80%] rounded-full object-cover",format:"webp",src:`/gem/${e.gem.gemId}.png`},null,8,["src"]),n("div",as,_(e.gem.sum),1)],2),n("div",is,[n("span",{class:"ml-1 text-white text-10 line-clamp-1",style:K({color:t(J)(e.gem.quality)})},_(e.gem.name),5),n("div",rs,[v(l,{gem:e.gem},null,8,["gem"])])]),we(a.$slots,"default")])}}}),cs=n("div",{text:"space-nowrap"}," Đá hồn ",-1),us={key:0,m:"x-2",overflow:"auto",w:"full","max-h":"[250px]"},ds=n("span",{m:"l-2",text:"10"}," (Chưa khảm) ",-1),ps=U({__name:"GemInfo",props:{gems:null,gemSlot:null},setup(e){const a=e,s=A(()=>a.gems?a.gemSlot-a.gems.length:a.gemSlot);return(o,l)=>{var c;const r=_e,d=St,u=xe;return i(),m(C,null,[v(r,{m:"y-2"},{default:x(()=>[cs]),_:1}),((c=e.gems)==null?void 0:c.length)>0?(i(),m("div",us,[(i(!0),m(C,null,R(e.gems,(f,y)=>(i(),m("div",{key:y,flex:"~ ",align:"items-center",p:"1 x-1",m:"b-1",pos:"relative",bg:"[#00000040]","max-w":"[60%]",border:"rounded"},[v(d,{gem:f},null,8,["gem"])]))),128)),t(s)>0?(i(!0),m(C,{key:0},R(t(s),f=>(i(),m("div",{key:f,flex:"~ ",align:"items-center",m:"b-2"},[v(u,{src:"/gem/default.png",format:"webp",w:"12",h:"12",bg:"[#000000]"}),ds]))),128)):S("",!0)])):S("",!0)],64)}}}),_s={class:"p-4"},ms={text:"center",p:"y-4"},hs={pos:"relative",text:"white",bg:"primary",font:"leading-[23px]",p:"0",w:"[85vw]",m:"auto",overflow:"hidden",class:"border-box"},fs={text:"12",font:"medium"},gs={flex:"~ ",align:"items-center",justify:"between",p:"2 b-0"},vs={flex:"~ col",align:"items-start",justify:"start",p:"2"},ys={key:0,flex:"~ ",justify:"center"},bs={border:"t white/40",p:"y-2",m:"auto t-2",text:"12",class:"w-[75%]"},ws={text:"center 10"},je=U({__name:"index",props:{equipment:null,action:{type:Boolean},sellAction:{type:Boolean}},emits:["close","changeEquip","refresh"],setup(e,{emit:a}){const s=e,{fetchPlayer:o}=Y(),l=q(!1),r=q(s.equipment),d=q(!1),u=q({price:0,quantity:0}),c=A(()=>Ge(s.equipment.level,s.equipment.level+1)),f=async()=>{const p=s.equipment._id;l.value=!0,await $fetch("/api/player/equip",{headers:ft(),method:"POST",body:{_equipId:p,action:"equip"}}),l.value=!1,r.value.used=!0,a("changeEquip"),o()},y=async()=>{const p=s.equipment._id;l.value=!0,await $fetch("/api/player/equip",{headers:ft(),method:"POST",body:{_equipId:p,action:"unequip"}}),r.value.used=!1,l.value=!1,a("changeEquip"),o()},b=async()=>{try{const p=await $fetch("/api/market/sell",{method:"POST",body:{type:"equipment",quantity:1,price:u.value.price,_id:s.equipment._id}});p.success&&(a("refresh"),N(p.message))}catch(p){N(p.statusMessage)}};return(p,g)=>{const h=et,w=Oe,k=oe,B=Xo,$=ss,E=ps;return i(),m(C,null,[v(k,{show:t(d),"onUpdate:show":g[1]||(g[1]=j=>Z(d)?d.value=j:null),position:"bottom"},{default:x(()=>[n("div",_s,[v(h,{modelValue:t(u).price,"onUpdate:modelValue":g[0]||(g[0]=j=>t(u).price=j),placeholder:"Nhập giá bán"},null,8,["modelValue"])]),n("div",ms,[v(w,{class:"!text-[#333] mx-2",size:"small",onClick:z(b,["stop"])},{default:x(()=>[T(" Treo bán ")]),_:1},8,["onClick"])])]),_:1},8,["show"]),n("div",hs,[n("div",fs,[n("div",gs,[v(B,{"slot-num":e.equipment.slot,name:e.equipment.name,quality:e.equipment.quality,enhance:e.equipment.enhance,star:e.equipment.star,rank:e.equipment.rank},null,8,["slot-num","name","quality","enhance","star","rank"])]),n("div",vs,[v($,{stats:e.equipment.stats},null,8,["stats"]),v(E,{gems:e.equipment.gems,"gem-slot":e.equipment.gemSlot},null,8,["gems","gem-slot"])])]),e.action?(i(),m("div",ys,[n("div",null,[e.sellAction?(i(),I(w,{key:0,class:"!text-[#333] mx-2",size:"mini",onClick:g[2]||(g[2]=z(j=>d.value=!0,["stop"]))},{default:x(()=>[T(" Treo bán ")]),_:1})):S("",!0),t(r).used?(i(),I(w,{key:2,size:"mini",class:"!text-[#333]",onClick:z(y,["stop"])},{default:x(()=>[T(" Tháo trang bị ")]),_:1},8,["onClick"])):(i(),I(w,{key:1,type:"warning",class:"!text-[#333]",size:"mini",onClick:z(f,["stop"])},{default:x(()=>[T(" Trang bị ")]),_:1},8,["onClick"]))])])):S("",!0),n("div",bs,[n("div",ws," Cấp độ sử dụng: "+_(t(c).levelTitle)+" "+_(t(c).floor),1)])])],64)}}}),xs=["onClick"],ks={text:"10",font:"bold italic"},$s={key:1,class:"diamond",h:"12",w:"20"},Cs={text:"10",font:"bold italic"},Ts=n("span",{text:"8 space-nowrap"}," (Trống) ",-1),qs=["onClick"],Bs={text:"10",font:"bold italic"},Ss={key:1,class:"diamond",h:"12",w:"20"},Os={text:"10",font:"bold italic"},Ps=n("span",{text:"8 space-nowrap"}," (Trống) ",-1),Ot=U({__name:"EquipmentDefault",props:{leftSlots:null,rightSlots:null,wClass:null},setup(e){const a=ie({equipSelected:{},equipDetail:!1}),s=o=>{a.equipSelected=o,a.equipDetail=!0};return(o,l)=>{const r=je,d=oe;return i(),m(C,null,[v(d,{show:t(a).equipDetail,"onUpdate:show":l[0]||(l[0]=u=>t(a).equipDetail=u),position:"center"},{default:x(()=>[v(r,{equipment:t(a).equipSelected,action:!0},null,8,["equipment"])]),_:1},8,["show"]),n("div",{class:G(e.wClass),gap:"4",grid:"~ cols-4",p:"3",text:"center"},[(i(!0),m(C,null,R(e.leftSlots,u=>{var c,f,y;return i(),m("div",{key:u.no},[u.slot?(i(),m("button",{key:0,class:"diamond",w:"20",h:"12",style:K({border:`1px solid ${t(J)((c=u.slot)==null?void 0:c.quality)}`}),onClick:z(b=>s(u.slot),["stop"])},[n("span",ks,_((f=u.slot)==null?void 0:f.name)+"(+"+_((y=u.slot)==null?void 0:y.enhance)+") ",1)],12,xs)):(i(),m("button",$s,[n("span",Cs,[T(_(t(Be)[u.no])+" ",1),Ts])]))])}),128)),(i(!0),m(C,null,R(e.rightSlots,u=>{var c,f,y;return i(),m("div",{key:u.no},[u.slot?(i(),m("button",{key:0,class:"diamond",h:"12",w:"20",style:K({border:`1px solid ${t(J)((c=u.slot)==null?void 0:c.quality)}`}),onClick:z(b=>s(u.slot),["stop"])},[n("span",Bs,_((f=u.slot)==null?void 0:f.name)+"(+"+_((y=u.slot)==null?void 0:y.enhance)+") ",1)],12,qs)):(i(),m("button",Ss,[n("span",Os,[T(_(t(Be)[u.no])+" ",1),Ps])]))])}),128))],2)],64)}}}),Is=n("div",{text:"10"}," Nhân vật ",-1),Es={justify:"between",flex:"~ ",align:"items-start",m:"x-4"},As={text:"space-normal",w:"5"},Us={text:"space-normal",w:"5"},zs={text:"space-normal",w:"5"},js={text:"space-normal",w:"5"},Rs={text:"space-normal",w:"5"},Ns={key:0,text:"space-normal",w:"5"},Ds={key:1,text:"space-normal",w:"5"},Ls=n("div",{text:"10"}," Trang bị ",-1),Pt=U({__name:"EquipTab",props:{name:null,level:null,classRole:null,levelTitle:null,floor:null,exp:null,knb:null,gold:null,rightSlots:null,leftSlots:null},setup(e){const a=e;Y();const s=A(()=>Dn[a.classRole]);return(o,l)=>{const r=_e,d=Ot;return i(),m(C,null,[v(r,{p:"y-2"},{default:x(()=>[Is]),_:1}),n("div",Es,[n("div",As," Tên "+_(e.name),1),n("div",Us," Cảnh giới "+_(e.levelTitle)+" "+_(e.floor),1),n("div",zs," Đẳng cấp "+_(e.level),1),n("div",js,[T(" Hệ "),n("span",null,_(t(s)),1)]),n("div",Rs," Tu vị "+_(t(me)(e.exp)),1),e.knb?(i(),m("div",Ns," Tiên duyên "+_(Math.round(e.knb)??0),1)):S("",!0),e.gold?(i(),m("div",Ds," Tiền tiên "+_(t(me)(e.gold)),1)):S("",!0)]),v(r,{p:"y-2 t-4"},{default:x(()=>[Ls]),_:1}),v(d,{"left-slots":e.leftSlots,"right-slots":e.rightSlots,"w-class":"!grid-cols-3"},null,8,["left-slots","right-slots"])],64)}}}),Ye=Jt("playerSlot",()=>{const{equipments:e}=se(Y()),a=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===1)}),s=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===2)}),o=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===3)}),l=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===4)}),r=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===5)}),d=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===6)}),u=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===7)}),c=A(()=>{var p;return(p=e.value)==null?void 0:p.find(g=>g.slot===8)}),f=A(()=>[{no:1,slot:a.value},{no:2,slot:s.value},{no:3,slot:o.value},{no:4,slot:l.value}]),y=A(()=>[{no:5,slot:r.value},{no:6,slot:d.value},{no:7,slot:u.value},{no:8,slot:c.value}]);return{slot1:a,slot2:s,slot3:o,slot4:l,slot5:r,slot6:d,slot7:u,slot8:c,leftSlots:f,rightSlots:y,getSlotEquipUpgrade:p=>e.value.find(g=>g.slot===p)}}),Ms={class:"bg-primary border-box w-full h-[80%] w-[calc(100vw_-_30px)] h-120 relative overflow-hidden"},Vs={class:"h-full absolute top-0 w-full"},Hs={class:"m-1 rounded-md text-10 font-semibold h-[calc(100%_-_60px)]"},Fs={class:"flex-center w-full absolute bottom-4"},Gs=["onClick"],Ks={__name:"Infomation",setup(e){const{leftSlots:a,rightSlots:s}=se(Ye()),{playerInfo:o}=se(Y()),l=q("attribute"),r=q([{key:"equipment",name:"Trang Bị"},{key:"attribute",name:"Thuộc Tính"}]);return(d,u)=>{const c=Fo,f=Pt;return i(),m("div",Ms,[n("div",Vs,[n("div",Hs,[t(l)==="attribute"?(i(),I(c,{key:0})):S("",!0),t(l)==="equipment"?(i(),I(f,{key:1,name:t(o).name,level:t(o).level,"level-title":t(o).levelTitle,floor:t(o).floor,"class-role":t(o).class,exp:t(o).exp,knb:t(o).knb,gold:t(o).gold,"left-slots":t(a),"right-slots":t(s)},null,8,["name","level","level-title","floor","class-role","exp","knb","gold","left-slots","right-slots"])):S("",!0)]),n("div",Fs,[(i(!0),m(C,null,R(t(r),y=>(i(),m("button",{key:y.key,class:G(["transition text-12 px-2 opacity-40 duration-800 transition-opacity mx-2 h-8 leading-3 italic shadow rounded font-bold border-1 text-primary border-white/40",{"!opacity-100":t(l)===y.key}]),onClick:b=>l.value=y.key},_(y.name),11,Gs))),128))])])])}}},Ws={class:"flex-center max-w-[60vh] w-[95vw] h-[70vh] bg-[#191b1e]"},Ys={class:"w-full h-full relative border border-white/40"},Qs={class:"font-bold absolute left-[calc(50%_-_50px)] top-[4px] text-white text-12 w-25 flex justify-center"},Js=n("div",{class:"absolute top-[30px] flex flex-col gap-1 items-center justify-center w-full"},null,-1),Xs={class:"flex justify-around items-center w-full absolute top-10"},Zs={class:"flex flex-col pl-2 gap-2"},el=["onClick"],tl={class:"text-10 font-bold italic"},nl={key:1,class:"diamond w-20 h-13"},ol={class:"text-10 font-bold italic"},sl=n("span",{class:"text-8"}," (Trống) ",-1),ll={class:"text-10 italic font-bold"},al={class:"flex flex-col pr-2 gap-2"},il=["onClick"],rl={class:"text-10 font-bold italic"},cl={key:1,class:"diamond w-20 h-13"},ul={class:"text-10 font-bold italic"},dl=n("span",{class:"text-8"}," (Trống) ",-1),pt=U({__name:"Item",emits:["onselected"],setup(e,{emit:a}){const{leftSlots:s,rightSlots:o}=se(Ye()),l=ie({equipSelected:{},equipDetail:!1}),r=d=>{l.equipSelected=d};return be(l,d=>{a("onselected",d.equipSelected)}),(d,u)=>{var y,b;const c=je,f=oe;return i(),m(C,null,[v(f,{show:t(l).equipDetail,"onUpdate:show":u[0]||(u[0]=p=>t(l).equipDetail=p),position:"center"},{default:x(()=>[v(c,{equipment:t(l).equipSelected,action:!1},null,8,["equipment"])]),_:1},8,["show"]),n("div",Ws,[n("div",Ys,[n("span",Qs,[we(d.$slots,"title")]),Js,n("div",Xs,[n("div",Zs,[(i(!0),m(C,null,R(t(s),p=>{var g,h,w,k;return i(),m("div",{key:p.no},[p.slot?(i(),m("button",{key:0,class:G(["diamond w-20 h-13",{"border border-green-500":p.slot&&((g=p.slot)==null?void 0:g._id)===((h=t(l).equipSelected)==null?void 0:h._id)}]),onClick:z(B=>r(p.slot),["stop"])},[n("span",tl,_((w=p.slot)==null?void 0:w.name)+"(+"+_((k=p.slot)==null?void 0:k.enhance)+") ",1)],10,el)):(i(),m("button",nl,[n("span",ol,[T(_(t(Be)[p.no])+" ",1),sl])]))])}),128))]),n("div",{class:"w-20 h-13 rounded",onClick:u[1]||(u[1]=p=>t(l).equipDetail=!0)},[n("button",{class:"diamond w-20 h-13",style:K({border:`1px solid ${t(J)(t(l).equipSelected.quality)}`})},[n("span",ll,_((y=t(l).equipSelected)==null?void 0:y.name)+"(+"+_((b=t(l).equipSelected)==null?void 0:b.enhance)+") ",1)],4)]),n("div",al,[(i(!0),m(C,null,R(t(o),p=>{var g,h,w,k;return i(),m("div",{key:p.no},[p.slot?(i(),m("button",{key:0,class:G(["diamond w-20 h-13",{"border border-green-500":p.slot&&((g=p.slot)==null?void 0:g._id)===((h=t(l).equipSelected)==null?void 0:h._id)}]),onClick:z(B=>r(p.slot),["stop"])},[n("span",rl,_((w=p.slot)==null?void 0:w.name)+"(+"+_((k=p.slot)==null?void 0:k.enhance)+") ",1)],10,il)):(i(),m("button",cl,[n("span",ul,[T(_(t(Be)[p.no])+" ",1),dl])]))])}),128))])])])])],64)}}}),pl=""+new URL("btn_click.fbbc422c.mp3",import.meta.url).href,_l=""+new URL("76180931-42ba-4a4f-a837-940988b10b49.74934e13.mp3",import.meta.url).href,ml=""+new URL("reward.7ee45cc1.mp3",import.meta.url).href;new Audio(_l);const It=async()=>{try{await new Audio(ml).play()}catch(e){console.warn(e)}},fe=async()=>{await new Audio(pl).play()},hl=n("div",{class:"w-60 p-4 bg-white text-12"},[n("p",null,"Mỗi cấp sẽ tăng 3% hiệu quả thuộc tính trang bị"),n("br"),n("p",null,"Thất bại sẽ giảm 1 cấp cường hóa.")],-1),fl=n("div",{class:"whitespace-nowrap"}," Cường hoá ",-1),gl={key:0,class:"absolute bottom-0 w-full duration-500 text-10"},vl={class:"flex items-center flex-col justify-center text-primary"},yl={class:"flex items-center mx-1"},bl={class:""},wl={class:"flex items-center mx-2"},xl={class:""},kl={class:"mb-6 mt-2 flex justify-center"},$l=U({__name:"index",emits:["close"],setup(e,{emit:a}){const s=re().$io,{playerInfo:o}=se(Y()),{fetchPlayer:l}=Y(),r=q(),d=q(!1),u=q(!1),c=ie({showEquipInfo:!1,equipSelected:{}});s.on("upgrade:preview:response",b=>{r.value=b}),s.on("equip:upgrade:response",async b=>{l(),r.value=b,d.value=!1,N("Cường hoá thành công",2e3,"bottom")}),Te(()=>{s.off("equip:upgrade:response"),s.off("upgrade:preview:response")});const f=b=>{console.log("equip",b),c.equipSelected=b,s.emit("equip:upgrade:preview",b._id)},y=()=>{var b,p;if(fe(),d.value=!0,!!o.value){if(!c.equipSelected._id){N("Đạo hữu cần chọn trang bị để nâng cấp",2e3,"bottom"),d.value=!1;return}if(r.value.gold>((b=o.value)==null?void 0:b.gold)){N("Đạo hữu không đủ Tiền tiên để nâng cấp",2e3,"bottom"),d.value=!1;return}if(r.value.totalCuongHoaThach<r.value.cuongHoaThach){N("Nguyên liệu nâng cấp của đạo hữu không đủ",2e3,"bottom"),d.value=!1;return}s.emit("equip:upgrade","upgrade",(p=c.equipSelected)==null?void 0:p._id)}};return(b,p)=>{var E,j,M;const g=oe,h=je,w=_e,k=pt,B=Oe,$=Le;return i(),m(C,null,[v(g,{show:t(u),"onUpdate:show":p[0]||(p[0]=V=>Z(u)?u.value=V:null),position:"center"},{default:x(()=>[hl]),_:1},8,["show"]),v(g,{show:t(c).showEquipInfo,"onUpdate:show":p[1]||(p[1]=V=>t(c).showEquipInfo=V)},{default:x(()=>[v(h,{equipment:t(c).equipSelected},null,8,["equipment"])]),_:1},8,["show"]),v(k,{onOnselected:f},{title:x(()=>[v(w,{class:"my-2"},{default:x(()=>[fl]),_:1})]),_:1}),t(r)?(i(),m("div",gl,[n("div",vl,[n("div",yl,[n("span",bl,"Tiền tiên: "+_((E=t(r))==null?void 0:E.gold),1)]),n("div",wl,[n("span",xl," Đá cường hoá: "+_((j=t(r))==null?void 0:j.cuongHoaThach)+"/"+_((M=t(r))==null?void 0:M.totalCuongHoaThach),1)])]),n("div",kl,[v(B,{loading:t(d),color:"white","loading-size":"mini",size:"mini",onClick:z(y,["stop"])},{default:x(()=>[T(" Cường hoá ")]),_:1},8,["loading","onClick"])])])):S("",!0),n("p",{class:"absolute bottom-5 right-5",onClick:p[2]||(p[2]=V=>u.value=!0)},[v($,{name:"ri:question-fill",size:"20",class:"text-white"})])],64)}}}),Cl=n("div",{class:"w-60 p-4 bg-white text-12"},[n("p",null,"Mỗi cấp sẽ tăng 5% hiệu quả thuộc tính trang bị"),n("br"),n("p",null,"Thất bại sẽ giảm 1 cấp.")],-1),Tl=n("div",{class:"whitespace-nowrap"}," Nâng sao ",-1),ql={key:0,class:"absolute bottom-0 w-full duration-500 text-10 font-semibold"},Bl={class:"flex-center"},Sl={class:"flex items-center mx-1"},Ol={class:"text-[#52648e]"},Pl={class:"flex items-center mx-1"},Il={class:"text-[#52648e]"},El={class:"flex items-center mx-1"},Al={class:"text-[#52648e]"},Ul={class:"mb-6 mt-2 flex justify-center"},zl=U({__name:"UpStar",emits:["close"],setup(e,{emit:a}){const{$io:s}=re(),{playerInfo:o}=se(Y()),{getPlayer:l,fetchPlayer:r}=Y(),d=q({}),u=q(),c=q(!1),f=q(!1),y=q(!1);s.on("star:preview:response",g=>{u.value=g}),s.on("equip:star:response",async g=>{r(),P(u,g),P(c,!1),N("Nâng sao trang bị thành công")});const b=g=>{d.value=g,s.emit("equip:star:preview",g._id)},p=()=>{var g,h,w;if(c.value=!0,!!o.value){if(!d.value._id){N("Đạo hữu cần chọn trang bị để nâng cấp"),c.value=!1;return}if(u.value.gold>((g=o.value)==null?void 0:g.gold)){N("Đạo hữu không đủ Tiền tiên để nâng cấp"),c.value=!1;return}if(u.value.knb>((h=o.value)==null?void 0:h.knb)){N("Đạo hữu không đủ KNB để nâng cấp"),c.value=!1;return}if(u.value.totalDaNangSao<u.value.daNangSao){N("Nguyên liệu nâng cấp của đạo hữu không đủ"),c.value=!1;return}s.emit("equip:star",(w=d.value)==null?void 0:w._id)}};return Te(()=>{s.off("equip:star:response"),s.off("star:preview:response")}),(g,h)=>{var V,O,X,Q;const w=oe,k=je,B=_e,$=pt,E=xe,j=Oe,M=Le;return i(),m(C,null,[v(w,{show:t(f),"onUpdate:show":h[0]||(h[0]=L=>Z(f)?f.value=L:null),position:"center"},{default:x(()=>[Cl]),_:1},8,["show"]),v(w,{show:t(y),"onUpdate:show":h[1]||(h[1]=L=>Z(y)?y.value=L:null),position:"center"},{default:x(()=>[v(k,{action:!1,equipment:t(d)},null,8,["equipment"])]),_:1},8,["show"]),v($,{onOnselected:b},{title:x(()=>[v(B,{class:"my-2"},{default:x(()=>[Tl]),_:1})]),_:1}),t(u)?(i(),m("div",ql,[n("div",Bl,[n("div",Sl,[v(E,{format:"webp",class:"w-5 mr-1",src:"/items/3_s.png"}),n("span",Ol,_((V=t(u))==null?void 0:V.gold),1)]),n("div",Pl,[v(E,{format:"webp",class:"w-5 mr-1",src:"/items/1_s.png"}),n("span",Il,_((O=t(u))==null?void 0:O.knb),1)]),n("div",El,[v(E,{format:"webp",class:"w-5 mr-1",src:"/items/17.png"}),n("span",Al,_((X=t(u))==null?void 0:X.daNangSao)+"/"+_((Q=t(u))==null?void 0:Q.totalDaNangSao),1)])]),n("div",Ul,[v(j,{loading:t(c),color:"white","loading-size":"mini",size:"mini",onClick:z(p,["stop"])},{default:x(()=>[T(" Nâng sao ")]),_:1},8,["loading","onClick"])])])):S("",!0),n("p",{class:"absolute bottom-5 right-5",onClick:h[2]||(h[2]=L=>f.value=!0)},[v(M,{name:"ri:question-fill",size:"20",class:"text-white"})])],64)}}}),jl=n("div",{class:"w-60 p-4 bg-white text-12"},[n("p",null,"Mỗi bậc sẽ tăng 10% toàn bộ thuộc tính gốc cho trang bị"),n("br"),n("p",{class:"pb-4"}," Mỗi lần lên cấp sẽ cần số lượng phôi cùng cấp bậc với trang bị cần nâng "),n("p",{class:"pb-4"}," Sau khi tăng bậc phôi sẽ bị mất "),n("p",null,"Tăng bậc trang bị sẽ có tỉ lên thành công 100%")],-1),Rl=n("div",{class:"whitespace-nowrap"}," Nâng bậc ",-1),Nl={class:"absolute bottom-20 h-20 w-full"},Dl=n("div",{text:"space-nowrap primary 8"}," Kho trang bị ",-1),Ll={key:0,p:"2",h:"full",overflow:"scroll",gap:"2",class:"grid grid-cols-2"},Ml=["onClick"],Vl={key:0,pos:"absolute",text:"8 semibold primary",bottom:"0",flex:"~ ",align:"items-center",h:"20",w:"full",justify:"around"},Hl={flex:"~ ",align:"items-center",w:"14"},Fl={flex:"~ ",align:"items-center",w:"17"},Gl={flex:"~ ",align:"items-center",w:"12"},Kl=U({__name:"UpRank",emits:["close"],setup(e,{emit:a}){const{$io:s}=re(),{playerInfo:o}=se(Y()),{fetchPlayer:l}=Y(),r=q(),d=q(!1),u=ie({equipSelected:{},showEquipInfo:!1,tooltip:!1}),c=q([]);s.on("rank:preview:response",p=>{P(d,!1),P(r,p)}),s.on("equip:rank:response",async p=>{l(),P(r,p),P(d,!1),N(p.message)}),Te(()=>{s.off("rank:preview:response"),s.off("equip:rank:response")});const f=p=>{u.equipSelected=p,P(d,!0),P(c,[]),s.emit("equip:rank:preview",p._id)},y=()=>{var p,g,h;if(P(d,!0),!!o.value){if(!u.equipSelected._id){N("Đạo hữu cần chọn trang bị để nâng cấp",2e3,"bottom"),P(d,!1);return}if(r.value.gold>((p=o.value)==null?void 0:p.gold)){N("Đạo hữu không đủ Tiền tiên để nâng cấp",2e3,"bottom"),P(d,!1);return}if(r.value.knb>((g=o.value)==null?void 0:g.knb)){N("Đạo hữu không đủ KNB để nâng cấp",2e3,"bottom"),P(d,!1);return}if(c.value.length<r.value.needFoodNumber){N("Số lượng trang bị phôi của đạo hữu không đủ",2e3,"bottom"),P(d,!1);return}s.emit("equip:rank:levelup",{_equipId:(h=u.equipSelected)==null?void 0:h._id,listFood:c.value})}},b=p=>{c.value.includes(p)?c.value.splice(c.value.indexOf(p),1):c.value.push(p)};return(p,g)=>{var E,j,M,V,O,X,Q;const h=oe,w=je,k=_e,B=pt,$=Oe;return i(),m(C,null,[v(h,{show:t(u).tooltip,"onUpdate:show":g[0]||(g[0]=L=>t(u).tooltip=L),position:"center"},{default:x(()=>[jl]),_:1},8,["show"]),v(h,{show:t(u).showEquipInfo,"onUpdate:show":g[1]||(g[1]=L=>t(u).showEquipInfo=L),position:"center"},{default:x(()=>[v(w,{action:!1,item:t(u).equipSelected},null,8,["item"])]),_:1},8,["show"]),v(B,{onOnselected:f},{title:x(()=>[v(k,{class:"my-2"},{default:x(()=>[Rl]),_:1})]),_:1}),n("div",Nl,[v(k,null,{default:x(()=>[Dl]),_:1}),(E=t(r))!=null&&E.playerEquipments&&((M=(j=t(r))==null?void 0:j.playerEquipments)==null?void 0:M.length)>0?(i(),m("div",Ll,[(i(!0),m(C,null,R((V=t(r))==null?void 0:V.playerEquipments,L=>(i(),m("div",{key:L==null?void 0:L._id,class:G([{"border border-green-400":t(c).includes(L._id)},"rounded p-1 border border-white/40"]),onClick:z(H=>b(L._id),["stop"])},[n("div",{class:"text-8 font-bold",style:K({color:t(J)(L.quality)})},_(`${t(Ae)[L.quality??1]} -`)+" "+_(L==null?void 0:L.name)+" (+"+_(L.enhance)+") ",5)],10,Ml))),128))])):S("",!0)]),t(r)?(i(),m("div",Vl,[n("div",Hl,[n("span",null,"Tiền tiên: "+_(t(me)((O=t(r))==null?void 0:O.gold)),1)]),n("div",Fl,[n("span",null,"Tiên duyên: "+_((X=t(r))==null?void 0:X.knb),1)]),n("div",Gl,[n("span",null,"Trang bị: "+_(t(c).length)+"/"+_((Q=t(r))==null?void 0:Q.needFoodNumber),1)]),v($,{"loading-size":"mini",loading:t(d),class:"!text-[#333]",size:"mini",onClick:z(y,["stop"])},{default:x(()=>[T(" Tăng bậc ")]),_:1},8,["loading","onClick"])])):S("",!0)],64)}}}),Wl=He(()=>Fe(()=>import("./index.30402993.js"),["./index.30402993.js","./entry.303ba4a8.js","./entry.aa262684.css","./Line.938dcc9e.js","./_plugin-vue_export-helper.c27b6911.js","./useMessage.4ef409fc.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./usePlayer.4eda164d.js","./index.040b5bdf.js","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css","./useBattleRound.ae7aabef.js"],import.meta.url).then(e=>e.default||e)),Yl={class:"flex-center bg-[#191b1e] max-w-[60vh] w-[95vw] h-[70vh]"},Ql={class:"w-full h-full relative border border-white/40"},Jl={class:"font-bold absolute left-[calc(50%_-_50px)] top-2 text-white text-12 w-25 flex justify-center"},Xl={class:"flex justify-between w-full absolute top-10 h-[85%]"},Zl={class:"flex flex-col gap-2 ml-2 w-[20%] h-full overflow-auto"},ea=["onClick"],ta={class:"text-10 font-bold italic"},na={key:1,class:"diamond w-15"},oa={class:"text-10 font-bold italic"},sa=n("div",{class:"text-8 whitespace-nowrap"}," (Trống) ",-1),la=["onClick"],aa={class:"text-10 font-bold italic"},ia={key:1,class:"diamond w-15"},ra={class:"text-10 font-bold italic"},ca=n("div",{class:"text-8 whitespace-nowrap"}," (Trống) ",-1),ua={class:"w-[37%] border-x border-white/10 max-h-[100%] overflow-auto"},da=n("div",{class:"text-white text-center text-12 pt-2 border-b border-white/10 h-10"}," Đá khảm ",-1),pa={key:0,class:"relative"},_a=n("span",{class:"ml-2 text-primary text-8"}," (Chưa khảm) ",-1),ma={class:"text-center mt-2"},ha={class:"w-[37%] mr-4 ml-[1px] max-h-[100%] overflow-auto"},fa=n("div",{class:"text-white text-center text-12 pt-2 h-10 border-b border-white/10"}," Có thể khảm ",-1),ga=U({__name:"HandleUpGem",emits:["equipSelected"],setup(e,{emit:a}){const{$io:s}=re(),{slot1:o,slot2:l,slot3:r,slot4:d,slot5:u,slot6:c,slot7:f,slot8:y,leftSlots:b,rightSlots:p}=se(Ye());Ye();const{getPlayer:g}=Y(),h=q({}),w=q([]),k=q(),B=q(!1),$=q(0),E=q(!1),j=q(!1),M=async()=>{h.value.slot&&(w.value=await $fetch("/api/gem",{params:{slot:h.value.slot}}))};s.on("gem:mosaic:response",async D=>{N(D.message,3e3),D.success&&(await M(),await g(),P(h,D.equipment))}),s.on("gem:unmosaic:response",async D=>{N(D.message,3e3),D.success&&(await M(),await g(),P(h,D.equipment))}),s.on("gem:punchahole:response",D=>{N(D.message,2e3),P(E,!1),D.success&&P(h,D.equipment)});const V=A(()=>h.value._id?h.value.gemSlot-$.value:[]),O=()=>{s.off("equip:gem:preview"),s.off("gem:preview:response"),s.emit("equip:gem:preview",h.value._id),s.on("gem:preview:response",D=>{qe({title:"Nhắc nhở",message:`Đục thêm 1 lỗ trên trang bi này cần ${D==null?void 0:D.needPunchAHole} KNB đạo hữu có muốn thực hiện?`,confirmButtonText:"Chắc chắn",cancelButtonText:"Không chắc",closeOnClickOverlay:!1,dialogClass:"!bg-[#00000040] text-white",confirmButtonColor:"#5388c1",confirmButtonTextColor:"white",cancelButtonTextColor:"#5388c1",onConfirm:()=>{P(E,!0),s.emit("equip:gem:punchahole",h.value._id)}})})},X=D=>{s.emit("gem:mosaic",h.value._id,D._id),P(B,!1)},Q=(D,ee)=>{qe({title:"Nhắc nhở",message:`Đạo hữu có chắc chắc gỡ ${D.name} ra khỏi ${h.value.name}?`,confirmButtonText:"Chắc chắn",cancelButtonText:"Không chắc",closeOnClickOverlay:!1,dialogClass:"!bg-[#00000040] text-white",confirmButtonColor:"#5388c1",confirmButtonTextColor:"white",cancelButtonTextColor:"#5388c1",onConfirm:()=>{s.emit("gem:unmosaic",h.value._id,D,ee)}})},L=D=>{P(k,D),P(B,!0),P(j,!0)},H=D=>{P(k,D),P(B,!0),P(j,!1)},W=async()=>{await M(),P(B,!1)};return be(h,async D=>{var ee;P($,((ee=D.gems)==null?void 0:ee.length)??0),await M()}),Te(()=>{s.off("gem:mosaic:response"),s.off("gem:unmosaic:response"),s.off("gem:preview:response"),s.off("gem:punchahole:response")}),(D,ee)=>{const ue=Wl,de=oe,te=Le,ve=St,Pe=xe,Me=Oe;return i(),m(C,null,[v(de,{show:t(B),"onUpdate:show":ee[0]||(ee[0]=F=>Z(B)?B.value=F:null),position:"center"},{default:x(()=>[v(ue,{gem:t(k),"select-action":t(j),onSelected:X,onMergegem:W},null,8,["gem","select-action"])]),_:1},8,["show"]),n("div",Yl,[n("div",Ql,[n("span",Jl,[we(D.$slots,"title")]),n("div",Xl,[n("div",Zl,[(i(!0),m(C,null,R(t(b),F=>{var ce,pe,he,$e;return i(),m("div",{key:F.no},[F!=null&&F.slot?(i(),m("button",{key:0,class:G(["diamond w-15",{"border border-green-500 bg-[#000000]":((ce=t(h))==null?void 0:ce._id)===((pe=F.slot)==null?void 0:pe._id)}]),onClick:z(Ie=>h.value=F.slot,["stop"])},[n("div",ta,_((he=F.slot)==null?void 0:he.name)+"(+"+_(($e=F.slot)==null?void 0:$e.enhance)+") ",1)],10,ea)):(i(),m("button",na,[n("div",oa,[T(_(t(Be)[F.no])+" ",1),sa])]))])}),128)),(i(!0),m(C,null,R(t(p),F=>{var ce,pe,he,$e,Ie;return i(),m("div",{key:F.no},[F!=null&&F.slot?(i(),m("button",{key:0,class:G(["diamond w-15",{"border border-green-500 bg-green-500":((ce=t(h))==null?void 0:ce._id)===((pe=F.slot)==null?void 0:pe._id)}]),style:K({border:`1px solid ${t(J)((he=F.slot)==null?void 0:he.quality)}`}),onClick:z(Ke=>h.value=F.slot,["stop"])},[n("div",aa,_(($e=F.slot)==null?void 0:$e.name)+"(+"+_((Ie=F.slot)==null?void 0:Ie.enhance)+") ",1)],14,la)):(i(),m("button",ia,[n("div",ra,[T(_(t(Be)[F.no])+" ",1),ca])]))])}),128))]),n("div",ua,[da,t(h).gems&&t(h).gems.length>0?(i(),m("div",pa,[(i(!0),m(C,null,R(t(h).gems,(F,ce)=>(i(),I(ve,{key:ce,class:"px-1 p-1 bg-[#00000040] mb-[1px]","bg-class":"!w-10 !h-10",gem:F,onClick:pe=>H(F)},{default:x(()=>[v(te,{class:"absolute right-2 text-gray-300",size:"10",name:"fa:close",onClick:z(pe=>Q(F,ce),["stop"])},null,8,["onClick"])]),_:2},1032,["gem","onClick"]))),128))])):S("",!0),t(V)>0?(i(!0),m(C,{key:1},R(t(V),F=>(i(),m("div",{key:F,class:"flex items-center px-1 p-1 bg-[#00000040] mb-[1px] border border-white/20 m-2"},[v(Pe,{src:"/gem/default.png",class:"w-10 h-10 bg-[#000000]",format:"webp"}),_a]))),128)):S("",!0),n("div",ma,[t(h)._id?(i(),I(Me,{key:0,loading:t(E),"loading-type":"cube",size:"mini",class:"!text-[#333] font-medium mx-2 m-auto italic",onClick:O},{default:x(()=>[T(" Đục lỗ ")]),_:1},8,["loading"])):S("",!0)])]),n("div",ha,[fa,t(h)._id?(i(!0),m(C,{key:0},R(t(w),(F,ce)=>(i(),I(ve,{key:ce,class:"px-1 m-1 p-1 bg-[#00000040] mb-[1px] border border-white/20","bg-class":"!w-10 !h-10",gem:F,onClick:pe=>L(F)},null,8,["gem","onClick"]))),128)):S("",!0)])])])])],64)}}}),va={};function ya(e,a){const s=ga;return i(),I(s,null,{title:x(()=>[T(" Đá hồn ")]),_:1})}const ba=Qe(va,[["render",ya]]),wa=U({__name:"Menus",setup(e){const a=ne("toggleUpgrade"),s=ne("toggleUpStar"),o=ne("toggleUpRank"),l=ne("toggleUpGem"),r=ne("togglePlayerInfo"),d=ne("toggleBoss");return(u,c)=>{const f=qt,y=oe,b=Ks,p=$l,g=zl,h=Kl,w=ba;return i(),m(C,null,[v(y,{show:t(d),"onUpdate:show":c[0]||(c[0]=k=>Z(d)?d.value=k:null)},{default:x(()=>[v(f)]),_:1},8,["show"]),v(y,{show:t(r),"onUpdate:show":c[1]||(c[1]=k=>Z(r)?r.value=k:null)},{default:x(()=>[v(b)]),_:1},8,["show"]),v(y,{show:t(a),"onUpdate:show":c[2]||(c[2]=k=>Z(a)?a.value=k:null)},{default:x(()=>[v(p)]),_:1},8,["show"]),v(y,{show:t(s),"onUpdate:show":c[3]||(c[3]=k=>Z(s)?s.value=k:null)},{default:x(()=>[v(g)]),_:1},8,["show"]),v(y,{show:t(o),"onUpdate:show":c[4]||(c[4]=k=>Z(o)?o.value=k:null)},{default:x(()=>[v(h)]),_:1},8,["show"]),v(y,{show:t(l),"onUpdate:show":c[5]||(c[5]=k=>Z(l)?l.value=k:null)},{default:x(()=>[v(w)]),_:1},8,["show"])],64)}}}),xa={bg:"primary",m:"auto",p:"2",border:"1 rounded white/20",w:"90%"},ka={text:"center white"},$a=["onClick"],Ca={bg:"primary",m:"auto",p:"2",border:"1 rounded white/20",class:"w-[90%]"},Ta={class:"grid grid-cols-4 gap-4 text-10"},qa={class:"grid grid-cols-4 gap-4 text-10 mt-2"},Ba={class:"grid grid-cols-4 gap-4 text-10 mt-2"},Sa=["onClick"],Oa=["onClick"],Pa=U({__name:"Result",props:{isWin:{type:Boolean},damageList:null,reward:null},emits:["close","onRefresh"],setup(e,{emit:a}){const s=e,o=A(()=>s.isWin),l=A(()=>!s.isWin),r=ie({equipment:{},item:{}}),d=ie({showReward:!1,showEquipment:!1,showItem:!1}),u=f=>{r.equipment=f,d.showEquipment=!0},c=()=>{a("onRefresh")};return(f,y)=>{const b=je,p=oe,g=_e;return i(),m(C,null,[v(p,{show:t(d).showEquipment,"onUpdate:show":y[0]||(y[0]=h=>t(d).showEquipment=h)},{default:x(()=>[v(b,{equipment:t(r).equipment},null,8,["equipment"])]),_:1},8,["show"]),v(p,{show:t(l),"onUpdate:show":y[1]||(y[1]=h=>Z(l)?l.value=h:null),onClose:c},{default:x(()=>{var h;return[n("div",xa,[v(g,{m:"b-2",text:"12 white space-nowrap"},{default:x(()=>[T(" Khiêu chiến thất bại ")]),_:1}),n("div",ka," Sát thương gây ra "+_(t(me)((h=e.damageList)==null?void 0:h.self)),1),n("div",{class:"text-center text-primary underline text-10 mt-4",onClick:z(c,["stop"])}," Đã hiểu ",8,$a)])]}),_:1},8,["show"]),v(p,{show:t(o),"onUpdate:show":y[2]||(y[2]=h=>Z(o)?o.value=h:null),overlay:!0},{default:x(()=>{var h,w,k;return[n("div",Ca,[v(g,{m:"b-2",text:"12 white space-nowrap"},{default:x(()=>[T(" Phần thưởng ")]),_:1}),n("div",Ta,[(i(!0),m(C,null,R((h=e.reward)==null?void 0:h.base,(B,$)=>(i(),m("div",{key:$},[n("div",{class:"border border-white/40 p-2",style:K({color:t(J)(t(Tt)[$])})},_(t(Ct)[$])+" x"+_(B),5)]))),128))]),n("div",qa,[(i(!0),m(C,null,R((w=e.reward)==null?void 0:w.items,(B,$)=>(i(),m("div",{key:$,class:"underline pl-1 border border-white/40 p-2",style:K({color:t(J)(B.quality)})},_(B.name),5))),128))]),n("div",Ba,[(i(!0),m(C,null,R((k=e.reward)==null?void 0:k.equipments,(B,$)=>(i(),m("div",{key:$,class:"underline pl-1 border border-white/40 p-2",style:K({color:t(J)(B.quality)}),onClick:z(E=>u(B),["stop"])},_(B.name),13,Sa))),128))]),n("div",{class:"text-center text-primary underline text-10 mt-4",onClick:z(c,["stop"])}," Đã hiểu ",8,Oa)])]}),_:1},8,["show"])],64)}}}),Ia={class:"h-4 text-10 w-full bg-[#212121] relative flex items-center p-[2px] border border-white/40"},Ea={class:"absolute top-[-1px] text-[#d2d2d2] w-full text-center"},Aa=U({__name:"StatusBar",props:{receiverHp:null,hp:null,mp:null,receiverMp:null},setup(e){return(a,s)=>(i(),m("div",Ia,[n("div",{class:"h-3 w-full bg-[#91100a]",transition:"~ duration-500",style:K({width:`${e.receiverHp/e.hp*100}%`})},[n("div",Ea,_(t(me)(e.receiverHp)??0)+"/ "+_(t(me)(e.hp)??0),1)],4)]))}}),Ua={class:"flex justify-start items-end"},za={class:"text-10 ml-1 text-[#6ce8d4] line-clamp-1"},ja={class:"text-[#333] text-10"},Ra={class:"h-4 text-8 text-[#d2d2d2] bg-[#00000040] relative flex items-center p-[2px] border border-white/40"},Et=U({__name:"Realtime",props:{realTime:null,receiver:null,match:null,pos:null,round:null},setup(e){const a=e,s=A(()=>a.match.extends),o=A(()=>a.match.attribute),l=A(()=>{var r,d;return Ge((r=s.value)==null?void 0:r.level,((d=s.value)==null?void 0:d.level)+1)});return(r,d)=>{var c,f,y,b,p,g,h,w,k,B,$,E,j,M,V,O;const u=Aa;return i(),m("div",{pos:"relative",transition:"~ duration-800 transform",h:"12",class:"border-box",style:K({transform:(c=e.realTime[t(s)._id])!=null&&c.effect?`${e.pos===1?"translate(10%)":"translate(-10%)"}`:""})},[n("div",{w:"28",class:G({"grayscale filter":((f=e.receiver[t(s)._id])==null?void 0:f.hp)<=0})},[n("div",Ua,[n("span",za,_(((y=t(s))==null?void 0:y.name)??"..."),1)]),n("div",ja,[v(u,{"receiver-hp":(b=e.receiver[t(s)._id])==null?void 0:b.hp,hp:(p=t(o))==null?void 0:p.hp},null,8,["receiver-hp","hp"]),n("div",Ra,_((g=t(l))==null?void 0:g.levelTitle)+" "+_((h=t(l))==null?void 0:h.floor),1)])],2),n("span",{class:G(["battle-action-bloodsucking whitespace-nowrap",{show:((w=e.realTime[t(s)._id])==null?void 0:w.bloodsucking)>0&&((k=e.realTime[t(s)._id])==null?void 0:k.effect)}])}," (+"+_((B=e.realTime[t(s)._id])==null?void 0:B.bloodsucking)+") ",3),n("span",{class:G([{show:(($=e.realTime[t(s)._id])==null?void 0:$.defenderCounterAttack)>0&&e.realTime[t(s)._id].effect},"battle-damage whitespace-nowrap"])}," Phản đòn -"+_((E=e.realTime[t(s)._id])==null?void 0:E.defenderCounterAttack),3),n("span",{class:G(["battle-action whitespace-nowrap text-green-300",{show:((j=e.realTime[t(s)._id])==null?void 0:j.defenderAvoid)&&e.realTime[t(s)._id].effect}])}," Né tránh ",2),n("span",{class:G(["battle-damage",{show:!((M=e.realTime[t(s)._id])!=null&&M.showDamage)&&e.round>0&&!((V=e.realTime[t(s)._id])!=null&&V.avoid)}])},[n("span",null,_((O=e.receiver[t(s)._id])==null?void 0:O.damage),1)],2)],4)}}}),Na={h:"10",pos:"absolute",bottom:"11",w:"full",flex:"~ ",align:"items-enter",justify:"end",font:"italic"},Da=["onClick"],At=U({__name:"Controls",props:{back:{type:Boolean}},emits:["onBack","onSkip"],setup(e,{emit:a}){const{loading:s,refresh:o,speed:l,roundNum:r}=se(Ue()),{fn:d}=Ue(),u=()=>{a("onSkip"),d.skipBattle()};return(c,f)=>(i(),m("div",Na,[at(n("button",{text:"8",m:"x-2",h:"6",w:"6",font:"italic semibold",class:"border-full-box bg-button-menu",onClick:f[0]||(f[0]=y=>l.value=1.5)}," Tăng tốc ",512),[[it,t(l)===1]]),at(n("button",{text:"8",m:"x-2",h:"6",w:"6",font:"italic semibold",class:"border-full-box bg-button-menu",onClick:f[1]||(f[1]=y=>l.value=1)}," Giảm tốc ",512),[[it,t(l)===1.5]]),t(r)>3?(i(),m("button",{key:0,text:"8",m:"x-2",h:"6",w:"6",font:"italic semibold",class:"border-full-box bg-button-menu",onClick:z(u,["stop"])}," Bỏ qua ",8,Da)):S("",!0),e.back?(i(),m("button",{key:1,text:"8",m:"x-2",h:"6",w:"6",font:"italic semibold",class:"border-full-box bg-button-menu",onClick:f[2]||(f[2]=z(y=>a("onBack"),["stop"]))}," Trở về ")):S("",!0)]))}});const La={key:0,text:"10",flex:"~ ",align:"items-center"},Ma={m:"x-2"},Va=["onClick"],Ut=U({__name:"BottomBar",props:{isPve:{type:Boolean},midId:null},emits:["changeBattle"],setup(e,{emit:a}){const{loading:s}=se(Ue()),{loadPlayer:o}=Y(),{fn:l}=Ue(),r=async()=>{try{P(s,!0);const d=await $fetch("/api/mid/set",{method:"POST"});l.stopBattle(),a("changeBattle"),o(d),P(s,!1),N("Qua ải thành công",2e3)}catch(d){N(d.statusMessage,2e3),P(s,!1)}};return(d,u)=>{const c=ke;return e.isPve?(i(),I(c,{key:0,size:"mini",color:"#ffffff"},{default:x(()=>[e.midId?(i(),m("div",La,[n("span",Ma," Hiện tại: thứ "+_(e.midId)+" Ải ",1),n("button",{h:"6",p:"x-2",m:"l-1 x-2",border:"rounded",text:"10 white",font:"semibold italic",class:"bg-[#841919]",onClick:z(r,["stop"])}," Khiêu chiến ",8,Va)])):S("",!0)]),_:1})):S("",!0)}}}),Ha=()=>{const{$io:e}=re(),{playerInfo:a}=se(Y()),s=ne("battleRequest");return{useEventPve:c=>{var f,y,b,p;e.emit("battle:join:pve",{skip:c,kind:sn.PVE,player:{userId:(f=a.value)==null?void 0:f.userId},target:{type:Ne.MONSTER,id:(p=(b=(y=a.value)==null?void 0:y.mid)==null?void 0:b.current)==null?void 0:p.monsterId}})},useEventDaily:()=>{var c,f,y,b;e.emit("battle:join:daily",{kind:(c=s.value)==null?void 0:c.target,player:{userId:(f=a.value)==null?void 0:f.userId},target:{type:(y=s.value)==null?void 0:y.target,id:(b=s.value)==null?void 0:b.id}})},useEventElite:()=>{var c,f,y,b;e.emit("battle:join:elite",{kind:(c=s.value)==null?void 0:c.target,player:{userId:(f=a.value)==null?void 0:f.userId},target:{type:(y=s.value)==null?void 0:y.target,id:(b=s.value)==null?void 0:b.id}})},offAllEvent:()=>{e.off("battle:start:pve"),e.off("battle:start:daily"),e.off("battle:start:elite"),e.off("battle:start:frame_time")},useEventFrameTime:()=>{var c,f,y,b;e.emit("battle:join:frame_time",{kind:(c=s.value)==null?void 0:c.target,player:{userId:(f=a.value)==null?void 0:f.userId},target:{type:(y=s.value)==null?void 0:y.target,id:(b=s.value)==null?void 0:b.id}})}}},Fa={key:1,flex:"~ ",pos:"absolute",align:"items-center",justify:"around",w:"full",class:"top-[30%]"},Ga=U({__name:"index",setup(e){const{match:a,loading:s,refresh:o,stateRunning:l,speed:r,roundNum:d,options:u}=se(Ue()),{$io:c}=re(),{fn:f}=Ue(),{playerInfo:y}=se(Y()),{useEventPve:b,useEventElite:p,useEventDaily:g,useEventFrameTime:h,offAllEvent:w}=Ha(),k=q(),B=ne("battleRequest"),$=q(!1),E=A(()=>{var H;return((H=k.value)==null?void 0:H.kind)==="pve"}),j=A(()=>{var H,W;return((H=k.value)==null?void 0:H.winner)===((W=y.value)==null?void 0:W._id)}),M=A(()=>{var H;return((H=k.value)==null?void 0:H.kind)===Ne.BOSS_ELITE}),V=q(!1),O=async H=>{P($,!1),P(k,H),await f.startBattle(H,async()=>{var W,D,ee,ue,de,te,ve;if(await It(),y.value&&l.value&&(y.value.gold+=((W=l.value.reward)==null?void 0:W.base.gold)??0,y.value.exp+=((D=l.value.reward)==null?void 0:D.base.exp)??0),!E){P(V,!0);return}if(E.value){if(P($,!1),nn.allowMultiple(!0),N(`Nhận Tiền Tiên x${(ee=l.value.reward)==null?void 0:ee.base.gold}`,3e3,"top"),N(`Nhận Tu Vi x${(ue=l.value.reward)==null?void 0:ue.base.exp}`,3e3,"top"),(de=l.value.reward)!=null&&de.items&&((te=l.value.reward)==null?void 0:te.items.length)>0)for(const Pe of(ve=l.value.reward)==null?void 0:ve.items)N(`${Pe.name} x${Pe.quantity}`,3e3,"top");b()}})},X=H=>{f.stopBattle(),b(H),c.off("battle:start:pve"),c.on("battle:start:pve",async W=>{await O(W)})},Q=()=>{var H;if(P($,!1),P(V,!1),j.value){X(!1);return}switch((H=B.value)==null?void 0:H.target){case Ne.BOSS_ELITE:P(s,!0),p();break;case Ne.BOSS_FRAME_TIME:P(s,!0),h();break;default:b()}},L=()=>{E.value||P(V,!0)};return Ze(()=>{b(),c.on("battle:start:pve",async H=>{await O(H)})}),Te(async()=>{c.off("battle:start"),w()}),be(B,async H=>{switch(P(V,!1),P($,!0),w(),f.stopBattle(),H.target){case Ne.BOSS_DAILY:setTimeout(()=>{g(),c.on("battle:start:daily",async W=>{await O(W)})},1e3);break;case Ne.BOSS_ELITE:setTimeout(()=>{p(),c.on("battle:start:elite",async W=>{await O(W)})},1e3);break;case Ne.BOSS_FRAME_TIME:setTimeout(()=>{h(),c.on("battle:start:frame_time",async W=>{await O(W)})},1e3);break}}),(H,W)=>{const D=Pa,ee=xe,ue=Et,de=ln,te=At,ve=Ut,Pe=ke;return i(),m(C,null,[t(V)&&!t(E)?(i(),I(D,{key:0,reward:t(l).reward,"is-win":t(j),"damage-list":t(k).damageList,onOnRefresh:Q},null,8,["reward","is-win","damage-list"])):S("",!0),v(Pe,{loading:t(s),size:"mini",class:"h-full",description:t(le)[Math.round(t(Se)(0,t(le).length))],color:"#f5f5f5"},{default:x(()=>{var Me,F,ce,pe;return[n("div",{flex:"~ ",justify:"around",pos:"relative",w:"full",h:"full",class:G({"bg-[#163334]":!((Me=t(o))!=null&&Me.inRefresh)&&!t(E)||t($)})},[t($)?(i(),I(ee,{key:0,format:"webp",src:"/battle/loading.png",w:"35",h:"35",top:"[40%]",pos:"absolute",class:"transform-center",object:"cover"})):S("",!0),t($)?S("",!0):(i(),m("div",Fa,[t(l)?(i(!0),m(C,{key:0},R(t(a),(he,$e)=>{var Ie,Ke;return i(),I(ue,{key:$e,match:he,receiver:(Ie=t(l))==null?void 0:Ie.receiver,"real-time":(Ke=t(l))==null?void 0:Ke.realTime,pos:he.extends.pos,round:t(d)},null,8,["match","receiver","real-time","pos","round"])}),128)):S("",!0)])),(F=t(o))!=null&&F.inRefresh?(i(),I(de,{key:2,top:"0",text:"primary",pos:"absolute","refresh-time":(ce=t(o))==null?void 0:ce.refreshTime,onRefreshFinished:Q},null,8,["refresh-time"])):S("",!0)],2),v(te,{back:t(M),onOnBack:X,onOnSkip:L},null,8,["back"]),n("div",{class:G({"!bg-[#540905]":!((pe=t(o))!=null&&pe.inRefresh)}),transition:"~ colors duration-800",h:"10",pos:"absolute",bottom:"0",w:"full",flex:"~ ",align:"items-center",justify:"end",text:"gray-100",font:"italic",bg:"base"},[v(ve,{"is-pve":t(E),"mid-id":t(y).midId,onChangBattle:W[0]||(W[0]=he=>X(!0))},null,8,["is-pve","mid-id"])],2)]}),_:1},8,["loading","description"])],64)}}}),Ka={bg:"primary",m:"auto",p:"2",border:"1 rounded white/20",class:"w-[90%]"},Wa={text:"primary center 10",m:"y-2"},Ya={class:"grid grid-cols-4 gap-4 text-10"},Qa=["onClick"],Ja={key:1,flex:"~ ",pos:"absolute",align:"items-center",justify:"around",w:"full",class:"top-[30%]"},Xa=U({__name:"index",setup(e){const{match:a,loading:s,refresh:o,stateRunning:l,speed:r,roundNum:d,options:u}=se(Ue()),{$io:c}=re(),{fn:f}=Ue();se(Y());const y=q(!0),b=q(),p=q(!1),g=async k=>{await f.startBattle(k,async()=>{P(ne("refreshArena"),!0),P(p,!0),await It()})},h=()=>{P(ne("isArena"),!1)},w=()=>{P(p,!1),h()};return Ze(()=>{P(y,!1),c.on("response:pvp:solo",async k=>{if(k!=null&&k.reachLimit){N("Đã đạt đến giới hạn khiêu chiến mỗi ngày",2e3),h();return}P(b,k),await g(k)})}),Te(async()=>{c.off("response:pvp:solo")}),(k,B)=>{const $=_e,E=oe,j=xe,M=Et,V=At,O=Ut,X=ke;return i(),m(C,null,[v(E,{show:t(p),"onUpdate:show":B[0]||(B[0]=Q=>Z(p)?p.value=Q:null)},{default:x(()=>[n("div",Ka,[v($,{m:"b-2",text:"12 white space-nowrap"},{default:x(()=>[T(" Phần thưởng ")]),_:1}),n("div",Wa,_(t(b).youwin?"Thành công":"Thất bại")+" khiêu chiến "+_(t(b).defender.name),1),n("div",Ya,[(i(!0),m(C,null,R(t(b).reward,(Q,L)=>(i(),m("div",{key:L},[n("div",{class:"border border-white/40 p-2",style:K({color:t(J)(t(Tt)[L])})},_(t(Ct)[L])+" x"+_(Q),5)]))),128))]),n("div",{class:"text-center text-primary underline text-10 mt-4",onClick:z(w,["stop"])}," Đã hiểu ",8,Qa)])]),_:1},8,["show"]),v(X,{loading:t(s),size:"mini",class:"h-full",description:t(le)[Math.round(t(Se)(0,t(le).length))],color:"#f5f5f5"},{default:x(()=>{var Q,L;return[n("div",{flex:"~ ",justify:"around",pos:"relative",w:"full",h:"full",class:G({"bg-[#163334]":!((Q=t(o))!=null&&Q.inRefresh)})},[t(y)?(i(),I(j,{key:0,format:"webp",src:"/battle/loading.png",w:"35",h:"35",top:"[40%]",pos:"absolute",class:"transform-center",object:"cover"})):(i(),m("div",Ja,[t(l)?(i(!0),m(C,{key:0},R(t(a),(H,W)=>{var D,ee;return i(),I(M,{key:W,match:H,receiver:(D=t(l))==null?void 0:D.receiver,"real-time":(ee=t(l))==null?void 0:ee.realTime,pos:H.extends.pos,round:t(d)},null,8,["match","receiver","real-time","pos","round"])}),128)):S("",!0)]))],2),v(V,{back:!0,onOnBack:h}),n("div",{class:G({"!bg-[#540905]":!((L=t(o))!=null&&L.inRefresh)}),transition:"~ colors duration-800",h:"10",pos:"absolute",bottom:"0",w:"full",flex:"~ ",align:"items-center",justify:"end",text:"gray-100",font:"italic",bg:"base"},[v(O)],2)]}),_:1},8,["loading","description"])],64)}}}),Za=He(()=>Fe(()=>import("./item.e380defa.js"),["./item.e380defa.js","./entry.303ba4a8.js","./entry.aa262684.css","./useMessage.4ef409fc.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./usePlayer.4eda164d.js","./index.040b5bdf.js","./Line.938dcc9e.js","./_plugin-vue_export-helper.c27b6911.js","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css","./useBattleRound.ae7aabef.js"],import.meta.url).then(e=>e.default||e)),ei={p:"2",h:"full"},ti=["onClick"],ni={class:"h-[calc(100%_-_45px)]",overflow:"auto",p:"x-2"},oi={class:"grid grid-cols-3 gap-2"},si=U({__name:"index",setup(e){const{data:a}=ze("/api/store","$5QKpVAhv65"),s=q("coin"),o=[{key:"coin",name:"Tiên ngọc"},{key:"knb",name:"Tiên duyên"},{key:"scoreTienDau",name:"Shop Tiên Đấu"},{key:"gold",name:"Tiền tiên"}],l=A(()=>a.value?a.value.filter(r=>r.currency===s.value):[]);return(r,d)=>{const u=Za;return i(),m("div",ei,[(i(),m(C,null,R(o,c=>n("button",{key:c.key,class:G({"!opacity-100":c.key===t(s)}),transition:"~ opacity duration-800",m:"x-2 y-2",p:"x-2",h:"8",font:"italic bold leading-3",opacity:"40",border:"rounded 1 white/40",text:"primary",onClick:z(f=>s.value=c.key,["stop"])},_(c.name),11,ti)),64)),n("div",ni,[n("div",oi,[(i(!0),m(C,null,R(t(l),(c,f)=>(i(),I(u,{key:f,"store-item":c},null,8,["store-item"]))),128))])])])}}}),li=n("div",{text:"space-nowrap"}," Ghép Đá Hồn ",-1),ai={m:"t-2 b-2",display:"flex",justify:"between",align:"items-center",gap:"2"},ii={display:"flex",align:"items-center",border:"white/20 1",p:"2"},ri={position:"relative",w:"10",h:"10",m:"r-2"},ci=n("br",null,null,-1),ui={display:"flex",align:"items-center",border:"white/20 1",p:"2"},di={position:"relative",w:"10",h:"10",m:"r-2"},pi=n("br",null,null,-1),_i={display:"flex",align:"items-center",border:"white/20 1",p:"2"},mi={position:"relative",w:"10",h:"10",m:"r-2"},hi=n("br",null,null,-1),fi=U({__name:"MergePreview",props:{gemId:null,quality:null},setup(e){const a=e,s=A(()=>Ae[a.quality]);return(o,l)=>{const r=_e,d=xe,u=Le;return i(),m(C,null,[v(r,{p:"y-2"},{default:x(()=>[li]),_:1}),n("div",ai,[n("div",ii,[n("div",ri,[v(d,{position:"absolute",top:"0",format:"webp",src:`/quality_bg/iconbg_${e.quality}.png`},null,8,["src"]),v(d,{position:"absolute",border:"rounded-full",object:"cover",class:"transform-center w-[80%] h-[80%]",format:"webp",src:`/gem/${e.gemId}.png`},null,8,["src"])]),n("span",{text:"8",w:"5",style:K(t(st)(e.quality))},[T(_(t(s))+" ",1),ci,T(" x3 ")],4)]),v(u,{name:"mdi:arrow-right-bold-outline",size:"20",text:"blue-300"}),n("div",ui,[n("div",di,[v(d,{position:"absolute",top:"0",format:"webp",src:`/quality_bg/iconbg_${e.quality}.png`},null,8,["src"]),v(d,{position:"absolute",border:"rounded-full",object:"cover",class:"transform-center w-[80%] h-[80%]",format:"webp",src:`/gem/${e.gemId}.png`},null,8,["src"])]),n("span",{text:"8",w:"5",style:K(t(st)(e.quality+1))},[T(_(t(Ae)[e.quality+1])+" ",1),pi,T(" x3 ")],4)]),v(u,{name:"mdi:arrow-right-bold-outline",size:"20",class:"text-blue-300"}),n("div",_i,[n("div",mi,[v(d,{position:"absolute",top:"0",format:"webp",src:`/quality_bg/iconbg_${e.quality}.png`},null,8,["src"]),v(d,{position:"absolute",border:"rounded-full",object:"cover",class:"transform-center w-[80%] h-[80%]",format:"webp",src:`/gem/${e.gemId}.png`},null,8,["src"])]),n("span",{text:"8",w:"5",style:K(t(st)(e.quality+2))},[T(_(t(Ae)[e.quality+2])+" ",1),hi,T(" x3 ")],4)])])],64)}}}),gi={p:"4"},vi={text:"center",p:"y-4"},yi={text:"center",p:"y-2"},bi=U({__name:"Actions",props:{gem:null,sellAction:{type:Boolean},selectAction:{type:Boolean},mergeAction:{type:Boolean}},emits:["sell","selected","refresh"],setup(e,{emit:a}){const s=e,{$io:o}=re(),l=q(!1),r=q({price:1,quantity:1}),d=()=>{if(s.gem.sum<3){N("Số lượng đá hồn không đủ để hợp nhất",2e3);return}o.emit("gem:merge",s.gem)},u=async()=>{if(r.value.price<=0){N("Giá treo bán không hợp lệ");return}if(r.value.quantity<=0||r.value.quantity>s.gem.sum){N("Số lượng treo bán không hợp lệ");return}try{const c=await $fetch("/api/market/sell",{method:"POST",body:{type:"gem",quantity:r.value.quantity,price:r.value.price,_id:s.gem._id}});c.success&&(a("refresh"),l.value=!1,N(c.message))}catch(c){N(c.statusMessage)}};return(c,f)=>{const y=et,b=Oe,p=oe;return i(),m(C,null,[v(p,{show:t(l),"onUpdate:show":f[2]||(f[2]=g=>Z(l)?l.value=g:null),position:"bottom"},{default:x(()=>[n("div",gi,[v(y,{modelValue:t(r).price,"onUpdate:modelValue":f[0]||(f[0]=g=>t(r).price=g),placeholder:"Nhập giá bán"},null,8,["modelValue"]),v(y,{modelValue:t(r).quantity,"onUpdate:modelValue":f[1]||(f[1]=g=>t(r).quantity=g),placeholder:"Nhập số lượng"},null,8,["modelValue"])]),n("div",vi,[v(b,{font:"semibold",m:"x-2",class:"!text-[#333]",size:"small",onClick:z(u,["stop"])},{default:x(()=>[T(" Treo bán ")]),_:1},8,["onClick"])])]),_:1},8,["show"]),n("div",yi,[e.sellAction?(i(),I(b,{key:0,font:"semibold italic",m:"x-2",class:"!text-[#333]",size:"small",onClick:f[3]||(f[3]=z(g=>l.value=!0,["stop"]))},{default:x(()=>[T(" Treo bán ")]),_:1})):S("",!0),e.selectAction?(i(),I(b,{key:1,font:"semibold italic",m:"x-2",class:"!text-[#333]",size:"small",onClick:f[4]||(f[4]=z(g=>a("selected"),["stop"]))},{default:x(()=>[T(" Khảm đá ")]),_:1})):S("",!0),e.gem.sum>=3&&e.mergeAction?(i(),I(b,{key:2,font:"semibold italic",m:"x-2",size:"small",class:"!text-[#333]",onClick:z(d,["stop"])},{default:x(()=>[T(" Ghép đá ")]),_:1},8,["onClick"])):S("",!0)])],64)}}}),wi={key:0,pos:"relative",text:"white",bg:"primary",p:"0",m:"auto",border:"white/40 1 rounded",w:"11/12",font:"leading-6"},xi={flex:"~ col",align:"items-center",justify:"between",p:"x-3 t-4",font:"leading-5"},ki={flex:"~ ",w:"full"},$i={pos:"relative",w:"15",h:"15",m:"r-2"},Ci={class:"text-left"},Ti={key:0,text:"10",font:"bold"},qi={text:"10",border:"t white/40",m:"4",p:"2"},Bi={flex:"~ "},Si=n("div",{w:"25"}," Vị trí: ",-1),Oi={flex:"~ "},Pi=n("div",{w:"25"}," Trưởng Thành: ",-1),Ii={flex:"~ "},Ei=n("div",{w:"25"}," Phẩm đá hồn : ",-1),Ai={flex:"~ "},Ui=n("div",{w:"25"}," Thuộc tính: ",-1),zi={flex:"~ col"},ji=n("div",{text:"center 10"}," (Chỉ được khảm 1 đá hồn này lên trang bị) ",-1),zt=U({__name:"index",props:{gem:null,selectAction:{type:Boolean},sellAction:{type:Boolean},mergeGem:{type:Boolean}},emits:["selected","mergegem","refresh"],setup(e,{emit:a}){const s=e,{$io:o}=re(),l=A(()=>Ae[s.gem.quality]);return o.off("gem:merge:response"),o.on("gem:merge:response",r=>{N(r.message,2e3),r.success&&a("mergegem")}),(r,d)=>{const u=xe,c=Bt,f=fi,y=bi;return e.gem?(i(),m("div",wi,[n("div",xi,[n("div",ki,[n("div",$i,[v(u,{position:"absolute",top:"0",format:"webp",src:`/quality_bg/iconbg_${e.gem.quality}.png`},null,8,["src"]),v(u,{position:"absolute",border:"rounded-full",object:"cover",class:"transform-center w-[80%] h-[80%]",format:"webp",src:`/gem/${e.gem.gemId}.png`},null,8,["src"])]),n("div",Ci,[n("p",{text:"12",font:"bold",style:K({color:t(J)(e.gem.quality)})},_(e.gem.name),5),e.gem.sum>0?(i(),m("p",Ti," Hiện có: "+_(e.gem.sum),1)):S("",!0)])])]),n("div",qi,[n("div",Bi,[Si,T(" "+_(t(Be)[e.gem.slot]),1)]),n("div",Oi,[Pi,T(" "+_(e.gem.rateOnLevel)+"% ",1)]),n("div",Ii,[Ei,n("span",{style:K({color:t(J)(e.gem.quality)})},_(t(l)),5)]),n("div",Ai,[Ui,n("div",zi,[v(c,{gem:e.gem},null,8,["gem"])])]),v(f,{quality:e.gem.quality,"gem-id":e.gem.gemId},null,8,["quality","gem-id"]),ji,v(y,{"sell-action":e.sellAction,"select-action":e.selectAction,"merge-action":e.mergeGem,gem:e.gem},null,8,["sell-action","select-action","merge-action","gem"])])])):S("",!0)}}}),tt=U({__name:"Name",props:{quality:null},setup(e){return(a,s)=>(i(),m("div",{class:"text-10",style:K({color:t(J)(e.quality)})},[we(a.$slots,"default")],4))}}),Ri={},Ni={text:"primary 8"};function Di(e,a){return i(),m("div",Ni,[we(e.$slots,"default")])}const nt=Qe(Ri,[["render",Di]]),Li={},Mi={m:"y-1",text:"primary 8"};function Vi(e,a){return i(),m("div",Mi,[we(e.$slots,"default"),T(" Tiên duyên ")])}const ot=Qe(Li,[["render",Vi]]),Hi={class:"px-6 pt-2 overflow-auto scrollbar-hide"},Fi={class:"grid grid-cols-2 gap-2"},Gi=["onClick"],Ki={class:"flex gap-2"},Wi={class:"relative w-12 h-12"},Yi={class:"absolute bg-[#00000040] text-8 font-bold text-white bottom-1 right-1 px-1 rounded-2xl text-yellow-300"},Qi=["onClick"],Ji=U({__name:"Gems",props:{gems:null},emits:["buy"],setup(e,{emit:a}){const s=q(!1),o=q({}),l=d=>{o.value=d.record,s.value=!0},r=d=>{qe({title:"Nhắc nhở",message:`Bạn có chắc muốn mua ${d.record.name}`,confirmButtonText:"Chắc chắn",cancelButtonText:"Không chắc",dialogClass:"!bg-[#00000040] text-white border border-white/10 italic",confirmButtonColor:"#FFF",confirmButtonTextColor:"#333",cancelButtonTextColor:"#d2d2d2",onConfirm:async()=>{try{const u=await $fetch("/api/market/buy",{method:"POST",body:{_id:d._id,name:d.record.name}});N(u.message,2e3),u.success&&a("buy")}catch(u){N(u.statusMessage,2e3)}}})};return(d,u)=>{const c=zt,f=oe,y=xe,b=tt,p=nt,g=ot;return i(),m(C,null,[v(f,{show:t(s),"onUpdate:show":u[0]||(u[0]=h=>Z(s)?s.value=h:null),position:"center"},{default:x(()=>[v(c,{gem:t(o),target:"preview"},null,8,["gem"])]),_:1},8,["show"]),n("div",Hi,[n("div",Fi,[(i(!0),m(C,null,R(e.gems,h=>{var w,k,B,$,E;return i(),m("div",{key:h._id,class:"rounded p-2 relative flex flex-col gap-2",style:K({border:`1px solid ${t(J)((w=h==null?void 0:h.record)==null?void 0:w.quality)}`}),onClick:z(j=>l(h),["stop"])},[n("div",Ki,[n("div",Wi,[v(y,{format:"webp",src:`/quality_bg/iconbg_${(k=h==null?void 0:h.record)==null?void 0:k.quality}.png`,class:"absolute top-0"},null,8,["src"]),v(y,{format:"webp",src:`/gem/${(B=h==null?void 0:h.record)==null?void 0:B.gemId}.png`,class:"absolute transform-center w-[80%] h-[80%] rounded-full object-cover"},null,8,["src"]),n("div",Yi,_(($=h==null?void 0:h.record)==null?void 0:$.sum),1)]),n("div",null,[v(b,{quality:(E=h==null?void 0:h.record)==null?void 0:E.quality},{default:x(()=>{var j;return[T(_((j=h==null?void 0:h.record)==null?void 0:j.name),1)]}),_:2},1032,["quality"]),v(p,null,{default:x(()=>{var j;return[T(" (NB: "+_((j=h.player)==null?void 0:j.name)+") ",1)]}),_:2},1024),v(g,null,{default:x(()=>[T(_(h.price),1)]),_:2},1024)])]),n("button",{class:"px-2 py-[2px] shadow rounded text-10 font-semibold !text-white bg-[#841919] italic",onClick:z(j=>r(h),["stop"])}," Mua ",8,Qi)],12,Gi)}),128))])])],64)}}}),Xi={class:"p-4"},Zi={class:"text-center my-4"},er={class:"mb-4"},tr={text:"left",m:"t-2"},nr={class:"text-center"},jt=U({__name:"Detail",props:{item:null,sellAction:{type:Boolean}},emits:["refresh"],setup(e,{emit:a}){const s=e,{sid:o,fetchPlayer:l}=Y(),r=q(!1),d=q({price:0,quantity:0}),u=async()=>{var c;try{const f=await $fetch("/api/bag/use",{method:"POST",body:{sid:o,itemId:(c=s.item)==null?void 0:c.itemId,kind:s.item.props.kind,quantity:1}});N(f.statusMessage,2e3),a("refresh"),l()}catch(f){N(f.statusMessage)}};return(c,f)=>{var g,h;const y=et,b=Oe,p=oe;return i(),m(C,null,[v(p,{show:t(r),"onUpdate:show":f[2]||(f[2]=w=>Z(r)?r.value=w:null),position:"bottom"},{default:x(()=>[n("div",Xi,[v(y,{modelValue:t(d).price,"onUpdate:modelValue":f[0]||(f[0]=w=>t(d).price=w),type:"number",placeholder:"Nhập giá bán"},null,8,["modelValue"]),v(y,{modelValue:t(d).quantity,"onUpdate:modelValue":f[1]||(f[1]=w=>t(d).quantity=w),type:"number",placeholder:"Nhập số lượng"},null,8,["modelValue"])]),n("div",Zi,[v(b,{class:"!text-[#333] font-medium mx-2",size:"small",onClick:z(c.sell,["stop"])},{default:x(()=>[T(" Treo bán ")]),_:1},8,["onClick"])])]),_:1},8,["show"]),n("div",{text:"10",bg:"primary",border:"rounded",p:"2",w:"50",m:"auto",style:K({border:`1px solid ${t(J)((g=e.item.props)==null?void 0:g.quality)}`})},[n("div",er,[n("div",{text:"12 left",font:"bold",style:K({color:t(J)((h=e.item.props)==null?void 0:h.quality)})},_(e.item.props.name),5),n("div",tr,_(e.item.props.note),1)]),n("div",nr,[e.item.props.kind===3?(i(),I(b,{key:0,class:"mb-2 !text-[#333] font-semibold italic",size:"mini",onClick:z(u,["stop"])},{default:x(()=>[T(" Sử dụng ")]),_:1},8,["onClick"])):S("",!0)])],4)],64)}}}),or={},sr={text:"8"};function lr(e,a){return i(),m("span",sr,[T(" SL: "),we(e.$slots,"default")])}const ar=Qe(or,[["render",lr]]),ir={class:"overflow-auto scrollbar-hide px-6 pt-4"},rr={class:"grid grid-cols-3 gap-2 text-10"},cr=["onClick"],ur={flex:"~ ",text:"primary 8",m:"b-1",justify:"between",align:"items-center"},dr={class:"text-center"},pr=["onClick"],_r=U({__name:"Items",props:{items:null},emits:["buy"],setup(e,{emit:a}){const s=q(!1),o=q({}),l=d=>{o.value=d,s.value=!0},r=d=>{qe({title:"Nhắc nhở",message:`Bạn có chắc muốn mua ${d.props.name}`,confirmButtonText:"Chắc chắn",cancelButtonText:"Không chắc",closeOnClickOverlay:!1,dialogClass:"!bg-[#00000040] text-white border border-white/10 italic",confirmButtonColor:"#FFF",confirmButtonTextColor:"#333",cancelButtonTextColor:"#d2d2d2",onConfirm:async()=>{try{const u=await $fetch("/api/market/buy",{method:"POST",body:{_id:d._id,name:d.props.name}});N(u.message,2e3),u.success&&a("buy")}catch(u){N(u.statusMessage,2e3)}}})};return(d,u)=>{const c=jt,f=oe,y=tt,b=nt,p=ot,g=ar;return i(),m(C,null,[v(f,{show:t(s),"onUpdate:show":u[0]||(u[0]=h=>Z(s)?s.value=h:null),position:"center"},{default:x(()=>[v(c,{item:t(o)},null,8,["item"])]),_:1},8,["show"]),n("div",ir,[n("div",rr,[(i(!0),m(C,null,R(e.items,h=>{var w,k;return i(),m("div",{key:h._id,class:"rounded p-2",style:K({border:`1px solid ${t(J)((w=h.props)==null?void 0:w.quality)}`}),onClick:z(B=>l(h),["stop"])},[v(y,{quality:(k=h.props)==null?void 0:k.quality},{default:x(()=>[T(_(h.props.name),1)]),_:2},1032,["quality"]),v(b,null,{default:x(()=>[T(" (NB: "+_(h.player.name)+") ",1)]),_:2},1024),n("div",ur,[v(p,null,{default:x(()=>[T(_(h.price),1)]),_:2},1024),v(g,null,{default:x(()=>[T(_(h.record.sum),1)]),_:2},1024)]),n("div",dr,[n("button",{class:"px-2 py-[2px] rounded text-10 font-semibold text-white bg-[#841919] italic w-full",onClick:z(B=>r(h),["stop"])}," Mua ",8,pr)])],12,cr)}),128))])])],64)}}}),mr={class:"overflow-auto scrollbar-hide px-6 pt-4"},hr={class:"grid grid-cols-3 gap-2"},fr=["onClick"],gr={class:"text-center"},vr=["onClick"],yr=U({__name:"Equipments",props:{equipments:null},emits:["buy"],setup(e,{emit:a}){const s=q(!1),o=q({}),l=d=>{o.value=d.record,s.value=!0},r=d=>{qe({title:"Nhắc nhở",message:`Bạn có chắc muốn mua ${d.record.name}`,confirmButtonText:"Chắc chắn",cancelButtonText:"Không chắc",dialogClass:"!bg-[#00000040] text-white border border-white/10 italic",confirmButtonColor:"#FFF",confirmButtonTextColor:"#333",cancelButtonTextColor:"#d2d2d2",onConfirm:async()=>{try{const u=await $fetch("/api/market/buy",{method:"POST",body:{_id:d._id,name:d.record.name}});N(u.message,2e3),u.success&&a("buy")}catch(u){N(u.statusMessage,2e3)}}})};return(d,u)=>{const c=je,f=oe,y=tt,b=nt,p=ot;return i(),m(C,null,[v(f,{show:t(s),"onUpdate:show":u[0]||(u[0]=g=>Z(s)?s.value=g:null),position:"center"},{default:x(()=>[v(c,{equipment:t(o)},null,8,["equipment"])]),_:1},8,["show"]),n("div",mr,[n("div",hr,[(i(!0),m(C,null,R(e.equipments,g=>{var h,w;return i(),m("div",{key:g._id,class:"rounded p-2",style:K({border:`1px solid ${t(J)((h=g==null?void 0:g.record)==null?void 0:h.quality)}`}),onClick:z(k=>l(g),["stop"])},[v(y,{quality:(w=g==null?void 0:g.record)==null?void 0:w.quality},{default:x(()=>{var k,B;return[T(_(t(Ae)[(k=g==null?void 0:g.record)==null?void 0:k.quality])+" - "+_((B=g==null?void 0:g.record)==null?void 0:B.name),1)]}),_:2},1032,["quality"]),v(b,null,{default:x(()=>[T(" (NB: "+_(g.player.name)+") ",1)]),_:2},1024),v(p,null,{default:x(()=>[T(_(g.price),1)]),_:2},1024),n("div",gr,[n("button",{class:"px-2 py-[2px] shadow rounded text-10 font-semibold !text-white bg-[#841919] italic w-full",onClick:z(k=>r(g),["stop"])}," Mua ",8,vr)])],12,fr)}),128))])])],64)}}}),br={class:"h-full"},wr={class:"px-4"},xr=["onClick"],kr={key:0,h:"50",w:"50"},$r=U({__name:"index",emits:["close"],setup(e,{emit:a}){se(Y()),new Date().getTime(),re();const s=q("market"),o=q("equipment"),l=[{key:"item",name:"Vật phẩm"},{key:"equipment",name:"Trang bị"},{key:"gem",name:"Đá hồn"}],{data:r,pending:d,refresh:u}=ze("/api/market","$Kmc9wfSqLB"),c=A(()=>r.value?r.value.filter(g=>g.type===o.value):[]),f=()=>{u()};A(()=>s.value==="market");const y=A(()=>o.value==="gem"),b=A(()=>o.value==="item"),p=A(()=>o.value==="equipment");return(g,h)=>{const w=Ji,k=_r,B=yr,$=ke;return i(),m("div",br,[n("div",wr,[(i(),m(C,null,R(l,E=>n("button",{key:E.key,class:G({"!opacity-100":E.key===t(o)}),transition:"~ opacity duration-800",m:"x-2",w:"16",h:"8",font:"italic bold leading-3",opacity:"40",border:"rounded 1 white/40",text:"primary",onClick:z(j=>o.value=E.key,["stop"])},_(E.name),11,xr)),64))]),v($,{loading:t(d),description:t(le)[Math.round(t(Se)(0,t(le).length))],size:"mini",color:"#ffffff"},{default:x(()=>[t(d)?(i(),m("div",kr)):S("",!0),t(y)?(i(),I(w,{key:1,gems:t(c),onBuy:f},null,8,["gems"])):S("",!0),t(b)?(i(),I(k,{key:2,items:t(c),onBuy:f},null,8,["items"])):S("",!0),t(p)?(i(),I(B,{key:3,equipments:t(c),onBuy:f},null,8,["equipments"])):S("",!0)]),_:1},8,["loading","description"])])}}}),Cr={text:"10",flex:"~ ",p:"r-2",border:"r-2 white/10",w:"[45%]"},Tr={text:"8"},qr={text:"8"},Br={text:"8"},Sr={text:"8"},Or=U({__name:"ShortView",setup(e){const{attribute:a,playerInfo:s}=se(Y()),o=ne("togglePlayerInfo");return(l,r)=>{var d,u,c;return i(),m("div",Cr,[n("div",null,[n("button",{m:"x-2",w:"9",p:"y-2",font:"leading-3 semibold",border:"rounded 1 white/40",onClick:r[0]||(r[0]=z(f=>o.value=!0,["stop"]))}," Chi tiết nhân vật ")]),n("div",null,[n("div",null,[T("Tiên lực: "),n("span",Tr,_(t(me)(t(s).power)),1)]),n("div",null,[T("Công kích: "),n("span",qr,_((d=t(a))==null?void 0:d.damage),1)]),n("div",null,[T("HP: "),n("span",Br,_((u=t(a))==null?void 0:u.hp),1)]),n("div",null,[T("Thủ: "),n("span",Sr,_((c=t(a))==null?void 0:c.def),1)])])])}}}),Pr={text:"10",class:"w-70 border border-white/20 bg-primary p-4"},Ir=n("div",{class:"whitespace-nowrap"}," Thuộc tính tăng ",-1),Er={class:"flex items-center justify-between leading-5"},Ar={class:"flex flex-col"},Ur={class:"flex flex-col text-green-400"},zr={text:"10",class:"flex ml-2"},jr={class:"text-8"},Rr={class:"text-8"},Nr=n("div",null,"Tổn thất: 0%",-1),Dr=["onClick"],Lr={class:"text-center"},Mr={__name:"Tupo",setup(e){const{upgrade:a,playerInfo:s}=se(Y()),{loadPlayer:o}=Y();re();const l=q({});q(!1);const r=q(),d=q(),u=q(!1),c=A(()=>{var y,b;return Ge((y=s.value)==null?void 0:y.level,((b=s.value)==null?void 0:b.level)+1)}),f=async()=>{var y,b,p,g;try{l.value=await $fetch("/api/breakthrough",{method:"POST",body:{sid:s.value.sid}}),(y=l.value)!=null&&y.playerBefore&&o((b=l.value)==null?void 0:b.playerBefore),l.value.status&&P(u,!0),N(l.value.message,3e3),P(r,(p=l.value)==null?void 0:p.playerBefore),P(d,(g=l.value)==null?void 0:g.playerAfter)}catch(h){N(h.message)}};return(y,b)=>{var h,w,k,B,$,E,j,M;const p=_e,g=oe;return i(),m(C,null,[v(g,{show:t(u),"onUpdate:show":b[0]||(b[0]=V=>Z(u)?u.value=V:null)},{default:x(()=>{var V,O,X,Q,L,H,W,D,ee,ue,de,te;return[n("div",Pr,[v(p,{class:"pb-4"},{default:x(()=>[Ir]),_:1}),n("div",Er,[n("div",Ar,[n("span",null," Công kích "+_((O=(V=t(d))==null?void 0:V.attribute)==null?void 0:O.damage),1),n("span",null," HP "+_((Q=(X=t(d))==null?void 0:X.attribute)==null?void 0:Q.hp),1),n("span",null," Thủ "+_((H=(L=t(d))==null?void 0:L.attribute)==null?void 0:H.def),1)]),n("div",Ur,[n("span",null," Công kích "+_((D=(W=t(r))==null?void 0:W.attribute)==null?void 0:D.damage),1),n("span",null," HP "+_((ue=(ee=t(r))==null?void 0:ee.attribute)==null?void 0:ue.hp),1),n("span",null," Thủ "+_((te=(de=t(r))==null?void 0:de.attribute)==null?void 0:te.def),1)])])])]}),_:1},8,["show"]),n("div",zr,[n("div",null,[n("div",null,[T(" Tiêu phí tu vi: "),n("span",jr,_(t(me)((h=t(s))==null?void 0:h.exp))+"/"+_(t(me)((w=t(s))==null?void 0:w.expLimited)),1)]),n("div",null,[T("Tiêu hao tiền tiên: "),n("span",Rr,_(t(me)((B=(k=t(a))==null?void 0:k.condition)==null?void 0:B.needGold)),1)]),n("div",null,"Đột phá thành công: "+_((E=($=t(a))==null?void 0:$.condition)==null?void 0:E.rate)+"%",1),Nr]),n("div",null,[n("button",{class:"mx-2 h-10 w-10 shadow rounded text-12 font-semibold border-1 text-primary rounded-full border-white/40 bg-button-menu",onClick:z(f,["stop"])}," Đột phá ",8,Dr)])]),n("div",Lr," Đột phá "+_((j=t(c))==null?void 0:j.levelTitle)+" "+_((M=t(c))==null?void 0:M.floor),1)],64)}}},Vr={text:"8",m:"b-1"},Hr=U({__name:"Item",props:{equipment:null},emits:["onchangeEquip"],setup(e,{emit:a}){const s=e,o=ie({show:!1}),l=A(()=>Ge(s.equipment.level,s.equipment.level+1)),r=()=>{o.show=!0},d=()=>{o.show=!1,a("onchangeEquip")};return(u,c)=>{var p;const f=je,y=oe,b=Le;return i(),m(C,null,[v(y,{show:t(o).show,"onUpdate:show":c[0]||(c[0]=g=>t(o).show=g),position:"center"},{default:x(()=>[v(f,{equipment:e.equipment,action:!0,"sell-action":!0,onRefresh:d,onChangeEquip:d},null,8,["equipment"])]),_:1},8,["show"]),n("div",{border:"rounded",p:"2",style:K({border:`1px solid ${t(J)(e.equipment.quality)}`}),onClick:c[1]||(c[1]=z(g=>r(),["stop"]))},[n("p",Vr,_(t(Be)[e.equipment.slot])+" ("+_(t(l).levelTitle)+" "+_(t(l).floor)+") ",1),n("div",{text:"8",font:"semibold",style:K({color:t(J)(e.equipment.quality)})},_(`${t(Ae)[e.equipment.quality??1]} -`)+" "+_((p=e.equipment)==null?void 0:p.name)+" (+"+_(e.equipment.enhance)+") ",5),n("div",null,[(i(!0),m(C,null,R(e.equipment.star,g=>(i(),I(b,{key:g,name:"material-symbols:star",size:"10"}))),128))])],4)],64)}}}),Fr={key:0,h:"50",w:"100"},Gr={key:1,class:"grid-cols-3 grid gap-2"},Kr=U({__name:"index",setup(e){const{data:a,pending:s,refresh:o}=ze("/api/bag/equipments","$hiLmLrOEJk"),l=q(!1),r=()=>{o(),P(l,!1)};return(d,u)=>{const c=Hr,f=ke;return i(),I(f,{loading:t(s),description:t(le)[Math.round(t(Se)(0,t(le).length))],size:"mini",color:"#ffffff"},{default:x(()=>[t(s)?(i(),m("div",Fr)):(i(),m("div",Gr,[(i(!0),m(C,null,R(t(a),y=>(i(),I(c,{key:y==null?void 0:y._id,equipment:y,onOnchangeEquip:r},null,8,["equipment"]))),128))]))]),_:1},8,["loading","description"])}}}),Wr={grid:"~ cols-3",gap:"2"},Yr={key:0,h:"50",w:"100"},Qr=["onClick"],Jr={p:"t-2",class:"line-clamp-2"},Xr={p:"t-2",text:"8 right"},Zr=U({__name:"index",setup(e){const{data:a,pending:s,refresh:o}=ze("/api/bag/items","$Tv4ZkuwDBa"),l=q(),r=q(!1),d=c=>{P(l,c),P(r,!0)},u=()=>{o(),P(r,!1)};return(c,f)=>{const y=jt,b=oe,p=ke;return i(),m(C,null,[v(b,{show:t(r),"onUpdate:show":f[0]||(f[0]=g=>Z(r)?r.value=g:null),position:"center"},{default:x(()=>[v(y,{item:t(l),"sell-action":!0,onRefresh:u},null,8,["item"])]),_:1},8,["show"]),v(p,{loading:t(s),description:t(le)[Math.round(t(Se)(0,t(le).length))],size:"mini",color:"#ffffff"},{default:x(()=>[n("section",Wr,[t(s)?(i(),m("div",Yr)):(i(!0),m(C,{key:1},R(t(a),g=>(i(),m("div",{key:g.id,text:"10",border:"rounded",p:"2",style:K({border:`1px solid ${t(J)(g.props.quality)}`}),onClick:z(h=>d(g),["stop"])},[n("div",{font:"bold",class:"line-clamp-1",style:K({color:t(J)(g.props.quality)})},_(g==null?void 0:g.props.name),5),n("div",Jr,_(g==null?void 0:g.props.note),1),n("div",Xr," SL: "+_(g==null?void 0:g.sum),1)],12,Qr))),128))])]),_:1},8,["loading","description"])],64)}}}),ec=He(()=>Fe(()=>import("./Item.74da6ea2.js"),["./Item.74da6ea2.js","./Line.938dcc9e.js","./entry.303ba4a8.js","./entry.aa262684.css","./_plugin-vue_export-helper.c27b6911.js","./index.040b5bdf.js","./usePlayer.4eda164d.js","./useMessage.4ef409fc.js","./ButtonSfc.676ad373.js","./ButtonSfc.be493fd9.css","./Icon.6e08e514.js","./Icon.294af607.css","./InputSfc.145169a3.js","./InputSfc.76ecac0e.css","./useBattleRound.ae7aabef.js"],import.meta.url).then(e=>e.default||e)),tc={key:0,h:"50",w:"100"},nc={key:1,grid:"~ cols-6",gap:"2"},oc=U({__name:"index",setup(e){const{data:a,pending:s,refresh:o}=ze("/api/bag/gems","$e8Rp6RY841"),l=()=>{o()};return(r,d)=>{const u=ec,c=ke;return i(),I(c,{loading:t(s),description:t(le)[Math.round(t(Se)(0,t(le).length))],size:"mini",color:"#ffffff"},{default:x(()=>[t(s)?(i(),m("div",tc)):(i(),m("div",nc,[(i(!0),m(C,null,R(t(a),f=>(i(),I(u,{key:f._id,gem:f,onOnmerge:l},null,8,["gem"]))),128))]))]),_:1},8,["loading","description"])}}}),sc={pos:"relative",h:"full",class:"flex-center"},lc={pos:"absolute",top:"0",flex:"~ ",align:"items-center",w:"full",p:"2"},ac=["onClick"],ic={pos:"absolute",top:"10",w:"full",flex:"~ col",align:"items-center",p:"4",overflow:"auto",class:"h-[calc(100%_-_47px)]"},rc=U({__name:"index",setup(e){const a=q("item"),s=[{key:"item",name:"Vật Phẩm"},{key:"equip",name:"Trang Bị"},{key:"gem",name:"Đá Hồn"}];return(o,l)=>{const r=Kr,d=Zr,u=oc;return i(),m("section",sc,[n("div",lc,[(i(),m(C,null,R(s,c=>n("button",{key:c.key,class:G({"!opacity-100":t(a)===c.key}),transition:"~ opacity duration-700",m:"x-2",w:"16",h:"8",font:"leading-3 italic bold",border:"1 white/40 rounded",text:"primary",opacity:"40",onClick:z(f=>a.value=c.key,["stop"])},_(c.name),11,ac)),64))]),n("div",ic,[t(a)==="equip"?(i(),I(r,{key:0})):S("",!0),t(a)==="item"?(i(),I(d,{key:1})):S("",!0),t(a)==="gem"?(i(),I(u,{key:2})):S("",!0)])])}}}),cc={key:0,h:"50",w:"100"},uc={key:1,p:"x-4"},dc={text:"center 12",m:"y-2"},pc={key:0,text:"10"},_c={p:"x-1"},mc={class:"grid grid-cols-2 gap-2 text-10"},hc=["onClick"],fc={class:"flex gap-2"},gc={pos:"relative",h:"12",w:"[40%]"},vc={class:"absolute bg-[#00000040] text-8 font-bold text-white bottom-1 right-1 px-1 rounded-2xl text-yellow-300"},yc={text:"center",w:"full",p:"t-2"},bc=["onClick"],wc={key:1,text:"center",flex:"~ ",align:"items-center",justify:"center",h:"50"},xc=U({__name:"index",setup(e){var p;const{sid:a}=Y(),{$io:s}=re(),o=q(!1),l=q({}),{data:r,pending:d,refresh:u}=ze("/api/auction","$6wQGT4FOCn"),c=new Date().getTime(),f=q(((((p=r.value)==null?void 0:p.endTime)??0)-c)/1e3);Ze(()=>{console.log("endTime",f.value),s.on("auction-response",()=>{u()}),setInterval(()=>{f.value-=1},1e3)}),Te(()=>{s.off("auction-response")});const y=g=>{s.emit("auction",g,a)},b=g=>{l.value={gemId:g.id,...g},o.value=!0};return(g,h)=>{const w=zt,k=oe,B=_e,$=xe,E=tt,j=nt,M=ot,V=ke;return i(),m(C,null,[v(k,{show:t(o),"onUpdate:show":h[0]||(h[0]=O=>Z(o)?o.value=O:null),position:"center"},{default:x(()=>[v(w,{gem:t(l),target:"preview"},null,8,["gem"])]),_:1},8,["show"]),v(V,{loading:t(d),description:t(le)[Math.round(t(Se)(0,t(le).length))],size:"mini",color:"#ffffff"},{default:x(()=>[t(d)?(i(),m("div",cc)):(i(),m("div",uc,[t(r)?(i(),m(C,{key:0},[n("div",dc,[v(B,null,{default:x(()=>[T(_(t(r).name),1)]),_:1}),t(f)?(i(),m("div",pc,[T(" Kết thúc "),n("span",_c,_(t(gt)(t(f)).minutes)+"phút",1),n("span",null,_(t(gt)(t(f)).seconds)+"s",1)])):S("",!0)]),n("div",mc,[(i(!0),m(C,null,R(t(r).auctionItems,O=>{var X,Q,L,H;return i(),m("div",{key:O._id,class:"rounded p-2",style:K({border:`1px solid ${t(J)((X=O.gem[0])==null?void 0:X.quality)}`}),onClick:z(W=>b(O.gem[0]),["stop"])},[n("div",fc,[n("div",gc,[v($,{format:"webp",src:`/quality_bg/iconbg_${(Q=O==null?void 0:O.gem[0])==null?void 0:Q.quality}.png`,class:"absolute top-0"},null,8,["src"]),v($,{format:"webp",src:`/gem/${(L=O==null?void 0:O.gem[0])==null?void 0:L.id}.png`,class:"absolute transform-center w-10 h-10 rounded-full object-cover"},null,8,["src"]),n("div",vc,_(O==null?void 0:O.quantity),1)]),n("div",null,[v(E,{quality:O==null?void 0:O.gem[0].quality,class:"line-clamp-1"},{default:x(()=>{var W;return[T(_((W=O==null?void 0:O.gem[0])==null?void 0:W.name),1)]}),_:2},1032,["quality"]),((H=O.player)==null?void 0:H.length)>0?(i(),I(j,{key:0,class:"line-clamp-2"},{default:x(()=>[T(" (Thuộc về: "+_(O.player[0].name)+") ",1)]),_:2},1024)):(i(),I(j,{key:1},{default:x(()=>[T(" (Thuộc về: Hiện đang trống) ")]),_:1})),v(M,null,{default:x(()=>[T(_(O.price),1)]),_:2},1024)])]),n("div",yc,[n("button",{w:"full",class:"px-2 py-[2px] shadow rounded text-10 font-semibold !text-white bg-[#841919] italic",onClick:z(W=>y(O._id),["stop"])}," Đấu giá ",8,bc)])],12,hc)}),128))])],64)):(i(),m("div",wc," Tạm thời chưa có đấu giá nào đang được mở "))]))]),_:1},8,["loading","description"])],64)}}}),kc={flex:"~ "},$c={p:"1"},Cc={text:"12",font:"bold"},Tc={text:"10"},qc={text:"10"},Bc={key:0,text:"10"},Sc={key:1,text:"10"},Oc={m:"t-2",pos:"absolute",right:"2",top:"[20%]"},Pc=U({__name:"Item",props:{pos:null,rank:null,reachLimit:{type:Boolean}},setup(e){const a=e,{sid:s}=Y(),{$io:o}=re(),l=d=>{a.reachLimit||(ne("isArena").value=!0,o.emit("arena:pvp:solo",{attackerSid:s,defenderSid:d,pos:a.pos}))},r=A(()=>{var d;return Ge(a==null?void 0:a.rank.level,((d=a.rank)==null?void 0:d.level)+1)});return(d,u)=>{var f,y,b,p,g,h;const c=Oe;return i(),m("section",kc,[n("div",$c,[n("div",Cc,[T(_(e.rank.name)+" - ",1),n("span",Tc,_(t(r).levelTitle)+" "+_(t(r).floor),1)]),n("div",qc," Tiên lực: "+_(t(me)(e.rank.power)),1),(b=(y=(f=e.rank)==null?void 0:f.arenas)==null?void 0:y.tienDau)!=null&&b.pos?(i(),m("div",Bc," Xếp hạng: "+_((h=(g=(p=e.rank)==null?void 0:p.arenas)==null?void 0:g.tienDau)==null?void 0:h.pos),1)):(i(),m("div",Sc," Xếp hạng: Chưa có "))]),n("div",Oc,[t(s)!==e.rank.sid?(i(),I(c,{key:0,disabled:e.reachLimit,class:"!text-[#333]",size:"mini",font:"semibold italic",onClick:u[0]||(u[0]=z(w=>l(e.rank.sid),["stop"]))},{default:x(()=>[T(" Khiêu chiến ")]),_:1},8,["disabled"])):S("",!0)])])}}}),Ic={m:"x-4 t-2",flex:"~ ",justify:"between"},Ec=U({__name:"index",setup(e){const{sid:a,playerInfo:s}=se(Y()),o=ne("refreshArena"),{data:l,pending:r,refresh:d}=ze("/api/arena/tienDau","$T2x1u6gWs8"),u=ie({sid:"",toggle:!1});be(o,()=>{d()});const c=y=>{y&&(u.toggle=!0,u.sid=y)},f=A(()=>{var y,b;return((y=l.value.reachLimit)==null?void 0:y.remaining)>=((b=l.value.reachLimit)==null?void 0:b.maximum)});return(y,b)=>{const p=Pc,g=ke;return i(),m(C,null,[v(c,{sid:t(u).sid},null,8,["sid"]),v(g,{loading:t(r),size:"mini",description:t(le)[Math.round(t(Se)(0,t(le).length))],color:"#ffffff"},{default:x(()=>{var h,w;return[n("div",Ic,[n("div",null,"Điểm Tiên Đấu: "+_(t(s).arenas.tienDau.score??0),1),n("div",null,"Lượt: "+_((h=t(l).reachLimit)==null?void 0:h.remaining)+"/"+_((w=t(l).reachLimit)==null?void 0:w.maximum),1)]),(i(!0),m(C,null,R(t(l).data,(k,B)=>(i(),m("div",{key:k._id,pos:"relative",border:"1 white/40 rounded",text:"primary",p:"2",m:"x-4 y-2",class:G({"!border-green-400":t(a)===k.sid})},[v(p,{rank:k,pos:B+1,"reach-limit":t(f),onClick:z($=>c(k.sid),["stop"])},null,8,["rank","pos","reach-limit","onClick"])],2))),128))]}),_:1},8,["loading","description"])],64)}}}),Ac={p:"2"},Uc=["onClick"],zc={class:"h-[calc(100%_-_47px)] overflow-scroll"},jc=U({__name:"index",setup(e){const a=q("tien_dau"),s=[{key:"tien_dau",name:"Tiên đấu"},{key:"auction",name:"Đấu giá"}],o=A(()=>a.value==="auction"),l=A(()=>a.value==="tien_dau");return(r,d)=>{const u=xc,c=Ec;return i(),m(C,null,[n("div",Ac,[(i(),m(C,null,R(s,f=>n("button",{key:f.key,class:G({"!opacity-100":f.key===t(a)}),transition:"~ opacity duration-800",m:"x-2",w:"16",h:"8",font:"italic bold leading-3",opacity:"40",border:"rounded 1 white/40",text:"primary",onClick:z(y=>a.value=f.key,["stop"])},_(f.name),11,Uc)),64))]),n("div",zc,[t(o)?(i(),I(u,{key:0})):S("",!0),t(l)?(i(),I(c,{key:1})):S("",!0)])],64)}}}),Rc={w:"[90vw]","max-w":"[60vh]",bg:"primary",grid:"~ cols-2",gap:"4",p:"5",border:"rounded 1 white/40"},Nc=["onClick"],Dc={class:"h-full"},Lc={flex:"~",justify:"around",w:"full",pos:"absolute",top:"[10px]",p:"l-1",text:"white"},Mc=["onClick"],Vc={class:"absolute top-16 text-10 text-[#eaeced] italic w-full h-[calc(100%_-_115px)]"},Hc={class:"flex-center"},Fc={class:"flex w-full justify-around"},Gc=U({__name:"Bottom",setup(e){se(Y());const{leftSlots:a,rightSlots:s}=se(Ye()),o=ne("togglePlayerInfo"),l=ne("toggleAuction"),r=ne("toggleStore"),d=ne("toggleBag"),u=ne("toggleUpgrade"),c=ne("toggleUpStar"),f=ne("toggleUpRank"),y=ne("toggleUpGem"),b=ne("toggleBoss"),p=ie({showUpgrade:!1}),g=()=>{u.value=!0,fe()},h=()=>{b.value=!0,fe()},w=()=>{c.value=!0,fe()},k=()=>{f.value=!0,fe()},B=()=>{y.value=!0,fe()},$=()=>{p.showUpgrade=!0,fe()},E=()=>{l.value=!0,fe()},j=()=>{r.value=!0,fe()},M=()=>{d.value=!0,fe()},V=()=>{o.value=!0,fe()},O=q("character"),X=[{key:"character",name:"Nhân vât",fn:V},{key:"upgrade",name:"Nâng Cấp",fn:$},{key:"bag",name:"Túi",fn:M},{key:"market",name:"Chợ",fn:E},{key:"store",name:"Cửa Hàng",fn:j},{key:"activity",name:"Hoạt động",fn:j},{key:"boss",name:"Boss",fn:h}],Q=[{name:"Cường hoá",fn:g},{name:"Nâng sao",fn:w},{name:"Tăng bậc",fn:k},{name:"Đá hồn",fn:B}],L=A(()=>O.value==="market"),H=A(()=>O.value==="store"),W=A(()=>O.value==="character"),D=A(()=>O.value==="bag"),ee=A(()=>O.value==="boss"),ue=A(()=>O.value==="activity"),de=te=>{if(["upgrade"].includes(te)){$();return}P(O,te)};return(te,ve)=>{const Pe=oe,Me=si,F=$r,ce=_e,pe=Or,he=Mr,$e=Ot,Ie=rc,Ke=qt,Rt=jc;return i(),m(C,null,[v(Pe,{show:t(p).showUpgrade,"onUpdate:show":ve[0]||(ve[0]=ye=>t(p).showUpgrade=ye)},{default:x(()=>[n("div",Rc,[(i(),m(C,null,R(Q,ye=>n("div",{key:ye.name,text:"center italic 10 primary",m:"x-2",p:"x-2 y-2",transition:"~ opacity",border:"rounded 1 white/40",font:"bold",onClick:ye.fn},_(ye.name),9,Nc)),64))])]),_:1},8,["show"]),n("div",Dc,[n("div",Lc,[(i(),m(C,null,R(X,ye=>n("button",{key:ye.key,transition:"~ colors duration-800",m:"x-2",w:"10",h:"10",text:"12 primary",font:"italic semibold",border:"rounded-full 1 white/40",class:"bg-button-menu",onClick:z(Xu=>de(ye.key),["stop"])},[n("span",{class:G({"text-[#4add3b]":t(O)===ye.key})},_(ye.name),3)],8,Mc)),64))]),n("div",Vc,[t(H)?(i(),I(Me,{key:0})):S("",!0),t(L)?(i(),I(F,{key:1})):S("",!0),t(W)?(i(),m(C,{key:2},[v(ce,{class:"mb-4"},{default:x(()=>[T(" Thuộc tính nhân vật ")]),_:1}),n("div",Hc,[n("div",Fc,[v(pe),n("div",null,[v(he)])])]),v(ce,{class:"mt-4"},{default:x(()=>[T(" Thiết lập trang bị ")]),_:1}),v($e,{"left-slots":t(a),"right-slots":t(s)},null,8,["left-slots","right-slots"])],64)):S("",!0),t(D)?(i(),I(Ie,{key:3})):S("",!0),t(ee)?(i(),I(Ke,{key:4})):S("",!0),t(ue)?(i(),I(Rt,{key:5})):S("",!0)])])],64)}}}),Kc={key:0,bg:"primary",pos:"relative",text:"10 primary",font:"semibold",class:"border-box",h:"120"},Wc=U({__name:"Preview",props:{sid:null},setup(e){const a=e,s=ie({payload:{}}),o=q(a.sid);console.log("hdhdhdh"),Ze(async()=>{if(o.value)try{s.payload=await $fetch(`/api/player?sid=${o.value}`)}catch(h){console.error(h)}}),be(o,()=>{console.log("sid")});const l=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===1)}),r=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===2)}),d=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===3)}),u=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===4)}),c=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===5)}),f=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===6)}),y=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===7)}),b=A(()=>{var h;return(h=s.payload.equipments)==null?void 0:h.find(w=>w.slot===8)}),p=A(()=>[{no:1,slot:l.value},{no:2,slot:r.value},{no:3,slot:d.value},{no:4,slot:u.value}]),g=A(()=>[{no:5,slot:c.value},{no:6,slot:f.value},{no:7,slot:y.value},{no:8,slot:b.value}]);return(h,w)=>{const k=Pt;return i(),m(C,null,[T(" ddddd "),t(s).payload.player?(i(),m("div",Kc,[v(k,{name:t(s).payload.player.name,level:t(s).payload.player.level,"level-title":t(s).payload.player.levelTitle,floor:t(s).payload.player.floor,"class-role":t(s).payload.player.class,exp:t(s).payload.player.exp,"left-slots":t(p),"right-slots":t(g)},null,8,["name","level","level-title","floor","class-role","exp","left-slots","right-slots"])])):S("",!0)],64)}}}),Yc={class:"h-[50vh] mx-2 relative overflow-auto"},Qc={class:"py-2 text-left"},Jc=["onClick"],Xc=["onClick"],Zc={class:"text-left text-10 text-white"},eu={class:"absolute bottom-[-10px] right-0 bg-[#00000040] rounded-lg text-8 px-2 text-white"},tu={class:"flex-center p-4 pb-4"},nu=U({__name:"index",props:{contents:null},setup(e){const a=e,{$io:s}=re(),{playerInfo:o,sid:l}=Y(),r=ie({sid:"",toggle:!1}),d=q(""),u=q("general"),c=[{key:"general",name:"Cộng đồng"},{key:"system",name:"Hệ thống"}],f=A(()=>u.value==="system"?a.contents.filter(p=>p.type==="system"):a.contents),y=async p=>{p&&(r.toggle=!0,r.sid=p)},b=()=>{s.emit("send:chat",o==null?void 0:o.sid,o==null?void 0:o.name,d.value),P(d,"")};return(p,g)=>{const h=Wc,w=oe,k=et,B=Le;return i(),m(C,null,[v(w,{show:t(r).toggle,"onUpdate:show":g[0]||(g[0]=$=>t(r).toggle=$)},{default:x(()=>[v(h,{sid:t(r).sid},null,8,["sid"])]),_:1},8,["show"]),n("div",Yc,[n("section",Qc,[(i(),m(C,null,R(c,$=>n("button",{key:$.key,transition:"~ opacity duration-700",m:"x-2",w:"16",h:"6",font:"semibold",border:"1 white/40 rounded",text:"primary space-nowrap 8",opacity:"60",class:G({"!opacity-100":t(u)===$.key}),onClick:z(E=>u.value=$.key,["stop"])},_($.name),11,Jc)),64))]),(i(!0),m(C,null,R(t(f),($,E)=>(i(),m("section",{key:E,class:"relative mb-5 flex justify-start items-center rounded bg-primary m-2 p-3",onClick:z(j=>y($.sid),["stop"])},[n("div",{class:G(["text-[#6ce8d4] font-bold text-10 text-left mr-2 whitespace-nowrap",{"text-[#f44336]":$.type==="system"}])}," ["+_($.name)+"] ",3),n("div",Zc,_($.content),1),n("p",eu,_(t(wt)(new Date($.createdAt).getTime())),1)],8,Xc))),128))]),n("div",tu,[v(k,{modelValue:t(d),"onUpdate:modelValue":g[1]||(g[1]=$=>Z(d)?d.value=$:null),class:"mb-4",placeholder:"Nhập nội dung...","text-color":"#ffffff","focus-color":"#fff"},null,8,["modelValue"]),v(B,{class:"text-white",name:"ic:baseline-send",size:"25",onClick:b})])],64)}}}),ou={flex:"~ "},su={text:"space-nowrap",overflow:"scroll"},lu=U({__name:"ListItemHorizontal",props:{rewards:null},setup(e){return(a,s)=>(i(),m("div",ou,[n("div",su,[(i(!0),m(C,null,R(e.rewards,(o,l)=>(i(),m("span",{key:l,text:"underline 8",p:"r-1",style:K({color:t(J)(o.quality)})},_(o.name)+" x"+_(o.sum),5))),128))])]))}}),au={flex:"~ "},iu={text:"space-nowrap",overflow:"scroll"},ru=U({__name:"ListGemHorizontal",props:{rewards:null},setup(e){return(a,s)=>(i(),m("div",au,[n("div",iu,[(i(!0),m(C,null,R(e.rewards,(o,l)=>(i(),m("span",{key:l,text:"underline 8",p:"r-1",style:K({color:t(J)(o.quality)})},_(o.name)+" x1 ",5))),128))])]))}}),cu={flex:"~ "},uu={text:"space-nowrap",overflow:"scroll"},du=U({__name:"ListEquipmentHorizontal",props:{rewards:null},setup(e){return(a,s)=>(i(),m("div",cu,[n("div",uu,[(i(!0),m(C,null,R(e.rewards,(o,l)=>(i(),m("span",{key:l,text:"underline 8",p:"r-1",style:K({color:t(J)(o.quality)})},_(o.name)+" x1 ",5))),128))])]))}}),pu={p:"2",h:"full",overflow:"auto",class:"h-[calc(100%_-_100px)]"},_u=["onClick"],mu={flex:"~ col",align:"items-start",text:"[#b86f4e] normal"},hu={font:"bold"},fu={text:"10 white",class:"w-50"},gu={m:"t-2"},vu={pos:"absolute",right:"2",top:"5"},yu={pos:"absolute",bottom:"2",right:"2",text:"white 10 right"},bu=U({__name:"index",props:{mails:null},emits:["read"],setup(e,{emit:a}){const s=ie({mail:!1}),o=q({}),l=d=>{P(o,d),s.mail=!0},r=async d=>{if(d.isRead){N("Phần thưởng đã được nhận trước đó",2500);return}try{const u=await $fetch("/api/mail/take",{method:"POST",body:{_mailId:d._id}});N(u.message,2500),a("read")}catch(u){N(u.statusMessage)}};return(d,u)=>{const c=lu,f=ru,y=du,b=Oe;return i(),m("div",pu,[(i(!0),m(C,null,R(e.mails,p=>(i(),m("div",{key:p==null?void 0:p._id,flex:"~ ",pos:"relative",align:"items-center",border:"1 white/40 rounded",p:"2",m:"1",gap:"2",onClick:z(g=>l(p),["stop"])},[n("div",mu,[n("div",hu,_(p==null?void 0:p.title),1),n("div",fu,_(p.note),1),n("div",gu,[p.recordType==="item"?(i(),I(c,{key:0,rewards:p.records},null,8,["rewards"])):S("",!0),p.recordType==="gem"?(i(),I(f,{key:1,rewards:p.records},null,8,["rewards"])):S("",!0),p.recordType==="equipment"?(i(),I(y,{key:2,rewards:p.records},null,8,["rewards"])):S("",!0)]),n("div",vu,[v(b,{disabled:p.isRead,class:"!text-[#333] !px-4 w-20",size:"small",onClick:z(g=>r(p),["stop"])},{default:x(()=>[T(_(p.isRead?"Đã nhận":"Nhận"),1)]),_:2},1032,["disabled","onClick"])]),n("p",yu,_(t(wt)(new Date(p.createdAt).getTime())),1)])],8,_u))),128))])}}}),wu={m:"4",flex:"~",justify:"center",align:"items-center",gap:"4",p:"5"},xu=["onClick"],ku=U({__name:"index",setup(e){const{signOut:a}=Xt();ie({showSetting:!1});const s=[{key:"gift+code",name:"Giftcode",fn:()=>{console.log("giftcode")}},{key:"logout",name:"Đăng xuất",fn:()=>{a(),Zt("/login")}}];return(o,l)=>(i(),m("div",wu,[(i(),m(C,null,R(s,r=>n("div",{key:r.key,text:"center italic 10 primary",w:"50",m:"x-2 auto",p:"x-2 y-2",transition:"~ opacity",border:"rounded 1 white/40",font:"bold",onClick:z(r.fn,["stop"])},_(r.name),9,xu)),64))]))}}),$u={flex:"~ "},Cu={p:"1"},Tu={text:"12",font:"bold"},qu={text:"10"},Bu={text:"10"},Su={m:"t-2",pos:"absolute",right:"2",top:"[20%]"},Ou=n("span",{class:"var-button__content"}," Chi tiết ",-1),Pu=[Ou],Iu=U({__name:"Item",props:{rank:null},setup(e){const a=e,s=A(()=>{var o;return Ge(a==null?void 0:a.rank.level,((o=a.rank)==null?void 0:o.level)+1)});return(o,l)=>(i(),m("section",$u,[n("div",Cu,[n("div",Tu,[T(_(e.rank.name)+" - ",1),n("span",qu,_(t(s).levelTitle)+" "+_(t(s).floor),1)]),n("div",Bu," Tiên lực: "+_(t(me)(e.rank.power)),1)]),n("div",Su,[n("button",{class:"var-button var--box var-button--mini var--inline-flex var-button--default var-elevation--2 !text-[#333]",type:"button",font:"semibold italic",onClick:l[0]||(l[0]=z((...r)=>o.playerPreview&&o.playerPreview(...r),["stop"]))},Pu)])]))}}),Eu=U({__name:"index",setup(e){const{data:a,pending:s}=ze("/api/rank","$PEOG4WYZlt"),o=ie({sid:"",toggle:!1}),l=r=>{r&&(o.toggle=!0,o.sid=r)};return(r,d)=>{const u=Iu,c=ke;return i(),m(C,null,[v(l,{sid:t(o).sid},null,8,["sid"]),v(c,{loading:t(s),size:"mini",description:t(le)[Math.round(t(Se)(0,t(le).length))],color:"#ffffff"},{default:x(()=>[(i(!0),m(C,null,R(t(a),f=>(i(),m("div",{key:f._id,pos:"relative",border:"1 white/40 rounded",text:"primary",p:"2",m:"2"},[v(u,{rank:f,onClick:z(y=>l(f.sid),["stop"])},null,8,["rank","onClick"])]))),128))]),_:1},8,["loading","description"])],64)}}}),Au={class:"bg-[#000000] overflow-hidden max-w-[70vh] h-[70vh]",border:"t-1 green-300/40",m:"auto"},Uu={m:"x-2",p:"y-2 t-4"},zu=["onClick"],ju={class:"max-w-[70vh] h-12 bg-[#000000] text-12 w-full flex items-center justify-between gap-2 p-2 fixed bottom-0 border-t border-white/10"},Ru=n("span",{class:""},"Giao lưu",-1),Nu=[Ru],Du={class:"h-12 w-full overflow-auto text-left"},Lu={class:"text-white text-10"},Mu=U({__name:"index",setup(e){const{$io:a}=re(),{playerInfo:s,sid:o}=Y(),l=q([]),r=ie({exchange:!1,mail:!1}),d=q([]),u=q("chat"),c=[{key:"chat",name:"Trò chuyện"},{key:"mail",name:"Thư"},{key:"rank",name:"Tiên bảng"},{key:"friend",name:"Đạo hữu"},{key:"settings",name:"Thiết lập"}];a.emit("get:chat:request"),a.emit("get:mail",o),setInterval(()=>{a.emit("get:mail",o)},1e4),a.off("mail:response"),a.on("mail:response",b=>{P(l,b)}),a.on("get:chat:response",b=>{console.log("data",b),d.value.push(...b)}),a.on("send:chat:response",b=>{d.value.unshift(b),d.value.splice(d.value.length-1,1)}),a.on("chat:system",b=>{console.log(b),d.value.find(p=>b._id===p._id)||(d.value.unshift(b),d.value.splice(d.value.length-1,1))});const f=()=>{a.emit("get:mail",o)},y=A(()=>l.value.filter(b=>!b.isRead));return(b,p)=>{const g=nu,h=bu,w=ku,k=Eu,B=oe;return i(),m(C,null,[v(B,{show:t(r).exchange,"onUpdate:show":p[0]||(p[0]=$=>t(r).exchange=$),position:"bottom"},{default:x(()=>[n("section",Au,[n("div",Uu,[(i(),m(C,null,R(c,$=>n("button",{key:$.key,transition:"~ opacity duration-700",m:"x-2 y-1",w:"16",h:"8",font:"semibold",border:"1 white/40 rounded",text:"primary space-nowrap 10",opacity:"60",class:G({"!opacity-100 !text-green-400":$.key===t(u)}),onClick:z(E=>u.value=$.key,["stop"])},[T(_($.name)+" ",1),$.key==="mail"?(i(),m(C,{key:0},[T(" ("+_(t(y).length)+") ",1)],64)):S("",!0)],10,zu)),64))]),t(u)==="chat"?(i(),I(g,{key:0,contents:t(d)},null,8,["contents"])):S("",!0),t(u)==="mail"?(i(),I(h,{key:1,mails:t(l),onRead:f},null,8,["mails"])):S("",!0),t(u)==="settings"?(i(),I(w,{key:2})):S("",!0),t(u)==="rank"?(i(),I(k,{key:3})):S("",!0)])]),_:1},8,["show"]),n("div",ju,[n("button",{class:"h-8 w-8 text-12 italic font-semibold border-full-box bg-button-menu",onClick:p[1]||(p[1]=$=>t(r).exchange=!0)},Nu),n("section",Du,[(i(!0),m(C,null,R(t(d),$=>(i(),m("div",{key:$._id},[n("span",{class:G(["font-bold text-10 text-[#6ce8d4]",{"text-[#f44336]":$.type==="system"}])}," ["+_($.name)+"] ",3),T(" : "),n("span",Lu,_($.content),1)]))),128))])])],64)}}}),Vu={},Hu={class:"px-4"};function Fu(e,a){return i(),m("section",Hu,[we(e.$slots,"default")])}const Gu=Qe(Vu,[["render",Fu]]),Ku={w:"full",pos:"absolute",class:"top-[40px] h-[34%]"},Wu={pos:"relative",h:"full",border:"b white/10",bg:"primary"},Yu={pos:"absolute",bottom:"0",w:"full",class:"h-[60%]"},Qu={pos:"relative",h:"full"},Ju=U({__name:"index",setup(e){const{$io:a}=re(),{loadPlayer:s}=Y(),o=ne("isArena",()=>!1);return a.on("fetch:player:response",l=>{s(l)}),be(o,l=>{console.log("arena",l)}),(l,r)=>{const d=wa,u=Ga,c=Xa,f=Gc,y=Mu,b=Gu;return i(),m(C,null,[v(d),v(b,{flex:"~ 1",position:"relative",justify:"center",align:"items-center",z:"9"},{default:x(()=>[n("div",Ku,[n("div",Wu,[t(o)?(i(),I(c,{key:1})):(i(),I(u,{key:0}))])]),n("div",Yu,[n("div",Qu,[v(f)])]),v(y)]),_:1})],64)}}}),dd=Object.freeze(Object.defineProperty({__proto__:null,default:Ju},Symbol.toStringTag,{value:"Module"}));export{Ln as C,Tt as I,zt as _,oe as a,Ct as b,je as c,dd as i,ze as u};
